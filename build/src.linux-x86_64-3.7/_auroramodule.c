/* File: _auroramodule.c
 * This file is auto-generated with f2py (version:2).
 * f2py is a Fortran to Python Interface Generator (FPIG), Second Edition,
 * written by Pearu Peterson <pearu@cens.ioc.ee>.
 * Generation date: Fri Nov  6 17:03:54 2020
 * Do not edit this file directly unless you know what you are doing!!!
 */

#ifdef __cplusplus
extern "C" {
#endif

/*********************** See f2py2e/cfuncs.py: includes ***********************/
#include "Python.h"
#include <stdarg.h>
#include "fortranobject.h"
#include <math.h>

/**************** See f2py2e/rules.py: mod_rules['modulebody'] ****************/
static PyObject *_aurora_error;
static PyObject *_aurora_module;

/*********************** See f2py2e/cfuncs.py: typedefs ***********************/
typedef signed char signed_char;

/****************** See f2py2e/cfuncs.py: typedefs_generated ******************/
/*need_typedefs_generated*/

/********************** See f2py2e/cfuncs.py: cppmacros **********************/
#define pyobj_from_int1(v) (PyInt_FromLong(v))
#define PRINTPYOBJERR(obj)\
    fprintf(stderr,"_aurora.error is related to ");\
    PyObject_Print((PyObject *)obj,stderr,Py_PRINT_RAW);\
    fprintf(stderr,"\n");

#define pyobj_from_double1(v) (PyFloat_FromDouble(v))
#if defined(PREPEND_FORTRAN)
#if defined(NO_APPEND_FORTRAN)
#if defined(UPPERCASE_FORTRAN)
#define F_FUNC(f,F) _##F
#else
#define F_FUNC(f,F) _##f
#endif
#else
#if defined(UPPERCASE_FORTRAN)
#define F_FUNC(f,F) _##F##_
#else
#define F_FUNC(f,F) _##f##_
#endif
#endif
#else
#if defined(NO_APPEND_FORTRAN)
#if defined(UPPERCASE_FORTRAN)
#define F_FUNC(f,F) F
#else
#define F_FUNC(f,F) f
#endif
#else
#if defined(UPPERCASE_FORTRAN)
#define F_FUNC(f,F) F##_
#else
#define F_FUNC(f,F) f##_
#endif
#endif
#endif
#if defined(UNDERSCORE_G77)
#define F_FUNC_US(f,F) F_FUNC(f##_,F##_)
#else
#define F_FUNC_US(f,F) F_FUNC(f,F)
#endif

#define rank(var) var ## _Rank
#define shape(var,dim) var ## _Dims[dim]
#define old_rank(var) (PyArray_NDIM((PyArrayObject *)(capi_ ## var ## _tmp)))
#define old_shape(var,dim) PyArray_DIM(((PyArrayObject *)(capi_ ## var ## _tmp)),dim)
#define fshape(var,dim) shape(var,rank(var)-dim-1)
#define len(var) shape(var,0)
#define flen(var) fshape(var,0)
#define old_size(var) PyArray_SIZE((PyArrayObject *)(capi_ ## var ## _tmp))
/* #define index(i) capi_i ## i */
#define slen(var) capi_ ## var ## _len
#define size(var, ...) f2py_size((PyArrayObject *)(capi_ ## var ## _tmp), ## __VA_ARGS__, -1)

#define CHECKSCALAR(check,tcheck,name,show,var)\
    if (!(check)) {\
        char errstring[256];\
        sprintf(errstring, "%s: "show, "("tcheck") failed for "name, var);\
        PyErr_SetString(_aurora_error,errstring);\
        /*goto capi_fail;*/\
    } else 
#ifdef DEBUGCFUNCS
#define CFUNCSMESS(mess) fprintf(stderr,"debug-capi:"mess);
#define CFUNCSMESSPY(mess,obj) CFUNCSMESS(mess) \
    PyObject_Print((PyObject *)obj,stderr,Py_PRINT_RAW);\
    fprintf(stderr,"\n");
#else
#define CFUNCSMESS(mess)
#define CFUNCSMESSPY(mess,obj)
#endif

#ifndef max
#define max(a,b) ((a > b) ? (a) : (b))
#endif
#ifndef min
#define min(a,b) ((a < b) ? (a) : (b))
#endif
#ifndef MAX
#define MAX(a,b) ((a > b) ? (a) : (b))
#endif
#ifndef MIN
#define MIN(a,b) ((a < b) ? (a) : (b))
#endif

/* New SciPy */
#define TRYPYARRAYTEMPLATECHAR case NPY_STRING: *(char *)(PyArray_DATA(arr))=*v; break;
#define TRYPYARRAYTEMPLATELONG case NPY_LONG: *(long *)(PyArray_DATA(arr))=*v; break;
#define TRYPYARRAYTEMPLATEOBJECT case NPY_OBJECT: PyArray_SETITEM(arr,PyArray_DATA(arr),pyobj_from_ ## ctype ## 1(*v)); break;

#define TRYPYARRAYTEMPLATE(ctype,typecode) \
        PyArrayObject *arr = NULL;\
        if (!obj) return -2;\
        if (!PyArray_Check(obj)) return -1;\
        if (!(arr=(PyArrayObject *)obj)) {fprintf(stderr,"TRYPYARRAYTEMPLATE:");PRINTPYOBJERR(obj);return 0;}\
        if (PyArray_DESCR(arr)->type==typecode)  {*(ctype *)(PyArray_DATA(arr))=*v; return 1;}\
        switch (PyArray_TYPE(arr)) {\
                case NPY_DOUBLE: *(double *)(PyArray_DATA(arr))=*v; break;\
                case NPY_INT: *(int *)(PyArray_DATA(arr))=*v; break;\
                case NPY_LONG: *(long *)(PyArray_DATA(arr))=*v; break;\
                case NPY_FLOAT: *(float *)(PyArray_DATA(arr))=*v; break;\
                case NPY_CDOUBLE: *(double *)(PyArray_DATA(arr))=*v; break;\
                case NPY_CFLOAT: *(float *)(PyArray_DATA(arr))=*v; break;\
                case NPY_BOOL: *(npy_bool *)(PyArray_DATA(arr))=(*v!=0); break;\
                case NPY_UBYTE: *(unsigned char *)(PyArray_DATA(arr))=*v; break;\
                case NPY_BYTE: *(signed char *)(PyArray_DATA(arr))=*v; break;\
                case NPY_SHORT: *(short *)(PyArray_DATA(arr))=*v; break;\
                case NPY_USHORT: *(npy_ushort *)(PyArray_DATA(arr))=*v; break;\
                case NPY_UINT: *(npy_uint *)(PyArray_DATA(arr))=*v; break;\
                case NPY_ULONG: *(npy_ulong *)(PyArray_DATA(arr))=*v; break;\
                case NPY_LONGLONG: *(npy_longlong *)(PyArray_DATA(arr))=*v; break;\
                case NPY_ULONGLONG: *(npy_ulonglong *)(PyArray_DATA(arr))=*v; break;\
                case NPY_LONGDOUBLE: *(npy_longdouble *)(PyArray_DATA(arr))=*v; break;\
                case NPY_CLONGDOUBLE: *(npy_longdouble *)(PyArray_DATA(arr))=*v; break;\
                case NPY_OBJECT: PyArray_SETITEM(arr, PyArray_DATA(arr), pyobj_from_ ## ctype ## 1(*v)); break;\
        default: return -2;\
        };\
        return 1


/************************ See f2py2e/cfuncs.py: cfuncs ************************/
static int f2py_size(PyArrayObject* var, ...)
{
  npy_int sz = 0;
  npy_int dim;
  npy_int rank;
  va_list argp;
  va_start(argp, var);
  dim = va_arg(argp, npy_int);
  if (dim==-1)
    {
      sz = PyArray_SIZE(var);
    }
  else
    {
      rank = PyArray_NDIM(var);
      if (dim>=1 && dim<=rank)
        sz = PyArray_DIM(var, dim-1);
      else
        fprintf(stderr, "f2py_size: 2nd argument value=%d fails to satisfy 1<=value<=%d. Result will be 0.\n", dim, rank);
    }
  va_end(argp);
  return sz;
}

static int int_from_pyobj(int* v,PyObject *obj,const char *errmess) {
    PyObject* tmp = NULL;
    if (PyInt_Check(obj)) {
        *v = (int)PyInt_AS_LONG(obj);
        return 1;
    }
    tmp = PyNumber_Int(obj);
    if (tmp) {
        *v = PyInt_AS_LONG(tmp);
        Py_DECREF(tmp);
        return 1;
    }
    if (PyComplex_Check(obj))
        tmp = PyObject_GetAttrString(obj,"real");
    else if (PyString_Check(obj) || PyUnicode_Check(obj))
        /*pass*/;
    else if (PySequence_Check(obj))
        tmp = PySequence_GetItem(obj,0);
    if (tmp) {
        PyErr_Clear();
        if (int_from_pyobj(v,tmp,errmess)) {Py_DECREF(tmp); return 1;}
        Py_DECREF(tmp);
    }
    {
        PyObject* err = PyErr_Occurred();
        if (err==NULL) err = _aurora_error;
        PyErr_SetString(err,errmess);
    }
    return 0;
}

static int double_from_pyobj(double* v,PyObject *obj,const char *errmess) {
    PyObject* tmp = NULL;
    if (PyFloat_Check(obj)) {
#ifdef __sgi
        *v = PyFloat_AsDouble(obj);
#else
        *v = PyFloat_AS_DOUBLE(obj);
#endif
        return 1;
    }
    tmp = PyNumber_Float(obj);
    if (tmp) {
#ifdef __sgi
        *v = PyFloat_AsDouble(tmp);
#else
        *v = PyFloat_AS_DOUBLE(tmp);
#endif
        Py_DECREF(tmp);
        return 1;
    }
    if (PyComplex_Check(obj))
        tmp = PyObject_GetAttrString(obj,"real");
    else if (PyString_Check(obj) || PyUnicode_Check(obj))
        /*pass*/;
    else if (PySequence_Check(obj))
        tmp = PySequence_GetItem(obj,0);
    if (tmp) {
        PyErr_Clear();
        if (double_from_pyobj(v,tmp,errmess)) {Py_DECREF(tmp); return 1;}
        Py_DECREF(tmp);
    }
    {
        PyObject* err = PyErr_Occurred();
        if (err==NULL) err = _aurora_error;
        PyErr_SetString(err,errmess);
    }
    return 0;
}

static int try_pyarr_from_double(PyObject* obj,double* v) {
    TRYPYARRAYTEMPLATE(double,'d');
}

static int try_pyarr_from_int(PyObject* obj,int* v) {
    TRYPYARRAYTEMPLATE(int,'i');
}


/********************* See f2py2e/cfuncs.py: userincludes *********************/
/*need_userincludes*/

/********************* See f2py2e/capi_rules.py: usercode *********************/


/* See f2py2e/rules.py */
extern void F_FUNC(run,RUN)(int*,int*,int*,int*,int*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,int*,double*,int*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,int*,int*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*);
extern void F_FUNC_US(saw_mix,SAW_MIX)(int*,int*,double*,double*,double*,double*,double*);
extern void F_FUNC_US(edge_model,EDGE_MODEL)(int*,int*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*);
extern void F_FUNC_US(get_radial_grid,GET_RADIAL_GRID)(int*,double*,double*,double*,double*,double*,double*,double*,double*,double*);
extern void F_FUNC_US(time_steps,TIME_STEPS)(int*,double*,double*,int*,double*,int*,double*,int*);
extern void F_FUNC(impden0,IMPDEN0)(int*,int*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*);
extern void F_FUNC(impden1,IMPDEN1)(int*,int*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,int*,double*,double*,double*);
extern void F_FUNC_US(impden_consttranspmatrix,IMPDEN_CONSTTRANSPMATRIX)(double*,double*,double*,int*,double*,double*,double*,double*,double*,double*,double*,double*);
extern void F_FUNC(tdma,TDMA)(double*,double*,double*,double*,int*,double*);
extern void F_FUNC_US(linip_arr,LINIP_ARR)(int*,int*,double*,double*,double*,double*);
extern void F_FUNC_US(asc_sort,ASC_SORT)(int*,double*,int*);
extern void F_FUNC_US(chg_ord_r,CHG_ORD_R)(int*,double*,int*,double*);
extern void F_FUNC_US(chg_ord_i,CHG_ORD_I)(int*,int*,int*,int*);
/*eof externroutines*/

/******************** See f2py2e/capi_rules.py: usercode1 ********************/


/******************* See f2py2e/cb_rules.py: buildcallback *******************/
/*need_callbacks*/

/*********************** See f2py2e/rules.py: buildapi ***********************/

/************************************ run ************************************/
static char doc_f2py_rout__aurora_run[] = "\
rn_out,n_wall,n_div,n_pump,n_ret,n_tsu,n_dsu,n_dsul,rcld_rate,rclw_rate = run(nt_out,t_trans,d,v,par_loss_rates,src_rad_prof,s_rates,r_rates,rr,pro,qpr,r_saw,dlen,time,saw,flx,it_out,dsaw,rcl,divbls,taudiv,taupump,tauwret,rvol_lcfs,dbound,dlim,prox,[nion,ir,nt,nt_trans,rn_t0,alg_opt,evolneut])\n\nWrapper for ``run``.\
\n\nParameters\n----------\n"
"nt_out : input int\n"
"t_trans : input rank-1 array('d') with bounds (nt_trans)\n"
"d : input rank-3 array('d') with bounds (ir,nt_trans,nion)\n"
"v : input rank-3 array('d') with bounds (ir,nt_trans,nion)\n"
"par_loss_rates : input rank-2 array('d') with bounds (ir,nt)\n"
"src_rad_prof : input rank-2 array('d') with bounds (ir,nt)\n"
"s_rates : input rank-3 array('d') with bounds (ir,nion,nt)\n"
"r_rates : input rank-3 array('d') with bounds (ir,nion,nt)\n"
"rr : input rank-1 array('d') with bounds (ir)\n"
"pro : input rank-1 array('d') with bounds (ir)\n"
"qpr : input rank-1 array('d') with bounds (ir)\n"
"r_saw : input float\n"
"dlen : input float\n"
"time : input rank-1 array('d') with bounds (nt)\n"
"saw : input rank-1 array('i') with bounds (nt)\n"
"flx : input rank-1 array('d') with bounds (nt)\n"
"it_out : input rank-1 array('i') with bounds (nt)\n"
"dsaw : input float\n"
"rcl : input float\n"
"divbls : input float\n"
"taudiv : input float\n"
"taupump : input float\n"
"tauwret : input float\n"
"rvol_lcfs : input float\n"
"dbound : input float\n"
"dlim : input float\n"
"prox : input float\n"
"\nOther Parameters\n----------------\n"
"nion : input int, optional\n    Default: shape(d,2)\n"
"ir : input int, optional\n    Default: shape(d,0)\n"
"nt : input int, optional\n    Default: shape(par_loss_rates,1)\n"
"nt_trans : input int, optional\n    Default: len(t_trans)\n"
"rn_t0 : input rank-2 array('d') with bounds (ir,nion)\n"
"alg_opt : input int\n"
"evolneut : input int\n"
"\nReturns\n-------\n"
"rn_out : rank-3 array('d') with bounds (ir,nion,nt_out)\n"
"n_wall : rank-1 array('d') with bounds (nt_out)\n"
"n_div : rank-1 array('d') with bounds (nt_out)\n"
"n_pump : rank-1 array('d') with bounds (nt_out)\n"
"n_ret : rank-1 array('d') with bounds (nt_out)\n"
"n_tsu : rank-1 array('d') with bounds (nt_out)\n"
"n_dsu : rank-1 array('d') with bounds (nt_out)\n"
"n_dsul : rank-1 array('d') with bounds (nt_out)\n"
"rcld_rate : rank-1 array('d') with bounds (nt_out)\n"
"rclw_rate : rank-1 array('d') with bounds (nt_out)";
/* extern void F_FUNC(run,RUN)(int*,int*,int*,int*,int*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,int*,double*,int*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,int*,int*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*); */
static PyObject *f2py_rout__aurora_run(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,int*,int*,int*,int*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,int*,double*,int*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,int*,int*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  int nion = 0;
  PyObject *nion_capi = Py_None;
  int ir = 0;
  PyObject *ir_capi = Py_None;
  int nt = 0;
  PyObject *nt_capi = Py_None;
  int nt_out = 0;
  PyObject *nt_out_capi = Py_None;
  int nt_trans = 0;
  PyObject *nt_trans_capi = Py_None;
  double *t_trans = NULL;
  npy_intp t_trans_Dims[1] = {-1};
  const int t_trans_Rank = 1;
  PyArrayObject *capi_t_trans_tmp = NULL;
  int capi_t_trans_intent = 0;
  PyObject *t_trans_capi = Py_None;
  double *d = NULL;
  npy_intp d_Dims[3] = {-1, -1, -1};
  const int d_Rank = 3;
  PyArrayObject *capi_d_tmp = NULL;
  int capi_d_intent = 0;
  PyObject *d_capi = Py_None;
  double *v = NULL;
  npy_intp v_Dims[3] = {-1, -1, -1};
  const int v_Rank = 3;
  PyArrayObject *capi_v_tmp = NULL;
  int capi_v_intent = 0;
  PyObject *v_capi = Py_None;
  double *par_loss_rates = NULL;
  npy_intp par_loss_rates_Dims[2] = {-1, -1};
  const int par_loss_rates_Rank = 2;
  PyArrayObject *capi_par_loss_rates_tmp = NULL;
  int capi_par_loss_rates_intent = 0;
  PyObject *par_loss_rates_capi = Py_None;
  double *src_rad_prof = NULL;
  npy_intp src_rad_prof_Dims[2] = {-1, -1};
  const int src_rad_prof_Rank = 2;
  PyArrayObject *capi_src_rad_prof_tmp = NULL;
  int capi_src_rad_prof_intent = 0;
  PyObject *src_rad_prof_capi = Py_None;
  double *s_rates = NULL;
  npy_intp s_rates_Dims[3] = {-1, -1, -1};
  const int s_rates_Rank = 3;
  PyArrayObject *capi_s_rates_tmp = NULL;
  int capi_s_rates_intent = 0;
  PyObject *s_rates_capi = Py_None;
  double *r_rates = NULL;
  npy_intp r_rates_Dims[3] = {-1, -1, -1};
  const int r_rates_Rank = 3;
  PyArrayObject *capi_r_rates_tmp = NULL;
  int capi_r_rates_intent = 0;
  PyObject *r_rates_capi = Py_None;
  double *rr = NULL;
  npy_intp rr_Dims[1] = {-1};
  const int rr_Rank = 1;
  PyArrayObject *capi_rr_tmp = NULL;
  int capi_rr_intent = 0;
  PyObject *rr_capi = Py_None;
  double *pro = NULL;
  npy_intp pro_Dims[1] = {-1};
  const int pro_Rank = 1;
  PyArrayObject *capi_pro_tmp = NULL;
  int capi_pro_intent = 0;
  PyObject *pro_capi = Py_None;
  double *qpr = NULL;
  npy_intp qpr_Dims[1] = {-1};
  const int qpr_Rank = 1;
  PyArrayObject *capi_qpr_tmp = NULL;
  int capi_qpr_intent = 0;
  PyObject *qpr_capi = Py_None;
  double r_saw = 0;
  PyObject *r_saw_capi = Py_None;
  double dlen = 0;
  PyObject *dlen_capi = Py_None;
  double *time = NULL;
  npy_intp time_Dims[1] = {-1};
  const int time_Rank = 1;
  PyArrayObject *capi_time_tmp = NULL;
  int capi_time_intent = 0;
  PyObject *time_capi = Py_None;
  int *saw = NULL;
  npy_intp saw_Dims[1] = {-1};
  const int saw_Rank = 1;
  PyArrayObject *capi_saw_tmp = NULL;
  int capi_saw_intent = 0;
  PyObject *saw_capi = Py_None;
  double *flx = NULL;
  npy_intp flx_Dims[1] = {-1};
  const int flx_Rank = 1;
  PyArrayObject *capi_flx_tmp = NULL;
  int capi_flx_intent = 0;
  PyObject *flx_capi = Py_None;
  int *it_out = NULL;
  npy_intp it_out_Dims[1] = {-1};
  const int it_out_Rank = 1;
  PyArrayObject *capi_it_out_tmp = NULL;
  int capi_it_out_intent = 0;
  PyObject *it_out_capi = Py_None;
  double dsaw = 0;
  PyObject *dsaw_capi = Py_None;
  double rcl = 0;
  PyObject *rcl_capi = Py_None;
  double divbls = 0;
  PyObject *divbls_capi = Py_None;
  double taudiv = 0;
  PyObject *taudiv_capi = Py_None;
  double taupump = 0;
  PyObject *taupump_capi = Py_None;
  double tauwret = 0;
  PyObject *tauwret_capi = Py_None;
  double rvol_lcfs = 0;
  PyObject *rvol_lcfs_capi = Py_None;
  double dbound = 0;
  PyObject *dbound_capi = Py_None;
  double dlim = 0;
  PyObject *dlim_capi = Py_None;
  double prox = 0;
  PyObject *prox_capi = Py_None;
  double *rn_t0 = NULL;
  npy_intp rn_t0_Dims[2] = {-1, -1};
  const int rn_t0_Rank = 2;
  PyArrayObject *capi_rn_t0_tmp = NULL;
  int capi_rn_t0_intent = 0;
  PyObject *rn_t0_capi = Py_None;
  int alg_opt = 0;
  PyObject *alg_opt_capi = Py_None;
  int evolneut = 0;
  PyObject *evolneut_capi = Py_None;
  double *rn_out = NULL;
  npy_intp rn_out_Dims[3] = {-1, -1, -1};
  const int rn_out_Rank = 3;
  PyArrayObject *capi_rn_out_tmp = NULL;
  int capi_rn_out_intent = 0;
  double *n_wall = NULL;
  npy_intp n_wall_Dims[1] = {-1};
  const int n_wall_Rank = 1;
  PyArrayObject *capi_n_wall_tmp = NULL;
  int capi_n_wall_intent = 0;
  double *n_div = NULL;
  npy_intp n_div_Dims[1] = {-1};
  const int n_div_Rank = 1;
  PyArrayObject *capi_n_div_tmp = NULL;
  int capi_n_div_intent = 0;
  double *n_pump = NULL;
  npy_intp n_pump_Dims[1] = {-1};
  const int n_pump_Rank = 1;
  PyArrayObject *capi_n_pump_tmp = NULL;
  int capi_n_pump_intent = 0;
  double *n_ret = NULL;
  npy_intp n_ret_Dims[1] = {-1};
  const int n_ret_Rank = 1;
  PyArrayObject *capi_n_ret_tmp = NULL;
  int capi_n_ret_intent = 0;
  double *n_tsu = NULL;
  npy_intp n_tsu_Dims[1] = {-1};
  const int n_tsu_Rank = 1;
  PyArrayObject *capi_n_tsu_tmp = NULL;
  int capi_n_tsu_intent = 0;
  double *n_dsu = NULL;
  npy_intp n_dsu_Dims[1] = {-1};
  const int n_dsu_Rank = 1;
  PyArrayObject *capi_n_dsu_tmp = NULL;
  int capi_n_dsu_intent = 0;
  double *n_dsul = NULL;
  npy_intp n_dsul_Dims[1] = {-1};
  const int n_dsul_Rank = 1;
  PyArrayObject *capi_n_dsul_tmp = NULL;
  int capi_n_dsul_intent = 0;
  double *rcld_rate = NULL;
  npy_intp rcld_rate_Dims[1] = {-1};
  const int rcld_rate_Rank = 1;
  PyArrayObject *capi_rcld_rate_tmp = NULL;
  int capi_rcld_rate_intent = 0;
  double *rclw_rate = NULL;
  npy_intp rclw_rate_Dims[1] = {-1};
  const int rclw_rate_Rank = 1;
  PyArrayObject *capi_rclw_rate_tmp = NULL;
  int capi_rclw_rate_intent = 0;
  static char *capi_kwlist[] = {"nt_out","t_trans","d","v","par_loss_rates","src_rad_prof","s_rates","r_rates","rr","pro","qpr","r_saw","dlen","time","saw","flx","it_out","dsaw","rcl","divbls","taudiv","taupump","tauwret","rvol_lcfs","dbound","dlim","prox","nion","ir","nt","nt_trans","rn_t0","alg_opt","evolneut",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OOOOOOOOOOOOOOOOOOOOOOOOOOO|OOOOOOO:_aurora.run",\
    capi_kwlist,&nt_out_capi,&t_trans_capi,&d_capi,&v_capi,&par_loss_rates_capi,&src_rad_prof_capi,&s_rates_capi,&r_rates_capi,&rr_capi,&pro_capi,&qpr_capi,&r_saw_capi,&dlen_capi,&time_capi,&saw_capi,&flx_capi,&it_out_capi,&dsaw_capi,&rcl_capi,&divbls_capi,&taudiv_capi,&taupump_capi,&tauwret_capi,&rvol_lcfs_capi,&dbound_capi,&dlim_capi,&prox_capi,&nion_capi,&ir_capi,&nt_capi,&nt_trans_capi,&rn_t0_capi,&alg_opt_capi,&evolneut_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable nt_out */
    f2py_success = int_from_pyobj(&nt_out,nt_out_capi,"_aurora.run() 1st argument (nt_out) can't be converted to int");
  if (f2py_success) {
  /* Processing variable t_trans */
  ;
  capi_t_trans_intent |= F2PY_INTENT_IN;
  capi_t_trans_tmp = array_from_pyobj(NPY_DOUBLE,t_trans_Dims,t_trans_Rank,capi_t_trans_intent,t_trans_capi);
  if (capi_t_trans_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 2nd argument `t_trans' of _aurora.run to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    t_trans = (double *)(PyArray_DATA(capi_t_trans_tmp));

  /* Processing variable r_saw */
    f2py_success = double_from_pyobj(&r_saw,r_saw_capi,"_aurora.run() 12nd argument (r_saw) can't be converted to double");
  if (f2py_success) {
  /* Processing variable dlen */
    f2py_success = double_from_pyobj(&dlen,dlen_capi,"_aurora.run() 13rd argument (dlen) can't be converted to double");
  if (f2py_success) {
  /* Processing variable dsaw */
    f2py_success = double_from_pyobj(&dsaw,dsaw_capi,"_aurora.run() 18th argument (dsaw) can't be converted to double");
  if (f2py_success) {
  /* Processing variable rcl */
    f2py_success = double_from_pyobj(&rcl,rcl_capi,"_aurora.run() 19th argument (rcl) can't be converted to double");
  if (f2py_success) {
  /* Processing variable divbls */
    f2py_success = double_from_pyobj(&divbls,divbls_capi,"_aurora.run() 20th argument (divbls) can't be converted to double");
  if (f2py_success) {
  /* Processing variable taudiv */
    f2py_success = double_from_pyobj(&taudiv,taudiv_capi,"_aurora.run() 21st argument (taudiv) can't be converted to double");
  if (f2py_success) {
  /* Processing variable taupump */
    f2py_success = double_from_pyobj(&taupump,taupump_capi,"_aurora.run() 22nd argument (taupump) can't be converted to double");
  if (f2py_success) {
  /* Processing variable tauwret */
    f2py_success = double_from_pyobj(&tauwret,tauwret_capi,"_aurora.run() 23rd argument (tauwret) can't be converted to double");
  if (f2py_success) {
  /* Processing variable rvol_lcfs */
    f2py_success = double_from_pyobj(&rvol_lcfs,rvol_lcfs_capi,"_aurora.run() 24th argument (rvol_lcfs) can't be converted to double");
  if (f2py_success) {
  /* Processing variable dbound */
    f2py_success = double_from_pyobj(&dbound,dbound_capi,"_aurora.run() 25th argument (dbound) can't be converted to double");
  if (f2py_success) {
  /* Processing variable dlim */
    f2py_success = double_from_pyobj(&dlim,dlim_capi,"_aurora.run() 26th argument (dlim) can't be converted to double");
  if (f2py_success) {
  /* Processing variable prox */
    f2py_success = double_from_pyobj(&prox,prox_capi,"_aurora.run() 27th argument (prox) can't be converted to double");
  if (f2py_success) {
  /* Processing variable alg_opt */
  if (alg_opt_capi != Py_None)
    f2py_success = int_from_pyobj(&alg_opt,alg_opt_capi,"_aurora.run() 6th keyword (alg_opt) can't be converted to int");
  if (f2py_success) {
  /* Processing variable evolneut */
  if (evolneut_capi != Py_None)
    evolneut = (int)PyObject_IsTrue(evolneut_capi);
    f2py_success = 1;
  if (f2py_success) {
  /* Processing variable nt_trans */
  if (nt_trans_capi == Py_None) nt_trans = len(t_trans); else
    f2py_success = int_from_pyobj(&nt_trans,nt_trans_capi,"_aurora.run() 4th keyword (nt_trans) can't be converted to int");
  if (f2py_success) {
  CHECKSCALAR(len(t_trans)>=nt_trans,"len(t_trans)>=nt_trans","4th keyword nt_trans","run:nt_trans=%d",nt_trans) {
  /* Processing variable d */
  d_Dims[1]=nt_trans;
  capi_d_intent |= F2PY_INTENT_IN;
  capi_d_tmp = array_from_pyobj(NPY_DOUBLE,d_Dims,d_Rank,capi_d_intent,d_capi);
  if (capi_d_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 3rd argument `d' of _aurora.run to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    d = (double *)(PyArray_DATA(capi_d_tmp));

  /* Processing variable n_wall */
  n_wall_Dims[0]=nt_out;
  capi_n_wall_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_n_wall_tmp = array_from_pyobj(NPY_DOUBLE,n_wall_Dims,n_wall_Rank,capi_n_wall_intent,Py_None);
  if (capi_n_wall_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting hidden `n_wall' of _aurora.run to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    n_wall = (double *)(PyArray_DATA(capi_n_wall_tmp));

  /* Processing variable n_div */
  n_div_Dims[0]=nt_out;
  capi_n_div_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_n_div_tmp = array_from_pyobj(NPY_DOUBLE,n_div_Dims,n_div_Rank,capi_n_div_intent,Py_None);
  if (capi_n_div_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting hidden `n_div' of _aurora.run to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    n_div = (double *)(PyArray_DATA(capi_n_div_tmp));

  /* Processing variable n_pump */
  n_pump_Dims[0]=nt_out;
  capi_n_pump_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_n_pump_tmp = array_from_pyobj(NPY_DOUBLE,n_pump_Dims,n_pump_Rank,capi_n_pump_intent,Py_None);
  if (capi_n_pump_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting hidden `n_pump' of _aurora.run to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    n_pump = (double *)(PyArray_DATA(capi_n_pump_tmp));

  /* Processing variable n_ret */
  n_ret_Dims[0]=nt_out;
  capi_n_ret_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_n_ret_tmp = array_from_pyobj(NPY_DOUBLE,n_ret_Dims,n_ret_Rank,capi_n_ret_intent,Py_None);
  if (capi_n_ret_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting hidden `n_ret' of _aurora.run to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    n_ret = (double *)(PyArray_DATA(capi_n_ret_tmp));

  /* Processing variable n_tsu */
  n_tsu_Dims[0]=nt_out;
  capi_n_tsu_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_n_tsu_tmp = array_from_pyobj(NPY_DOUBLE,n_tsu_Dims,n_tsu_Rank,capi_n_tsu_intent,Py_None);
  if (capi_n_tsu_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting hidden `n_tsu' of _aurora.run to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    n_tsu = (double *)(PyArray_DATA(capi_n_tsu_tmp));

  /* Processing variable n_dsu */
  n_dsu_Dims[0]=nt_out;
  capi_n_dsu_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_n_dsu_tmp = array_from_pyobj(NPY_DOUBLE,n_dsu_Dims,n_dsu_Rank,capi_n_dsu_intent,Py_None);
  if (capi_n_dsu_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting hidden `n_dsu' of _aurora.run to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    n_dsu = (double *)(PyArray_DATA(capi_n_dsu_tmp));

  /* Processing variable n_dsul */
  n_dsul_Dims[0]=nt_out;
  capi_n_dsul_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_n_dsul_tmp = array_from_pyobj(NPY_DOUBLE,n_dsul_Dims,n_dsul_Rank,capi_n_dsul_intent,Py_None);
  if (capi_n_dsul_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting hidden `n_dsul' of _aurora.run to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    n_dsul = (double *)(PyArray_DATA(capi_n_dsul_tmp));

  /* Processing variable rcld_rate */
  rcld_rate_Dims[0]=nt_out;
  capi_rcld_rate_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_rcld_rate_tmp = array_from_pyobj(NPY_DOUBLE,rcld_rate_Dims,rcld_rate_Rank,capi_rcld_rate_intent,Py_None);
  if (capi_rcld_rate_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting hidden `rcld_rate' of _aurora.run to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    rcld_rate = (double *)(PyArray_DATA(capi_rcld_rate_tmp));

  /* Processing variable rclw_rate */
  rclw_rate_Dims[0]=nt_out;
  capi_rclw_rate_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_rclw_rate_tmp = array_from_pyobj(NPY_DOUBLE,rclw_rate_Dims,rclw_rate_Rank,capi_rclw_rate_intent,Py_None);
  if (capi_rclw_rate_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting hidden `rclw_rate' of _aurora.run to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    rclw_rate = (double *)(PyArray_DATA(capi_rclw_rate_tmp));

  /* Processing variable nion */
  if (nion_capi == Py_None) nion = shape(d,2); else
    f2py_success = int_from_pyobj(&nion,nion_capi,"_aurora.run() 1st keyword (nion) can't be converted to int");
  if (f2py_success) {
  CHECKSCALAR(shape(d,2)==nion,"shape(d,2)==nion","1st keyword nion","run:nion=%d",nion) {
  /* Processing variable ir */
  if (ir_capi == Py_None) ir = shape(d,0); else
    f2py_success = int_from_pyobj(&ir,ir_capi,"_aurora.run() 2nd keyword (ir) can't be converted to int");
  if (f2py_success) {
  CHECKSCALAR(shape(d,0)==ir,"shape(d,0)==ir","2nd keyword ir","run:ir=%d",ir) {
  /* Processing variable v */
  v_Dims[0]=ir,v_Dims[1]=nt_trans,v_Dims[2]=nion;
  capi_v_intent |= F2PY_INTENT_IN;
  capi_v_tmp = array_from_pyobj(NPY_DOUBLE,v_Dims,v_Rank,capi_v_intent,v_capi);
  if (capi_v_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 4th argument `v' of _aurora.run to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    v = (double *)(PyArray_DATA(capi_v_tmp));

  /* Processing variable par_loss_rates */
  par_loss_rates_Dims[0]=ir;
  capi_par_loss_rates_intent |= F2PY_INTENT_IN;
  capi_par_loss_rates_tmp = array_from_pyobj(NPY_DOUBLE,par_loss_rates_Dims,par_loss_rates_Rank,capi_par_loss_rates_intent,par_loss_rates_capi);
  if (capi_par_loss_rates_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 5th argument `par_loss_rates' of _aurora.run to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    par_loss_rates = (double *)(PyArray_DATA(capi_par_loss_rates_tmp));

  /* Processing variable rr */
  rr_Dims[0]=ir;
  capi_rr_intent |= F2PY_INTENT_IN;
  capi_rr_tmp = array_from_pyobj(NPY_DOUBLE,rr_Dims,rr_Rank,capi_rr_intent,rr_capi);
  if (capi_rr_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 9th argument `rr' of _aurora.run to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    rr = (double *)(PyArray_DATA(capi_rr_tmp));

  /* Processing variable pro */
  pro_Dims[0]=ir;
  capi_pro_intent |= F2PY_INTENT_IN;
  capi_pro_tmp = array_from_pyobj(NPY_DOUBLE,pro_Dims,pro_Rank,capi_pro_intent,pro_capi);
  if (capi_pro_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 10th argument `pro' of _aurora.run to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    pro = (double *)(PyArray_DATA(capi_pro_tmp));

  /* Processing variable qpr */
  qpr_Dims[0]=ir;
  capi_qpr_intent |= F2PY_INTENT_IN;
  capi_qpr_tmp = array_from_pyobj(NPY_DOUBLE,qpr_Dims,qpr_Rank,capi_qpr_intent,qpr_capi);
  if (capi_qpr_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 11st argument `qpr' of _aurora.run to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    qpr = (double *)(PyArray_DATA(capi_qpr_tmp));

  /* Processing variable rn_t0 */
  rn_t0_Dims[0]=ir,rn_t0_Dims[1]=nion;
  capi_rn_t0_intent |= F2PY_INTENT_IN|F2PY_OPTIONAL;
  capi_rn_t0_tmp = array_from_pyobj(NPY_DOUBLE,rn_t0_Dims,rn_t0_Rank,capi_rn_t0_intent,rn_t0_capi);
  if (capi_rn_t0_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 5th keyword `rn_t0' of _aurora.run to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    rn_t0 = (double *)(PyArray_DATA(capi_rn_t0_tmp));

  /* Processing variable rn_out */
  rn_out_Dims[0]=ir,rn_out_Dims[1]=nion,rn_out_Dims[2]=nt_out;
  capi_rn_out_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_rn_out_tmp = array_from_pyobj(NPY_DOUBLE,rn_out_Dims,rn_out_Rank,capi_rn_out_intent,Py_None);
  if (capi_rn_out_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting hidden `rn_out' of _aurora.run to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    rn_out = (double *)(PyArray_DATA(capi_rn_out_tmp));

  /* Processing variable nt */
  if (nt_capi == Py_None) nt = shape(par_loss_rates,1); else
    f2py_success = int_from_pyobj(&nt,nt_capi,"_aurora.run() 3rd keyword (nt) can't be converted to int");
  if (f2py_success) {
  CHECKSCALAR(shape(par_loss_rates,1)==nt,"shape(par_loss_rates,1)==nt","3rd keyword nt","run:nt=%d",nt) {
  /* Processing variable src_rad_prof */
  src_rad_prof_Dims[0]=ir,src_rad_prof_Dims[1]=nt;
  capi_src_rad_prof_intent |= F2PY_INTENT_IN;
  capi_src_rad_prof_tmp = array_from_pyobj(NPY_DOUBLE,src_rad_prof_Dims,src_rad_prof_Rank,capi_src_rad_prof_intent,src_rad_prof_capi);
  if (capi_src_rad_prof_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 6th argument `src_rad_prof' of _aurora.run to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    src_rad_prof = (double *)(PyArray_DATA(capi_src_rad_prof_tmp));

  /* Processing variable s_rates */
  s_rates_Dims[0]=ir,s_rates_Dims[1]=nion,s_rates_Dims[2]=nt;
  capi_s_rates_intent |= F2PY_INTENT_IN;
  capi_s_rates_tmp = array_from_pyobj(NPY_DOUBLE,s_rates_Dims,s_rates_Rank,capi_s_rates_intent,s_rates_capi);
  if (capi_s_rates_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 7th argument `s_rates' of _aurora.run to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    s_rates = (double *)(PyArray_DATA(capi_s_rates_tmp));

  /* Processing variable r_rates */
  r_rates_Dims[0]=ir,r_rates_Dims[1]=nion,r_rates_Dims[2]=nt;
  capi_r_rates_intent |= F2PY_INTENT_IN;
  capi_r_rates_tmp = array_from_pyobj(NPY_DOUBLE,r_rates_Dims,r_rates_Rank,capi_r_rates_intent,r_rates_capi);
  if (capi_r_rates_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 8th argument `r_rates' of _aurora.run to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    r_rates = (double *)(PyArray_DATA(capi_r_rates_tmp));

  /* Processing variable time */
  time_Dims[0]=nt;
  capi_time_intent |= F2PY_INTENT_IN;
  capi_time_tmp = array_from_pyobj(NPY_DOUBLE,time_Dims,time_Rank,capi_time_intent,time_capi);
  if (capi_time_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 14th argument `time' of _aurora.run to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    time = (double *)(PyArray_DATA(capi_time_tmp));

  /* Processing variable saw */
  saw_Dims[0]=nt;
  capi_saw_intent |= F2PY_INTENT_IN;
  capi_saw_tmp = array_from_pyobj(NPY_INT,saw_Dims,saw_Rank,capi_saw_intent,saw_capi);
  if (capi_saw_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 15th argument `saw' of _aurora.run to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    saw = (int *)(PyArray_DATA(capi_saw_tmp));

  /* Processing variable flx */
  flx_Dims[0]=nt;
  capi_flx_intent |= F2PY_INTENT_IN;
  capi_flx_tmp = array_from_pyobj(NPY_DOUBLE,flx_Dims,flx_Rank,capi_flx_intent,flx_capi);
  if (capi_flx_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 16th argument `flx' of _aurora.run to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    flx = (double *)(PyArray_DATA(capi_flx_tmp));

  /* Processing variable it_out */
  it_out_Dims[0]=nt;
  capi_it_out_intent |= F2PY_INTENT_IN;
  capi_it_out_tmp = array_from_pyobj(NPY_INT,it_out_Dims,it_out_Rank,capi_it_out_intent,it_out_capi);
  if (capi_it_out_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 17th argument `it_out' of _aurora.run to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    it_out = (int *)(PyArray_DATA(capi_it_out_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(&nion,&ir,&nt,&nt_out,&nt_trans,t_trans,d,v,par_loss_rates,src_rad_prof,s_rates,r_rates,rr,pro,qpr,&r_saw,&dlen,time,saw,flx,it_out,&dsaw,&rcl,&divbls,&taudiv,&taupump,&tauwret,&rvol_lcfs,&dbound,&dlim,&prox,rn_t0,&alg_opt,&evolneut,rn_out,n_wall,n_div,n_pump,n_ret,n_tsu,n_dsu,n_dsul,rcld_rate,rclw_rate);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("NNNNNNNNNN",capi_rn_out_tmp,capi_n_wall_tmp,capi_n_div_tmp,capi_n_pump_tmp,capi_n_ret_tmp,capi_n_tsu_tmp,capi_n_dsu_tmp,capi_n_dsul_tmp,capi_rcld_rate_tmp,capi_rclw_rate_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  if((PyObject *)capi_it_out_tmp!=it_out_capi) {
    Py_XDECREF(capi_it_out_tmp); }
  }  /*if (capi_it_out_tmp == NULL) ... else of it_out*/
  /* End of cleaning variable it_out */
  if((PyObject *)capi_flx_tmp!=flx_capi) {
    Py_XDECREF(capi_flx_tmp); }
  }  /*if (capi_flx_tmp == NULL) ... else of flx*/
  /* End of cleaning variable flx */
  if((PyObject *)capi_saw_tmp!=saw_capi) {
    Py_XDECREF(capi_saw_tmp); }
  }  /*if (capi_saw_tmp == NULL) ... else of saw*/
  /* End of cleaning variable saw */
  if((PyObject *)capi_time_tmp!=time_capi) {
    Py_XDECREF(capi_time_tmp); }
  }  /*if (capi_time_tmp == NULL) ... else of time*/
  /* End of cleaning variable time */
  if((PyObject *)capi_r_rates_tmp!=r_rates_capi) {
    Py_XDECREF(capi_r_rates_tmp); }
  }  /*if (capi_r_rates_tmp == NULL) ... else of r_rates*/
  /* End of cleaning variable r_rates */
  if((PyObject *)capi_s_rates_tmp!=s_rates_capi) {
    Py_XDECREF(capi_s_rates_tmp); }
  }  /*if (capi_s_rates_tmp == NULL) ... else of s_rates*/
  /* End of cleaning variable s_rates */
  if((PyObject *)capi_src_rad_prof_tmp!=src_rad_prof_capi) {
    Py_XDECREF(capi_src_rad_prof_tmp); }
  }  /*if (capi_src_rad_prof_tmp == NULL) ... else of src_rad_prof*/
  /* End of cleaning variable src_rad_prof */
  } /*CHECKSCALAR(shape(par_loss_rates,1)==nt)*/
  } /*if (f2py_success) of nt*/
  /* End of cleaning variable nt */
  }  /*if (capi_rn_out_tmp == NULL) ... else of rn_out*/
  /* End of cleaning variable rn_out */
  if((PyObject *)capi_rn_t0_tmp!=rn_t0_capi) {
    Py_XDECREF(capi_rn_t0_tmp); }
  }  /*if (capi_rn_t0_tmp == NULL) ... else of rn_t0*/
  /* End of cleaning variable rn_t0 */
  if((PyObject *)capi_qpr_tmp!=qpr_capi) {
    Py_XDECREF(capi_qpr_tmp); }
  }  /*if (capi_qpr_tmp == NULL) ... else of qpr*/
  /* End of cleaning variable qpr */
  if((PyObject *)capi_pro_tmp!=pro_capi) {
    Py_XDECREF(capi_pro_tmp); }
  }  /*if (capi_pro_tmp == NULL) ... else of pro*/
  /* End of cleaning variable pro */
  if((PyObject *)capi_rr_tmp!=rr_capi) {
    Py_XDECREF(capi_rr_tmp); }
  }  /*if (capi_rr_tmp == NULL) ... else of rr*/
  /* End of cleaning variable rr */
  if((PyObject *)capi_par_loss_rates_tmp!=par_loss_rates_capi) {
    Py_XDECREF(capi_par_loss_rates_tmp); }
  }  /*if (capi_par_loss_rates_tmp == NULL) ... else of par_loss_rates*/
  /* End of cleaning variable par_loss_rates */
  if((PyObject *)capi_v_tmp!=v_capi) {
    Py_XDECREF(capi_v_tmp); }
  }  /*if (capi_v_tmp == NULL) ... else of v*/
  /* End of cleaning variable v */
  } /*CHECKSCALAR(shape(d,0)==ir)*/
  } /*if (f2py_success) of ir*/
  /* End of cleaning variable ir */
  } /*CHECKSCALAR(shape(d,2)==nion)*/
  } /*if (f2py_success) of nion*/
  /* End of cleaning variable nion */
  }  /*if (capi_rclw_rate_tmp == NULL) ... else of rclw_rate*/
  /* End of cleaning variable rclw_rate */
  }  /*if (capi_rcld_rate_tmp == NULL) ... else of rcld_rate*/
  /* End of cleaning variable rcld_rate */
  }  /*if (capi_n_dsul_tmp == NULL) ... else of n_dsul*/
  /* End of cleaning variable n_dsul */
  }  /*if (capi_n_dsu_tmp == NULL) ... else of n_dsu*/
  /* End of cleaning variable n_dsu */
  }  /*if (capi_n_tsu_tmp == NULL) ... else of n_tsu*/
  /* End of cleaning variable n_tsu */
  }  /*if (capi_n_ret_tmp == NULL) ... else of n_ret*/
  /* End of cleaning variable n_ret */
  }  /*if (capi_n_pump_tmp == NULL) ... else of n_pump*/
  /* End of cleaning variable n_pump */
  }  /*if (capi_n_div_tmp == NULL) ... else of n_div*/
  /* End of cleaning variable n_div */
  }  /*if (capi_n_wall_tmp == NULL) ... else of n_wall*/
  /* End of cleaning variable n_wall */
  if((PyObject *)capi_d_tmp!=d_capi) {
    Py_XDECREF(capi_d_tmp); }
  }  /*if (capi_d_tmp == NULL) ... else of d*/
  /* End of cleaning variable d */
  } /*CHECKSCALAR(len(t_trans)>=nt_trans)*/
  } /*if (f2py_success) of nt_trans*/
  /* End of cleaning variable nt_trans */
  } /*if (f2py_success) of evolneut*/
  /* End of cleaning variable evolneut */
  } /*if (f2py_success) of alg_opt*/
  /* End of cleaning variable alg_opt */
  } /*if (f2py_success) of prox*/
  /* End of cleaning variable prox */
  } /*if (f2py_success) of dlim*/
  /* End of cleaning variable dlim */
  } /*if (f2py_success) of dbound*/
  /* End of cleaning variable dbound */
  } /*if (f2py_success) of rvol_lcfs*/
  /* End of cleaning variable rvol_lcfs */
  } /*if (f2py_success) of tauwret*/
  /* End of cleaning variable tauwret */
  } /*if (f2py_success) of taupump*/
  /* End of cleaning variable taupump */
  } /*if (f2py_success) of taudiv*/
  /* End of cleaning variable taudiv */
  } /*if (f2py_success) of divbls*/
  /* End of cleaning variable divbls */
  } /*if (f2py_success) of rcl*/
  /* End of cleaning variable rcl */
  } /*if (f2py_success) of dsaw*/
  /* End of cleaning variable dsaw */
  } /*if (f2py_success) of dlen*/
  /* End of cleaning variable dlen */
  } /*if (f2py_success) of r_saw*/
  /* End of cleaning variable r_saw */
  if((PyObject *)capi_t_trans_tmp!=t_trans_capi) {
    Py_XDECREF(capi_t_trans_tmp); }
  }  /*if (capi_t_trans_tmp == NULL) ... else of t_trans*/
  /* End of cleaning variable t_trans */
  } /*if (f2py_success) of nt_out*/
  /* End of cleaning variable nt_out */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/********************************* end of run *********************************/

/********************************** saw_mix **********************************/
static char doc_f2py_rout__aurora_saw_mix[] = "\
saw_mix(rn,rsaw,dsaw,rr,pro,[nion,ir])\n\nWrapper for ``saw_mix``.\
\n\nParameters\n----------\n"
"rn : in/output rank-2 array('d') with bounds (ir,nion)\n"
"rsaw : input float\n"
"dsaw : input float\n"
"rr : input rank-1 array('d') with bounds (ir)\n"
"pro : input rank-1 array('d') with bounds (ir)\n"
"\nOther Parameters\n----------------\n"
"nion : input int, optional\n    Default: shape(rn,1)\n"
"ir : input int, optional\n    Default: shape(rn,0)";
/* extern void F_FUNC_US(saw_mix,SAW_MIX)(int*,int*,double*,double*,double*,double*,double*); */
static PyObject *f2py_rout__aurora_saw_mix(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,int*,double*,double*,double*,double*,double*)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  int nion = 0;
  PyObject *nion_capi = Py_None;
  int ir = 0;
  PyObject *ir_capi = Py_None;
  double *rn = NULL;
  npy_intp rn_Dims[2] = {-1, -1};
  const int rn_Rank = 2;
  PyArrayObject *capi_rn_tmp = NULL;
  int capi_rn_intent = 0;
  PyObject *rn_capi = Py_None;
  double rsaw = 0;
  PyObject *rsaw_capi = Py_None;
  double dsaw = 0;
  PyObject *dsaw_capi = Py_None;
  double *rr = NULL;
  npy_intp rr_Dims[1] = {-1};
  const int rr_Rank = 1;
  PyArrayObject *capi_rr_tmp = NULL;
  int capi_rr_intent = 0;
  PyObject *rr_capi = Py_None;
  double *pro = NULL;
  npy_intp pro_Dims[1] = {-1};
  const int pro_Rank = 1;
  PyArrayObject *capi_pro_tmp = NULL;
  int capi_pro_intent = 0;
  PyObject *pro_capi = Py_None;
  static char *capi_kwlist[] = {"rn","rsaw","dsaw","rr","pro","nion","ir",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OOOOO|OO:_aurora.saw_mix",\
    capi_kwlist,&rn_capi,&rsaw_capi,&dsaw_capi,&rr_capi,&pro_capi,&nion_capi,&ir_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable rn */
  ;
  capi_rn_intent |= F2PY_INTENT_INOUT;
  capi_rn_tmp = array_from_pyobj(NPY_DOUBLE,rn_Dims,rn_Rank,capi_rn_intent,rn_capi);
  if (capi_rn_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 1st argument `rn' of _aurora.saw_mix to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    rn = (double *)(PyArray_DATA(capi_rn_tmp));

  /* Processing variable rsaw */
    f2py_success = double_from_pyobj(&rsaw,rsaw_capi,"_aurora.saw_mix() 2nd argument (rsaw) can't be converted to double");
  if (f2py_success) {
  /* Processing variable dsaw */
    f2py_success = double_from_pyobj(&dsaw,dsaw_capi,"_aurora.saw_mix() 3rd argument (dsaw) can't be converted to double");
  if (f2py_success) {
  /* Processing variable nion */
  if (nion_capi == Py_None) nion = shape(rn,1); else
    f2py_success = int_from_pyobj(&nion,nion_capi,"_aurora.saw_mix() 1st keyword (nion) can't be converted to int");
  if (f2py_success) {
  CHECKSCALAR(shape(rn,1)==nion,"shape(rn,1)==nion","1st keyword nion","saw_mix:nion=%d",nion) {
  /* Processing variable ir */
  if (ir_capi == Py_None) ir = shape(rn,0); else
    f2py_success = int_from_pyobj(&ir,ir_capi,"_aurora.saw_mix() 2nd keyword (ir) can't be converted to int");
  if (f2py_success) {
  CHECKSCALAR(shape(rn,0)==ir,"shape(rn,0)==ir","2nd keyword ir","saw_mix:ir=%d",ir) {
  /* Processing variable rr */
  rr_Dims[0]=ir;
  capi_rr_intent |= F2PY_INTENT_IN;
  capi_rr_tmp = array_from_pyobj(NPY_DOUBLE,rr_Dims,rr_Rank,capi_rr_intent,rr_capi);
  if (capi_rr_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 4th argument `rr' of _aurora.saw_mix to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    rr = (double *)(PyArray_DATA(capi_rr_tmp));

  /* Processing variable pro */
  pro_Dims[0]=ir;
  capi_pro_intent |= F2PY_INTENT_IN;
  capi_pro_tmp = array_from_pyobj(NPY_DOUBLE,pro_Dims,pro_Rank,capi_pro_intent,pro_capi);
  if (capi_pro_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 5th argument `pro' of _aurora.saw_mix to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    pro = (double *)(PyArray_DATA(capi_pro_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(&nion,&ir,rn,&rsaw,&dsaw,rr,pro);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("");
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  if((PyObject *)capi_pro_tmp!=pro_capi) {
    Py_XDECREF(capi_pro_tmp); }
  }  /*if (capi_pro_tmp == NULL) ... else of pro*/
  /* End of cleaning variable pro */
  if((PyObject *)capi_rr_tmp!=rr_capi) {
    Py_XDECREF(capi_rr_tmp); }
  }  /*if (capi_rr_tmp == NULL) ... else of rr*/
  /* End of cleaning variable rr */
  } /*CHECKSCALAR(shape(rn,0)==ir)*/
  } /*if (f2py_success) of ir*/
  /* End of cleaning variable ir */
  } /*CHECKSCALAR(shape(rn,1)==nion)*/
  } /*if (f2py_success) of nion*/
  /* End of cleaning variable nion */
  } /*if (f2py_success) of dsaw*/
  /* End of cleaning variable dsaw */
  } /*if (f2py_success) of rsaw*/
  /* End of cleaning variable rsaw */
  if((PyObject *)capi_rn_tmp!=rn_capi) {
    Py_XDECREF(capi_rn_tmp); }
  }  /*if (capi_rn_tmp == NULL) ... else of rn*/
  /* End of cleaning variable rn */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/******************************* end of saw_mix *******************************/

/********************************* edge_model *********************************/
static char doc_f2py_rout__aurora_edge_model[] = "\
divnew,tsu,dsu,dsul = edge_model(ra,rn,diff,conv,par_loss_rate,det,rvol_lcfs,dbound,dlim,prox,rr,pro,rcl,taudiv,taupump,divbls,divold,flx,tve,npump,[nion,ir])\n\nWrapper for ``edge_model``.\
\n\nParameters\n----------\n"
"ra : in/output rank-2 array('d') with bounds (ir,nion)\n"
"rn : in/output rank-2 array('d') with bounds (ir,nion)\n"
"diff : input rank-2 array('d') with bounds (ir,nion)\n"
"conv : input rank-2 array('d') with bounds (ir,nion)\n"
"par_loss_rate : input rank-1 array('d') with bounds (ir)\n"
"det : input float\n"
"rvol_lcfs : input float\n"
"dbound : input float\n"
"dlim : input float\n"
"prox : input float\n"
"rr : input rank-1 array('d') with bounds (ir)\n"
"pro : input rank-1 array('d') with bounds (ir)\n"
"rcl : input float\n"
"taudiv : input float\n"
"taupump : input float\n"
"divbls : input float\n"
"divold : input float\n"
"flx : input float\n"
"tve : in/output rank-0 array(float,'d')\n"
"npump : in/output rank-0 array(float,'d')\n"
"\nOther Parameters\n----------------\n"
"nion : input int, optional\n    Default: shape(ra,1)\n"
"ir : input int, optional\n    Default: shape(ra,0)\n"
"\nReturns\n-------\n"
"divnew : float\n"
"tsu : float\n"
"dsu : float\n"
"dsul : float";
/* extern void F_FUNC_US(edge_model,EDGE_MODEL)(int*,int*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*); */
static PyObject *f2py_rout__aurora_edge_model(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,int*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  int nion = 0;
  PyObject *nion_capi = Py_None;
  int ir = 0;
  PyObject *ir_capi = Py_None;
  double *ra = NULL;
  npy_intp ra_Dims[2] = {-1, -1};
  const int ra_Rank = 2;
  PyArrayObject *capi_ra_tmp = NULL;
  int capi_ra_intent = 0;
  PyObject *ra_capi = Py_None;
  double *rn = NULL;
  npy_intp rn_Dims[2] = {-1, -1};
  const int rn_Rank = 2;
  PyArrayObject *capi_rn_tmp = NULL;
  int capi_rn_intent = 0;
  PyObject *rn_capi = Py_None;
  double *diff = NULL;
  npy_intp diff_Dims[2] = {-1, -1};
  const int diff_Rank = 2;
  PyArrayObject *capi_diff_tmp = NULL;
  int capi_diff_intent = 0;
  PyObject *diff_capi = Py_None;
  double *conv = NULL;
  npy_intp conv_Dims[2] = {-1, -1};
  const int conv_Rank = 2;
  PyArrayObject *capi_conv_tmp = NULL;
  int capi_conv_intent = 0;
  PyObject *conv_capi = Py_None;
  double *par_loss_rate = NULL;
  npy_intp par_loss_rate_Dims[1] = {-1};
  const int par_loss_rate_Rank = 1;
  PyArrayObject *capi_par_loss_rate_tmp = NULL;
  int capi_par_loss_rate_intent = 0;
  PyObject *par_loss_rate_capi = Py_None;
  double det = 0;
  PyObject *det_capi = Py_None;
  double rvol_lcfs = 0;
  PyObject *rvol_lcfs_capi = Py_None;
  double dbound = 0;
  PyObject *dbound_capi = Py_None;
  double dlim = 0;
  PyObject *dlim_capi = Py_None;
  double prox = 0;
  PyObject *prox_capi = Py_None;
  double *rr = NULL;
  npy_intp rr_Dims[1] = {-1};
  const int rr_Rank = 1;
  PyArrayObject *capi_rr_tmp = NULL;
  int capi_rr_intent = 0;
  PyObject *rr_capi = Py_None;
  double *pro = NULL;
  npy_intp pro_Dims[1] = {-1};
  const int pro_Rank = 1;
  PyArrayObject *capi_pro_tmp = NULL;
  int capi_pro_intent = 0;
  PyObject *pro_capi = Py_None;
  double rcl = 0;
  PyObject *rcl_capi = Py_None;
  double taudiv = 0;
  PyObject *taudiv_capi = Py_None;
  double taupump = 0;
  PyObject *taupump_capi = Py_None;
  double divbls = 0;
  PyObject *divbls_capi = Py_None;
  double divold = 0;
  PyObject *divold_capi = Py_None;
  double flx = 0;
  PyObject *flx_capi = Py_None;
  double divnew = 0;
  double tve = 0;
  PyObject *tve_capi = Py_None;
  double npump = 0;
  PyObject *npump_capi = Py_None;
  double tsu = 0;
  double dsu = 0;
  double dsul = 0;
  static char *capi_kwlist[] = {"ra","rn","diff","conv","par_loss_rate","det","rvol_lcfs","dbound","dlim","prox","rr","pro","rcl","taudiv","taupump","divbls","divold","flx","tve","npump","nion","ir",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OOOOOOOOOOOOOOOOOOOO|OO:_aurora.edge_model",\
    capi_kwlist,&ra_capi,&rn_capi,&diff_capi,&conv_capi,&par_loss_rate_capi,&det_capi,&rvol_lcfs_capi,&dbound_capi,&dlim_capi,&prox_capi,&rr_capi,&pro_capi,&rcl_capi,&taudiv_capi,&taupump_capi,&divbls_capi,&divold_capi,&flx_capi,&tve_capi,&npump_capi,&nion_capi,&ir_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable ra */
  ;
  capi_ra_intent |= F2PY_INTENT_INOUT;
  capi_ra_tmp = array_from_pyobj(NPY_DOUBLE,ra_Dims,ra_Rank,capi_ra_intent,ra_capi);
  if (capi_ra_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 1st argument `ra' of _aurora.edge_model to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    ra = (double *)(PyArray_DATA(capi_ra_tmp));

  /* Processing variable det */
    f2py_success = double_from_pyobj(&det,det_capi,"_aurora.edge_model() 6th argument (det) can't be converted to double");
  if (f2py_success) {
  /* Processing variable rvol_lcfs */
    f2py_success = double_from_pyobj(&rvol_lcfs,rvol_lcfs_capi,"_aurora.edge_model() 7th argument (rvol_lcfs) can't be converted to double");
  if (f2py_success) {
  /* Processing variable dbound */
    f2py_success = double_from_pyobj(&dbound,dbound_capi,"_aurora.edge_model() 8th argument (dbound) can't be converted to double");
  if (f2py_success) {
  /* Processing variable dlim */
    f2py_success = double_from_pyobj(&dlim,dlim_capi,"_aurora.edge_model() 9th argument (dlim) can't be converted to double");
  if (f2py_success) {
  /* Processing variable prox */
    f2py_success = double_from_pyobj(&prox,prox_capi,"_aurora.edge_model() 10th argument (prox) can't be converted to double");
  if (f2py_success) {
  /* Processing variable rcl */
    f2py_success = double_from_pyobj(&rcl,rcl_capi,"_aurora.edge_model() 13rd argument (rcl) can't be converted to double");
  if (f2py_success) {
  /* Processing variable taudiv */
    f2py_success = double_from_pyobj(&taudiv,taudiv_capi,"_aurora.edge_model() 14th argument (taudiv) can't be converted to double");
  if (f2py_success) {
  /* Processing variable taupump */
    f2py_success = double_from_pyobj(&taupump,taupump_capi,"_aurora.edge_model() 15th argument (taupump) can't be converted to double");
  if (f2py_success) {
  /* Processing variable divbls */
    f2py_success = double_from_pyobj(&divbls,divbls_capi,"_aurora.edge_model() 16th argument (divbls) can't be converted to double");
  if (f2py_success) {
  /* Processing variable divold */
    f2py_success = double_from_pyobj(&divold,divold_capi,"_aurora.edge_model() 17th argument (divold) can't be converted to double");
  if (f2py_success) {
  /* Processing variable flx */
    f2py_success = double_from_pyobj(&flx,flx_capi,"_aurora.edge_model() 18th argument (flx) can't be converted to double");
  if (f2py_success) {
  /* Processing variable divnew */
  /* Processing variable tve */
    f2py_success = double_from_pyobj(&tve,tve_capi,"_aurora.edge_model() 19th argument (tve) can't be converted to double");
  if (f2py_success) {
  /* Processing variable npump */
    f2py_success = double_from_pyobj(&npump,npump_capi,"_aurora.edge_model() 20th argument (npump) can't be converted to double");
  if (f2py_success) {
  /* Processing variable tsu */
  /* Processing variable dsu */
  /* Processing variable dsul */
  /* Processing variable nion */
  if (nion_capi == Py_None) nion = shape(ra,1); else
    f2py_success = int_from_pyobj(&nion,nion_capi,"_aurora.edge_model() 1st keyword (nion) can't be converted to int");
  if (f2py_success) {
  CHECKSCALAR(shape(ra,1)==nion,"shape(ra,1)==nion","1st keyword nion","edge_model:nion=%d",nion) {
  /* Processing variable ir */
  if (ir_capi == Py_None) ir = shape(ra,0); else
    f2py_success = int_from_pyobj(&ir,ir_capi,"_aurora.edge_model() 2nd keyword (ir) can't be converted to int");
  if (f2py_success) {
  CHECKSCALAR(shape(ra,0)==ir,"shape(ra,0)==ir","2nd keyword ir","edge_model:ir=%d",ir) {
  /* Processing variable rn */
  rn_Dims[0]=ir,rn_Dims[1]=nion;
  capi_rn_intent |= F2PY_INTENT_INOUT;
  capi_rn_tmp = array_from_pyobj(NPY_DOUBLE,rn_Dims,rn_Rank,capi_rn_intent,rn_capi);
  if (capi_rn_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 2nd argument `rn' of _aurora.edge_model to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    rn = (double *)(PyArray_DATA(capi_rn_tmp));

  /* Processing variable diff */
  diff_Dims[0]=ir,diff_Dims[1]=nion;
  capi_diff_intent |= F2PY_INTENT_IN;
  capi_diff_tmp = array_from_pyobj(NPY_DOUBLE,diff_Dims,diff_Rank,capi_diff_intent,diff_capi);
  if (capi_diff_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 3rd argument `diff' of _aurora.edge_model to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    diff = (double *)(PyArray_DATA(capi_diff_tmp));

  /* Processing variable conv */
  conv_Dims[0]=ir,conv_Dims[1]=nion;
  capi_conv_intent |= F2PY_INTENT_IN;
  capi_conv_tmp = array_from_pyobj(NPY_DOUBLE,conv_Dims,conv_Rank,capi_conv_intent,conv_capi);
  if (capi_conv_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 4th argument `conv' of _aurora.edge_model to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    conv = (double *)(PyArray_DATA(capi_conv_tmp));

  /* Processing variable par_loss_rate */
  par_loss_rate_Dims[0]=ir;
  capi_par_loss_rate_intent |= F2PY_INTENT_IN;
  capi_par_loss_rate_tmp = array_from_pyobj(NPY_DOUBLE,par_loss_rate_Dims,par_loss_rate_Rank,capi_par_loss_rate_intent,par_loss_rate_capi);
  if (capi_par_loss_rate_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 5th argument `par_loss_rate' of _aurora.edge_model to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    par_loss_rate = (double *)(PyArray_DATA(capi_par_loss_rate_tmp));

  /* Processing variable rr */
  rr_Dims[0]=ir;
  capi_rr_intent |= F2PY_INTENT_IN;
  capi_rr_tmp = array_from_pyobj(NPY_DOUBLE,rr_Dims,rr_Rank,capi_rr_intent,rr_capi);
  if (capi_rr_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 11st argument `rr' of _aurora.edge_model to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    rr = (double *)(PyArray_DATA(capi_rr_tmp));

  /* Processing variable pro */
  pro_Dims[0]=ir;
  capi_pro_intent |= F2PY_INTENT_IN;
  capi_pro_tmp = array_from_pyobj(NPY_DOUBLE,pro_Dims,pro_Rank,capi_pro_intent,pro_capi);
  if (capi_pro_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 12nd argument `pro' of _aurora.edge_model to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    pro = (double *)(PyArray_DATA(capi_pro_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(&nion,&ir,ra,rn,diff,conv,par_loss_rate,&det,&rvol_lcfs,&dbound,&dlim,&prox,rr,pro,&rcl,&taudiv,&taupump,&divbls,&divold,&flx,&divnew,&tve,&npump,&tsu,&dsu,&dsul);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
  f2py_success = try_pyarr_from_double(tve_capi,&tve);
  if (f2py_success) {
  f2py_success = try_pyarr_from_double(npump_capi,&npump);
  if (f2py_success) {
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("dddd",divnew,tsu,dsu,dsul);
/*closepyobjfrom*/
  } /*if (f2py_success) of npump pyobjfrom*/
  } /*if (f2py_success) of tve pyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  if((PyObject *)capi_pro_tmp!=pro_capi) {
    Py_XDECREF(capi_pro_tmp); }
  }  /*if (capi_pro_tmp == NULL) ... else of pro*/
  /* End of cleaning variable pro */
  if((PyObject *)capi_rr_tmp!=rr_capi) {
    Py_XDECREF(capi_rr_tmp); }
  }  /*if (capi_rr_tmp == NULL) ... else of rr*/
  /* End of cleaning variable rr */
  if((PyObject *)capi_par_loss_rate_tmp!=par_loss_rate_capi) {
    Py_XDECREF(capi_par_loss_rate_tmp); }
  }  /*if (capi_par_loss_rate_tmp == NULL) ... else of par_loss_rate*/
  /* End of cleaning variable par_loss_rate */
  if((PyObject *)capi_conv_tmp!=conv_capi) {
    Py_XDECREF(capi_conv_tmp); }
  }  /*if (capi_conv_tmp == NULL) ... else of conv*/
  /* End of cleaning variable conv */
  if((PyObject *)capi_diff_tmp!=diff_capi) {
    Py_XDECREF(capi_diff_tmp); }
  }  /*if (capi_diff_tmp == NULL) ... else of diff*/
  /* End of cleaning variable diff */
  if((PyObject *)capi_rn_tmp!=rn_capi) {
    Py_XDECREF(capi_rn_tmp); }
  }  /*if (capi_rn_tmp == NULL) ... else of rn*/
  /* End of cleaning variable rn */
  } /*CHECKSCALAR(shape(ra,0)==ir)*/
  } /*if (f2py_success) of ir*/
  /* End of cleaning variable ir */
  } /*CHECKSCALAR(shape(ra,1)==nion)*/
  } /*if (f2py_success) of nion*/
  /* End of cleaning variable nion */
  /* End of cleaning variable dsul */
  /* End of cleaning variable dsu */
  /* End of cleaning variable tsu */
  } /*if (f2py_success) of npump*/
  /* End of cleaning variable npump */
  } /*if (f2py_success) of tve*/
  /* End of cleaning variable tve */
  /* End of cleaning variable divnew */
  } /*if (f2py_success) of flx*/
  /* End of cleaning variable flx */
  } /*if (f2py_success) of divold*/
  /* End of cleaning variable divold */
  } /*if (f2py_success) of divbls*/
  /* End of cleaning variable divbls */
  } /*if (f2py_success) of taupump*/
  /* End of cleaning variable taupump */
  } /*if (f2py_success) of taudiv*/
  /* End of cleaning variable taudiv */
  } /*if (f2py_success) of rcl*/
  /* End of cleaning variable rcl */
  } /*if (f2py_success) of prox*/
  /* End of cleaning variable prox */
  } /*if (f2py_success) of dlim*/
  /* End of cleaning variable dlim */
  } /*if (f2py_success) of dbound*/
  /* End of cleaning variable dbound */
  } /*if (f2py_success) of rvol_lcfs*/
  /* End of cleaning variable rvol_lcfs */
  } /*if (f2py_success) of det*/
  /* End of cleaning variable det */
  if((PyObject *)capi_ra_tmp!=ra_capi) {
    Py_XDECREF(capi_ra_tmp); }
  }  /*if (capi_ra_tmp == NULL) ... else of ra*/
  /* End of cleaning variable ra */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/***************************** end of edge_model *****************************/

/****************************** get_radial_grid ******************************/
static char doc_f2py_rout__aurora_get_radial_grid[] = "\
rr,pro,prox,qpr = get_radial_grid(ir,dbound,k,dr_0,dr_1,rvol_lcfs)\n\nWrapper for ``get_radial_grid``.\
\n\nParameters\n----------\n"
"ir : in/output rank-0 array(int,'i')\n"
"dbound : input float\n"
"k : input float\n"
"dr_0 : input float\n"
"dr_1 : input float\n"
"rvol_lcfs : input float\n"
"\nReturns\n-------\n"
"rr : rank-1 array('d') with bounds (1000)\n"
"pro : rank-1 array('d') with bounds (1000)\n"
"prox : float\n"
"qpr : rank-1 array('d') with bounds (1000)";
/* extern void F_FUNC_US(get_radial_grid,GET_RADIAL_GRID)(int*,double*,double*,double*,double*,double*,double*,double*,double*,double*); */
static PyObject *f2py_rout__aurora_get_radial_grid(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,double*,double*,double*,double*,double*,double*,double*,double*,double*)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  int ir = 0;
  PyObject *ir_capi = Py_None;
  double dbound = 0;
  PyObject *dbound_capi = Py_None;
  double k = 0;
  PyObject *k_capi = Py_None;
  double dr_0 = 0;
  PyObject *dr_0_capi = Py_None;
  double dr_1 = 0;
  PyObject *dr_1_capi = Py_None;
  double rvol_lcfs = 0;
  PyObject *rvol_lcfs_capi = Py_None;
  double *rr = NULL;
  npy_intp rr_Dims[1] = {-1};
  const int rr_Rank = 1;
  PyArrayObject *capi_rr_tmp = NULL;
  int capi_rr_intent = 0;
  double *pro = NULL;
  npy_intp pro_Dims[1] = {-1};
  const int pro_Rank = 1;
  PyArrayObject *capi_pro_tmp = NULL;
  int capi_pro_intent = 0;
  double prox = 0;
  double *qpr = NULL;
  npy_intp qpr_Dims[1] = {-1};
  const int qpr_Rank = 1;
  PyArrayObject *capi_qpr_tmp = NULL;
  int capi_qpr_intent = 0;
  static char *capi_kwlist[] = {"ir","dbound","k","dr_0","dr_1","rvol_lcfs",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OOOOOO|:_aurora.get_radial_grid",\
    capi_kwlist,&ir_capi,&dbound_capi,&k_capi,&dr_0_capi,&dr_1_capi,&rvol_lcfs_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable ir */
    f2py_success = int_from_pyobj(&ir,ir_capi,"_aurora.get_radial_grid() 1st argument (ir) can't be converted to int");
  if (f2py_success) {
  /* Processing variable dbound */
    f2py_success = double_from_pyobj(&dbound,dbound_capi,"_aurora.get_radial_grid() 2nd argument (dbound) can't be converted to double");
  if (f2py_success) {
  /* Processing variable k */
    f2py_success = double_from_pyobj(&k,k_capi,"_aurora.get_radial_grid() 3rd argument (k) can't be converted to double");
  if (f2py_success) {
  /* Processing variable dr_0 */
    f2py_success = double_from_pyobj(&dr_0,dr_0_capi,"_aurora.get_radial_grid() 4th argument (dr_0) can't be converted to double");
  if (f2py_success) {
  /* Processing variable dr_1 */
    f2py_success = double_from_pyobj(&dr_1,dr_1_capi,"_aurora.get_radial_grid() 5th argument (dr_1) can't be converted to double");
  if (f2py_success) {
  /* Processing variable rvol_lcfs */
    f2py_success = double_from_pyobj(&rvol_lcfs,rvol_lcfs_capi,"_aurora.get_radial_grid() 6th argument (rvol_lcfs) can't be converted to double");
  if (f2py_success) {
  /* Processing variable rr */
  rr_Dims[0]=1000;
  capi_rr_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_rr_tmp = array_from_pyobj(NPY_DOUBLE,rr_Dims,rr_Rank,capi_rr_intent,Py_None);
  if (capi_rr_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting hidden `rr' of _aurora.get_radial_grid to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    rr = (double *)(PyArray_DATA(capi_rr_tmp));

  /* Processing variable pro */
  pro_Dims[0]=1000;
  capi_pro_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_pro_tmp = array_from_pyobj(NPY_DOUBLE,pro_Dims,pro_Rank,capi_pro_intent,Py_None);
  if (capi_pro_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting hidden `pro' of _aurora.get_radial_grid to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    pro = (double *)(PyArray_DATA(capi_pro_tmp));

  /* Processing variable prox */
  /* Processing variable qpr */
  qpr_Dims[0]=1000;
  capi_qpr_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_qpr_tmp = array_from_pyobj(NPY_DOUBLE,qpr_Dims,qpr_Rank,capi_qpr_intent,Py_None);
  if (capi_qpr_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting hidden `qpr' of _aurora.get_radial_grid to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    qpr = (double *)(PyArray_DATA(capi_qpr_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(&ir,&dbound,&k,&dr_0,&dr_1,&rvol_lcfs,rr,pro,&prox,qpr);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
  f2py_success = try_pyarr_from_int(ir_capi,&ir);
  if (f2py_success) {
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("NNdN",capi_rr_tmp,capi_pro_tmp,prox,capi_qpr_tmp);
/*closepyobjfrom*/
  } /*if (f2py_success) of ir pyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  }  /*if (capi_qpr_tmp == NULL) ... else of qpr*/
  /* End of cleaning variable qpr */
  /* End of cleaning variable prox */
  }  /*if (capi_pro_tmp == NULL) ... else of pro*/
  /* End of cleaning variable pro */
  }  /*if (capi_rr_tmp == NULL) ... else of rr*/
  /* End of cleaning variable rr */
  } /*if (f2py_success) of rvol_lcfs*/
  /* End of cleaning variable rvol_lcfs */
  } /*if (f2py_success) of dr_1*/
  /* End of cleaning variable dr_1 */
  } /*if (f2py_success) of dr_0*/
  /* End of cleaning variable dr_0 */
  } /*if (f2py_success) of k*/
  /* End of cleaning variable k */
  } /*if (f2py_success) of dbound*/
  /* End of cleaning variable dbound */
  } /*if (f2py_success) of ir*/
  /* End of cleaning variable ir */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/*************************** end of get_radial_grid ***************************/

/********************************* time_steps *********************************/
static char doc_f2py_rout__aurora_time_steps[] = "\
t_vals,i_save = time_steps(t,dtstart,itz,tinc,[n,verbose])\n\nWrapper for ``time_steps``.\
\n\nParameters\n----------\n"
"t : input rank-1 array('d') with bounds (n)\n"
"dtstart : input rank-1 array('d') with bounds (n)\n"
"itz : input rank-1 array('i') with bounds (n)\n"
"tinc : input rank-1 array('d') with bounds (n)\n"
"\nOther Parameters\n----------------\n"
"n : input int, optional\n    Default: len(t)\n"
"verbose : input int\n"
"\nReturns\n-------\n"
"t_vals : rank-1 array('d') with bounds (30000)\n"
"i_save : rank-1 array('i') with bounds (30000)";
/* extern void F_FUNC_US(time_steps,TIME_STEPS)(int*,double*,double*,int*,double*,int*,double*,int*); */
static PyObject *f2py_rout__aurora_time_steps(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,double*,double*,int*,double*,int*,double*,int*)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  int n = 0;
  PyObject *n_capi = Py_None;
  double *t = NULL;
  npy_intp t_Dims[1] = {-1};
  const int t_Rank = 1;
  PyArrayObject *capi_t_tmp = NULL;
  int capi_t_intent = 0;
  PyObject *t_capi = Py_None;
  double *dtstart = NULL;
  npy_intp dtstart_Dims[1] = {-1};
  const int dtstart_Rank = 1;
  PyArrayObject *capi_dtstart_tmp = NULL;
  int capi_dtstart_intent = 0;
  PyObject *dtstart_capi = Py_None;
  int *itz = NULL;
  npy_intp itz_Dims[1] = {-1};
  const int itz_Rank = 1;
  PyArrayObject *capi_itz_tmp = NULL;
  int capi_itz_intent = 0;
  PyObject *itz_capi = Py_None;
  double *tinc = NULL;
  npy_intp tinc_Dims[1] = {-1};
  const int tinc_Rank = 1;
  PyArrayObject *capi_tinc_tmp = NULL;
  int capi_tinc_intent = 0;
  PyObject *tinc_capi = Py_None;
  int verbose = 0;
  PyObject *verbose_capi = Py_None;
  double *t_vals = NULL;
  npy_intp t_vals_Dims[1] = {-1};
  const int t_vals_Rank = 1;
  PyArrayObject *capi_t_vals_tmp = NULL;
  int capi_t_vals_intent = 0;
  int *i_save = NULL;
  npy_intp i_save_Dims[1] = {-1};
  const int i_save_Rank = 1;
  PyArrayObject *capi_i_save_tmp = NULL;
  int capi_i_save_intent = 0;
  static char *capi_kwlist[] = {"t","dtstart","itz","tinc","n","verbose",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OOOO|OO:_aurora.time_steps",\
    capi_kwlist,&t_capi,&dtstart_capi,&itz_capi,&tinc_capi,&n_capi,&verbose_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable t */
  ;
  capi_t_intent |= F2PY_INTENT_IN;
  capi_t_tmp = array_from_pyobj(NPY_DOUBLE,t_Dims,t_Rank,capi_t_intent,t_capi);
  if (capi_t_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 1st argument `t' of _aurora.time_steps to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    t = (double *)(PyArray_DATA(capi_t_tmp));

  /* Processing variable verbose */
  if (verbose_capi != Py_None)
    verbose = (int)PyObject_IsTrue(verbose_capi);
    f2py_success = 1;
  if (f2py_success) {
  /* Processing variable t_vals */
  t_vals_Dims[0]=30000;
  capi_t_vals_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_t_vals_tmp = array_from_pyobj(NPY_DOUBLE,t_vals_Dims,t_vals_Rank,capi_t_vals_intent,Py_None);
  if (capi_t_vals_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting hidden `t_vals' of _aurora.time_steps to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    t_vals = (double *)(PyArray_DATA(capi_t_vals_tmp));

  /* Processing variable i_save */
  i_save_Dims[0]=30000;
  capi_i_save_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_i_save_tmp = array_from_pyobj(NPY_INT,i_save_Dims,i_save_Rank,capi_i_save_intent,Py_None);
  if (capi_i_save_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting hidden `i_save' of _aurora.time_steps to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    i_save = (int *)(PyArray_DATA(capi_i_save_tmp));

  /* Processing variable n */
  if (n_capi == Py_None) n = len(t); else
    f2py_success = int_from_pyobj(&n,n_capi,"_aurora.time_steps() 1st keyword (n) can't be converted to int");
  if (f2py_success) {
  CHECKSCALAR(len(t)>=n,"len(t)>=n","1st keyword n","time_steps:n=%d",n) {
  /* Processing variable dtstart */
  dtstart_Dims[0]=n;
  capi_dtstart_intent |= F2PY_INTENT_IN;
  capi_dtstart_tmp = array_from_pyobj(NPY_DOUBLE,dtstart_Dims,dtstart_Rank,capi_dtstart_intent,dtstart_capi);
  if (capi_dtstart_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 2nd argument `dtstart' of _aurora.time_steps to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    dtstart = (double *)(PyArray_DATA(capi_dtstart_tmp));

  /* Processing variable itz */
  itz_Dims[0]=n;
  capi_itz_intent |= F2PY_INTENT_IN;
  capi_itz_tmp = array_from_pyobj(NPY_INT,itz_Dims,itz_Rank,capi_itz_intent,itz_capi);
  if (capi_itz_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 3rd argument `itz' of _aurora.time_steps to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    itz = (int *)(PyArray_DATA(capi_itz_tmp));

  /* Processing variable tinc */
  tinc_Dims[0]=n;
  capi_tinc_intent |= F2PY_INTENT_IN;
  capi_tinc_tmp = array_from_pyobj(NPY_DOUBLE,tinc_Dims,tinc_Rank,capi_tinc_intent,tinc_capi);
  if (capi_tinc_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 4th argument `tinc' of _aurora.time_steps to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    tinc = (double *)(PyArray_DATA(capi_tinc_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(&n,t,dtstart,itz,tinc,&verbose,t_vals,i_save);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("NN",capi_t_vals_tmp,capi_i_save_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  if((PyObject *)capi_tinc_tmp!=tinc_capi) {
    Py_XDECREF(capi_tinc_tmp); }
  }  /*if (capi_tinc_tmp == NULL) ... else of tinc*/
  /* End of cleaning variable tinc */
  if((PyObject *)capi_itz_tmp!=itz_capi) {
    Py_XDECREF(capi_itz_tmp); }
  }  /*if (capi_itz_tmp == NULL) ... else of itz*/
  /* End of cleaning variable itz */
  if((PyObject *)capi_dtstart_tmp!=dtstart_capi) {
    Py_XDECREF(capi_dtstart_tmp); }
  }  /*if (capi_dtstart_tmp == NULL) ... else of dtstart*/
  /* End of cleaning variable dtstart */
  } /*CHECKSCALAR(len(t)>=n)*/
  } /*if (f2py_success) of n*/
  /* End of cleaning variable n */
  }  /*if (capi_i_save_tmp == NULL) ... else of i_save*/
  /* End of cleaning variable i_save */
  }  /*if (capi_t_vals_tmp == NULL) ... else of t_vals*/
  /* End of cleaning variable t_vals */
  } /*if (f2py_success) of verbose*/
  /* End of cleaning variable verbose */
  if((PyObject *)capi_t_tmp!=t_capi) {
    Py_XDECREF(capi_t_tmp); }
  }  /*if (capi_t_tmp == NULL) ... else of t*/
  /* End of cleaning variable t */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/***************************** end of time_steps *****************************/

/********************************** impden0 **********************************/
static char doc_f2py_rout__aurora_impden0[] = "\
rn,rcld,rclw = impden0(ra,diff,conv,par_loss_rate,src_prof,s_rates,r_rates,rr,pro,qpr,flx,dlen,det,rcl,tsuold,dsulold,divold,divbls,taudiv,tauwret,a,b,c,d1,bet,gam,nret,[nion,ir])\n\nWrapper for ``impden0``.\
\n\nParameters\n----------\n"
"ra : input rank-2 array('d') with bounds (ir,nion)\n"
"diff : input rank-2 array('d') with bounds (ir,nion)\n"
"conv : input rank-2 array('d') with bounds (ir,nion)\n"
"par_loss_rate : input rank-1 array('d') with bounds (ir)\n"
"src_prof : input rank-1 array('d') with bounds (ir)\n"
"s_rates : input rank-2 array('d') with bounds (ir,nion)\n"
"r_rates : input rank-2 array('d') with bounds (ir,nion)\n"
"rr : input rank-1 array('d') with bounds (ir)\n"
"pro : input rank-1 array('d') with bounds (ir)\n"
"qpr : input rank-1 array('d') with bounds (ir)\n"
"flx : input float\n"
"dlen : input float\n"
"det : input float\n"
"rcl : input float\n"
"tsuold : input float\n"
"dsulold : input float\n"
"divold : input float\n"
"divbls : input float\n"
"taudiv : input float\n"
"tauwret : input float\n"
"a : in/output rank-2 array('d') with bounds (ir,nion)\n"
"b : in/output rank-2 array('d') with bounds (ir,nion)\n"
"c : in/output rank-2 array('d') with bounds (ir,nion)\n"
"d1 : in/output rank-1 array('d') with bounds (ir)\n"
"bet : in/output rank-1 array('d') with bounds (ir)\n"
"gam : in/output rank-1 array('d') with bounds (ir)\n"
"nret : in/output rank-0 array(float,'d')\n"
"\nOther Parameters\n----------------\n"
"nion : input int, optional\n    Default: shape(ra,1)\n"
"ir : input int, optional\n    Default: shape(ra,0)\n"
"\nReturns\n-------\n"
"rn : rank-2 array('d') with bounds (ir,nion)\n"
"rcld : float\n"
"rclw : float";
/* extern void F_FUNC(impden0,IMPDEN0)(int*,int*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*); */
static PyObject *f2py_rout__aurora_impden0(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,int*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  int nion = 0;
  PyObject *nion_capi = Py_None;
  int ir = 0;
  PyObject *ir_capi = Py_None;
  double *ra = NULL;
  npy_intp ra_Dims[2] = {-1, -1};
  const int ra_Rank = 2;
  PyArrayObject *capi_ra_tmp = NULL;
  int capi_ra_intent = 0;
  PyObject *ra_capi = Py_None;
  double *rn = NULL;
  npy_intp rn_Dims[2] = {-1, -1};
  const int rn_Rank = 2;
  PyArrayObject *capi_rn_tmp = NULL;
  int capi_rn_intent = 0;
  double *diff = NULL;
  npy_intp diff_Dims[2] = {-1, -1};
  const int diff_Rank = 2;
  PyArrayObject *capi_diff_tmp = NULL;
  int capi_diff_intent = 0;
  PyObject *diff_capi = Py_None;
  double *conv = NULL;
  npy_intp conv_Dims[2] = {-1, -1};
  const int conv_Rank = 2;
  PyArrayObject *capi_conv_tmp = NULL;
  int capi_conv_intent = 0;
  PyObject *conv_capi = Py_None;
  double *par_loss_rate = NULL;
  npy_intp par_loss_rate_Dims[1] = {-1};
  const int par_loss_rate_Rank = 1;
  PyArrayObject *capi_par_loss_rate_tmp = NULL;
  int capi_par_loss_rate_intent = 0;
  PyObject *par_loss_rate_capi = Py_None;
  double *src_prof = NULL;
  npy_intp src_prof_Dims[1] = {-1};
  const int src_prof_Rank = 1;
  PyArrayObject *capi_src_prof_tmp = NULL;
  int capi_src_prof_intent = 0;
  PyObject *src_prof_capi = Py_None;
  double *s_rates = NULL;
  npy_intp s_rates_Dims[2] = {-1, -1};
  const int s_rates_Rank = 2;
  PyArrayObject *capi_s_rates_tmp = NULL;
  int capi_s_rates_intent = 0;
  PyObject *s_rates_capi = Py_None;
  double *r_rates = NULL;
  npy_intp r_rates_Dims[2] = {-1, -1};
  const int r_rates_Rank = 2;
  PyArrayObject *capi_r_rates_tmp = NULL;
  int capi_r_rates_intent = 0;
  PyObject *r_rates_capi = Py_None;
  double *rr = NULL;
  npy_intp rr_Dims[1] = {-1};
  const int rr_Rank = 1;
  PyArrayObject *capi_rr_tmp = NULL;
  int capi_rr_intent = 0;
  PyObject *rr_capi = Py_None;
  double *pro = NULL;
  npy_intp pro_Dims[1] = {-1};
  const int pro_Rank = 1;
  PyArrayObject *capi_pro_tmp = NULL;
  int capi_pro_intent = 0;
  PyObject *pro_capi = Py_None;
  double *qpr = NULL;
  npy_intp qpr_Dims[1] = {-1};
  const int qpr_Rank = 1;
  PyArrayObject *capi_qpr_tmp = NULL;
  int capi_qpr_intent = 0;
  PyObject *qpr_capi = Py_None;
  double flx = 0;
  PyObject *flx_capi = Py_None;
  double dlen = 0;
  PyObject *dlen_capi = Py_None;
  double det = 0;
  PyObject *det_capi = Py_None;
  double rcl = 0;
  PyObject *rcl_capi = Py_None;
  double tsuold = 0;
  PyObject *tsuold_capi = Py_None;
  double dsulold = 0;
  PyObject *dsulold_capi = Py_None;
  double divold = 0;
  PyObject *divold_capi = Py_None;
  double divbls = 0;
  PyObject *divbls_capi = Py_None;
  double taudiv = 0;
  PyObject *taudiv_capi = Py_None;
  double tauwret = 0;
  PyObject *tauwret_capi = Py_None;
  double *a = NULL;
  npy_intp a_Dims[2] = {-1, -1};
  const int a_Rank = 2;
  PyArrayObject *capi_a_tmp = NULL;
  int capi_a_intent = 0;
  PyObject *a_capi = Py_None;
  double *b = NULL;
  npy_intp b_Dims[2] = {-1, -1};
  const int b_Rank = 2;
  PyArrayObject *capi_b_tmp = NULL;
  int capi_b_intent = 0;
  PyObject *b_capi = Py_None;
  double *c = NULL;
  npy_intp c_Dims[2] = {-1, -1};
  const int c_Rank = 2;
  PyArrayObject *capi_c_tmp = NULL;
  int capi_c_intent = 0;
  PyObject *c_capi = Py_None;
  double *d1 = NULL;
  npy_intp d1_Dims[1] = {-1};
  const int d1_Rank = 1;
  PyArrayObject *capi_d1_tmp = NULL;
  int capi_d1_intent = 0;
  PyObject *d1_capi = Py_None;
  double *bet = NULL;
  npy_intp bet_Dims[1] = {-1};
  const int bet_Rank = 1;
  PyArrayObject *capi_bet_tmp = NULL;
  int capi_bet_intent = 0;
  PyObject *bet_capi = Py_None;
  double *gam = NULL;
  npy_intp gam_Dims[1] = {-1};
  const int gam_Rank = 1;
  PyArrayObject *capi_gam_tmp = NULL;
  int capi_gam_intent = 0;
  PyObject *gam_capi = Py_None;
  double nret = 0;
  PyObject *nret_capi = Py_None;
  double rcld = 0;
  double rclw = 0;
  static char *capi_kwlist[] = {"ra","diff","conv","par_loss_rate","src_prof","s_rates","r_rates","rr","pro","qpr","flx","dlen","det","rcl","tsuold","dsulold","divold","divbls","taudiv","tauwret","a","b","c","d1","bet","gam","nret","nion","ir",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OOOOOOOOOOOOOOOOOOOOOOOOOOO|OO:_aurora.impden0",\
    capi_kwlist,&ra_capi,&diff_capi,&conv_capi,&par_loss_rate_capi,&src_prof_capi,&s_rates_capi,&r_rates_capi,&rr_capi,&pro_capi,&qpr_capi,&flx_capi,&dlen_capi,&det_capi,&rcl_capi,&tsuold_capi,&dsulold_capi,&divold_capi,&divbls_capi,&taudiv_capi,&tauwret_capi,&a_capi,&b_capi,&c_capi,&d1_capi,&bet_capi,&gam_capi,&nret_capi,&nion_capi,&ir_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable ra */
  ;
  capi_ra_intent |= F2PY_INTENT_IN;
  capi_ra_tmp = array_from_pyobj(NPY_DOUBLE,ra_Dims,ra_Rank,capi_ra_intent,ra_capi);
  if (capi_ra_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 1st argument `ra' of _aurora.impden0 to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    ra = (double *)(PyArray_DATA(capi_ra_tmp));

  /* Processing variable flx */
    f2py_success = double_from_pyobj(&flx,flx_capi,"_aurora.impden0() 11st argument (flx) can't be converted to double");
  if (f2py_success) {
  /* Processing variable dlen */
    f2py_success = double_from_pyobj(&dlen,dlen_capi,"_aurora.impden0() 12nd argument (dlen) can't be converted to double");
  if (f2py_success) {
  /* Processing variable det */
    f2py_success = double_from_pyobj(&det,det_capi,"_aurora.impden0() 13rd argument (det) can't be converted to double");
  if (f2py_success) {
  /* Processing variable rcl */
    f2py_success = double_from_pyobj(&rcl,rcl_capi,"_aurora.impden0() 14th argument (rcl) can't be converted to double");
  if (f2py_success) {
  /* Processing variable tsuold */
    f2py_success = double_from_pyobj(&tsuold,tsuold_capi,"_aurora.impden0() 15th argument (tsuold) can't be converted to double");
  if (f2py_success) {
  /* Processing variable dsulold */
    f2py_success = double_from_pyobj(&dsulold,dsulold_capi,"_aurora.impden0() 16th argument (dsulold) can't be converted to double");
  if (f2py_success) {
  /* Processing variable divold */
    f2py_success = double_from_pyobj(&divold,divold_capi,"_aurora.impden0() 17th argument (divold) can't be converted to double");
  if (f2py_success) {
  /* Processing variable divbls */
    f2py_success = double_from_pyobj(&divbls,divbls_capi,"_aurora.impden0() 18th argument (divbls) can't be converted to double");
  if (f2py_success) {
  /* Processing variable taudiv */
    f2py_success = double_from_pyobj(&taudiv,taudiv_capi,"_aurora.impden0() 19th argument (taudiv) can't be converted to double");
  if (f2py_success) {
  /* Processing variable tauwret */
    f2py_success = double_from_pyobj(&tauwret,tauwret_capi,"_aurora.impden0() 20th argument (tauwret) can't be converted to double");
  if (f2py_success) {
  /* Processing variable nret */
    f2py_success = double_from_pyobj(&nret,nret_capi,"_aurora.impden0() 27th argument (nret) can't be converted to double");
  if (f2py_success) {
  /* Processing variable rcld */
  /* Processing variable rclw */
  /* Processing variable nion */
  if (nion_capi == Py_None) nion = shape(ra,1); else
    f2py_success = int_from_pyobj(&nion,nion_capi,"_aurora.impden0() 1st keyword (nion) can't be converted to int");
  if (f2py_success) {
  CHECKSCALAR(shape(ra,1)==nion,"shape(ra,1)==nion","1st keyword nion","impden0:nion=%d",nion) {
  /* Processing variable ir */
  if (ir_capi == Py_None) ir = shape(ra,0); else
    f2py_success = int_from_pyobj(&ir,ir_capi,"_aurora.impden0() 2nd keyword (ir) can't be converted to int");
  if (f2py_success) {
  CHECKSCALAR(shape(ra,0)==ir,"shape(ra,0)==ir","2nd keyword ir","impden0:ir=%d",ir) {
  /* Processing variable rn */
  rn_Dims[0]=ir,rn_Dims[1]=nion;
  capi_rn_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_rn_tmp = array_from_pyobj(NPY_DOUBLE,rn_Dims,rn_Rank,capi_rn_intent,Py_None);
  if (capi_rn_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting hidden `rn' of _aurora.impden0 to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    rn = (double *)(PyArray_DATA(capi_rn_tmp));

  /* Processing variable diff */
  diff_Dims[0]=ir,diff_Dims[1]=nion;
  capi_diff_intent |= F2PY_INTENT_IN;
  capi_diff_tmp = array_from_pyobj(NPY_DOUBLE,diff_Dims,diff_Rank,capi_diff_intent,diff_capi);
  if (capi_diff_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 2nd argument `diff' of _aurora.impden0 to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    diff = (double *)(PyArray_DATA(capi_diff_tmp));

  /* Processing variable conv */
  conv_Dims[0]=ir,conv_Dims[1]=nion;
  capi_conv_intent |= F2PY_INTENT_IN;
  capi_conv_tmp = array_from_pyobj(NPY_DOUBLE,conv_Dims,conv_Rank,capi_conv_intent,conv_capi);
  if (capi_conv_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 3rd argument `conv' of _aurora.impden0 to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    conv = (double *)(PyArray_DATA(capi_conv_tmp));

  /* Processing variable par_loss_rate */
  par_loss_rate_Dims[0]=ir;
  capi_par_loss_rate_intent |= F2PY_INTENT_IN;
  capi_par_loss_rate_tmp = array_from_pyobj(NPY_DOUBLE,par_loss_rate_Dims,par_loss_rate_Rank,capi_par_loss_rate_intent,par_loss_rate_capi);
  if (capi_par_loss_rate_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 4th argument `par_loss_rate' of _aurora.impden0 to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    par_loss_rate = (double *)(PyArray_DATA(capi_par_loss_rate_tmp));

  /* Processing variable src_prof */
  src_prof_Dims[0]=ir;
  capi_src_prof_intent |= F2PY_INTENT_IN;
  capi_src_prof_tmp = array_from_pyobj(NPY_DOUBLE,src_prof_Dims,src_prof_Rank,capi_src_prof_intent,src_prof_capi);
  if (capi_src_prof_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 5th argument `src_prof' of _aurora.impden0 to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    src_prof = (double *)(PyArray_DATA(capi_src_prof_tmp));

  /* Processing variable s_rates */
  s_rates_Dims[0]=ir,s_rates_Dims[1]=nion;
  capi_s_rates_intent |= F2PY_INTENT_IN;
  capi_s_rates_tmp = array_from_pyobj(NPY_DOUBLE,s_rates_Dims,s_rates_Rank,capi_s_rates_intent,s_rates_capi);
  if (capi_s_rates_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 6th argument `s_rates' of _aurora.impden0 to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    s_rates = (double *)(PyArray_DATA(capi_s_rates_tmp));

  /* Processing variable r_rates */
  r_rates_Dims[0]=ir,r_rates_Dims[1]=nion;
  capi_r_rates_intent |= F2PY_INTENT_IN;
  capi_r_rates_tmp = array_from_pyobj(NPY_DOUBLE,r_rates_Dims,r_rates_Rank,capi_r_rates_intent,r_rates_capi);
  if (capi_r_rates_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 7th argument `r_rates' of _aurora.impden0 to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    r_rates = (double *)(PyArray_DATA(capi_r_rates_tmp));

  /* Processing variable rr */
  rr_Dims[0]=ir;
  capi_rr_intent |= F2PY_INTENT_IN;
  capi_rr_tmp = array_from_pyobj(NPY_DOUBLE,rr_Dims,rr_Rank,capi_rr_intent,rr_capi);
  if (capi_rr_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 8th argument `rr' of _aurora.impden0 to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    rr = (double *)(PyArray_DATA(capi_rr_tmp));

  /* Processing variable pro */
  pro_Dims[0]=ir;
  capi_pro_intent |= F2PY_INTENT_IN;
  capi_pro_tmp = array_from_pyobj(NPY_DOUBLE,pro_Dims,pro_Rank,capi_pro_intent,pro_capi);
  if (capi_pro_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 9th argument `pro' of _aurora.impden0 to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    pro = (double *)(PyArray_DATA(capi_pro_tmp));

  /* Processing variable qpr */
  qpr_Dims[0]=ir;
  capi_qpr_intent |= F2PY_INTENT_IN;
  capi_qpr_tmp = array_from_pyobj(NPY_DOUBLE,qpr_Dims,qpr_Rank,capi_qpr_intent,qpr_capi);
  if (capi_qpr_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 10th argument `qpr' of _aurora.impden0 to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    qpr = (double *)(PyArray_DATA(capi_qpr_tmp));

  /* Processing variable a */
  a_Dims[0]=ir,a_Dims[1]=nion;
  capi_a_intent |= F2PY_INTENT_INOUT;
  capi_a_tmp = array_from_pyobj(NPY_DOUBLE,a_Dims,a_Rank,capi_a_intent,a_capi);
  if (capi_a_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 21st argument `a' of _aurora.impden0 to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    a = (double *)(PyArray_DATA(capi_a_tmp));

  /* Processing variable b */
  b_Dims[0]=ir,b_Dims[1]=nion;
  capi_b_intent |= F2PY_INTENT_INOUT;
  capi_b_tmp = array_from_pyobj(NPY_DOUBLE,b_Dims,b_Rank,capi_b_intent,b_capi);
  if (capi_b_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 22nd argument `b' of _aurora.impden0 to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    b = (double *)(PyArray_DATA(capi_b_tmp));

  /* Processing variable c */
  c_Dims[0]=ir,c_Dims[1]=nion;
  capi_c_intent |= F2PY_INTENT_INOUT;
  capi_c_tmp = array_from_pyobj(NPY_DOUBLE,c_Dims,c_Rank,capi_c_intent,c_capi);
  if (capi_c_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 23rd argument `c' of _aurora.impden0 to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    c = (double *)(PyArray_DATA(capi_c_tmp));

  /* Processing variable d1 */
  d1_Dims[0]=ir;
  capi_d1_intent |= F2PY_INTENT_INOUT;
  capi_d1_tmp = array_from_pyobj(NPY_DOUBLE,d1_Dims,d1_Rank,capi_d1_intent,d1_capi);
  if (capi_d1_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 24th argument `d1' of _aurora.impden0 to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    d1 = (double *)(PyArray_DATA(capi_d1_tmp));

  /* Processing variable bet */
  bet_Dims[0]=ir;
  capi_bet_intent |= F2PY_INTENT_INOUT;
  capi_bet_tmp = array_from_pyobj(NPY_DOUBLE,bet_Dims,bet_Rank,capi_bet_intent,bet_capi);
  if (capi_bet_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 25th argument `bet' of _aurora.impden0 to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    bet = (double *)(PyArray_DATA(capi_bet_tmp));

  /* Processing variable gam */
  gam_Dims[0]=ir;
  capi_gam_intent |= F2PY_INTENT_INOUT;
  capi_gam_tmp = array_from_pyobj(NPY_DOUBLE,gam_Dims,gam_Rank,capi_gam_intent,gam_capi);
  if (capi_gam_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 26th argument `gam' of _aurora.impden0 to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    gam = (double *)(PyArray_DATA(capi_gam_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(&nion,&ir,ra,rn,diff,conv,par_loss_rate,src_prof,s_rates,r_rates,rr,pro,qpr,&flx,&dlen,&det,&rcl,&tsuold,&dsulold,&divold,&divbls,&taudiv,&tauwret,a,b,c,d1,bet,gam,&nret,&rcld,&rclw);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
  f2py_success = try_pyarr_from_double(nret_capi,&nret);
  if (f2py_success) {
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("Ndd",capi_rn_tmp,rcld,rclw);
/*closepyobjfrom*/
  } /*if (f2py_success) of nret pyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  if((PyObject *)capi_gam_tmp!=gam_capi) {
    Py_XDECREF(capi_gam_tmp); }
  }  /*if (capi_gam_tmp == NULL) ... else of gam*/
  /* End of cleaning variable gam */
  if((PyObject *)capi_bet_tmp!=bet_capi) {
    Py_XDECREF(capi_bet_tmp); }
  }  /*if (capi_bet_tmp == NULL) ... else of bet*/
  /* End of cleaning variable bet */
  if((PyObject *)capi_d1_tmp!=d1_capi) {
    Py_XDECREF(capi_d1_tmp); }
  }  /*if (capi_d1_tmp == NULL) ... else of d1*/
  /* End of cleaning variable d1 */
  if((PyObject *)capi_c_tmp!=c_capi) {
    Py_XDECREF(capi_c_tmp); }
  }  /*if (capi_c_tmp == NULL) ... else of c*/
  /* End of cleaning variable c */
  if((PyObject *)capi_b_tmp!=b_capi) {
    Py_XDECREF(capi_b_tmp); }
  }  /*if (capi_b_tmp == NULL) ... else of b*/
  /* End of cleaning variable b */
  if((PyObject *)capi_a_tmp!=a_capi) {
    Py_XDECREF(capi_a_tmp); }
  }  /*if (capi_a_tmp == NULL) ... else of a*/
  /* End of cleaning variable a */
  if((PyObject *)capi_qpr_tmp!=qpr_capi) {
    Py_XDECREF(capi_qpr_tmp); }
  }  /*if (capi_qpr_tmp == NULL) ... else of qpr*/
  /* End of cleaning variable qpr */
  if((PyObject *)capi_pro_tmp!=pro_capi) {
    Py_XDECREF(capi_pro_tmp); }
  }  /*if (capi_pro_tmp == NULL) ... else of pro*/
  /* End of cleaning variable pro */
  if((PyObject *)capi_rr_tmp!=rr_capi) {
    Py_XDECREF(capi_rr_tmp); }
  }  /*if (capi_rr_tmp == NULL) ... else of rr*/
  /* End of cleaning variable rr */
  if((PyObject *)capi_r_rates_tmp!=r_rates_capi) {
    Py_XDECREF(capi_r_rates_tmp); }
  }  /*if (capi_r_rates_tmp == NULL) ... else of r_rates*/
  /* End of cleaning variable r_rates */
  if((PyObject *)capi_s_rates_tmp!=s_rates_capi) {
    Py_XDECREF(capi_s_rates_tmp); }
  }  /*if (capi_s_rates_tmp == NULL) ... else of s_rates*/
  /* End of cleaning variable s_rates */
  if((PyObject *)capi_src_prof_tmp!=src_prof_capi) {
    Py_XDECREF(capi_src_prof_tmp); }
  }  /*if (capi_src_prof_tmp == NULL) ... else of src_prof*/
  /* End of cleaning variable src_prof */
  if((PyObject *)capi_par_loss_rate_tmp!=par_loss_rate_capi) {
    Py_XDECREF(capi_par_loss_rate_tmp); }
  }  /*if (capi_par_loss_rate_tmp == NULL) ... else of par_loss_rate*/
  /* End of cleaning variable par_loss_rate */
  if((PyObject *)capi_conv_tmp!=conv_capi) {
    Py_XDECREF(capi_conv_tmp); }
  }  /*if (capi_conv_tmp == NULL) ... else of conv*/
  /* End of cleaning variable conv */
  if((PyObject *)capi_diff_tmp!=diff_capi) {
    Py_XDECREF(capi_diff_tmp); }
  }  /*if (capi_diff_tmp == NULL) ... else of diff*/
  /* End of cleaning variable diff */
  }  /*if (capi_rn_tmp == NULL) ... else of rn*/
  /* End of cleaning variable rn */
  } /*CHECKSCALAR(shape(ra,0)==ir)*/
  } /*if (f2py_success) of ir*/
  /* End of cleaning variable ir */
  } /*CHECKSCALAR(shape(ra,1)==nion)*/
  } /*if (f2py_success) of nion*/
  /* End of cleaning variable nion */
  /* End of cleaning variable rclw */
  /* End of cleaning variable rcld */
  } /*if (f2py_success) of nret*/
  /* End of cleaning variable nret */
  } /*if (f2py_success) of tauwret*/
  /* End of cleaning variable tauwret */
  } /*if (f2py_success) of taudiv*/
  /* End of cleaning variable taudiv */
  } /*if (f2py_success) of divbls*/
  /* End of cleaning variable divbls */
  } /*if (f2py_success) of divold*/
  /* End of cleaning variable divold */
  } /*if (f2py_success) of dsulold*/
  /* End of cleaning variable dsulold */
  } /*if (f2py_success) of tsuold*/
  /* End of cleaning variable tsuold */
  } /*if (f2py_success) of rcl*/
  /* End of cleaning variable rcl */
  } /*if (f2py_success) of det*/
  /* End of cleaning variable det */
  } /*if (f2py_success) of dlen*/
  /* End of cleaning variable dlen */
  } /*if (f2py_success) of flx*/
  /* End of cleaning variable flx */
  if((PyObject *)capi_ra_tmp!=ra_capi) {
    Py_XDECREF(capi_ra_tmp); }
  }  /*if (capi_ra_tmp == NULL) ... else of ra*/
  /* End of cleaning variable ra */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/******************************* end of impden0 *******************************/

/********************************** impden1 **********************************/
static char doc_f2py_rout__aurora_impden1[] = "\
rn,rcld,rclw = impden1(ra,diff,conv,par_loss_rate,src_prof,s_rates,r_rates,rr,flx,fall_outsol,det,rcl,tsuold,dsulold,divold,divbls,taudiv,tauwret,evolveneut,nret,[nion,ir])\n\nWrapper for ``impden1``.\
\n\nParameters\n----------\n"
"ra : input rank-2 array('d') with bounds (ir,nion)\n"
"diff : input rank-2 array('d') with bounds (ir,nion)\n"
"conv : input rank-2 array('d') with bounds (ir,nion)\n"
"par_loss_rate : input rank-1 array('d') with bounds (ir)\n"
"src_prof : input rank-1 array('d') with bounds (ir)\n"
"s_rates : input rank-2 array('d') with bounds (ir,nion)\n"
"r_rates : input rank-2 array('d') with bounds (ir,nion)\n"
"rr : input rank-1 array('d') with bounds (ir)\n"
"flx : input float\n"
"fall_outsol : input float\n"
"det : input float\n"
"rcl : input float\n"
"tsuold : input float\n"
"dsulold : input float\n"
"divold : input float\n"
"divbls : input float\n"
"taudiv : input float\n"
"tauwret : input float\n"
"evolveneut : input int\n"
"nret : in/output rank-0 array(float,'d')\n"
"\nOther Parameters\n----------------\n"
"nion : input int, optional\n    Default: shape(ra,1)\n"
"ir : input int, optional\n    Default: shape(ra,0)\n"
"\nReturns\n-------\n"
"rn : rank-2 array('d') with bounds (ir,nion)\n"
"rcld : float\n"
"rclw : float";
/* extern void F_FUNC(impden1,IMPDEN1)(int*,int*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,int*,double*,double*,double*); */
static PyObject *f2py_rout__aurora_impden1(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,int*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,int*,double*,double*,double*)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  int nion = 0;
  PyObject *nion_capi = Py_None;
  int ir = 0;
  PyObject *ir_capi = Py_None;
  double *ra = NULL;
  npy_intp ra_Dims[2] = {-1, -1};
  const int ra_Rank = 2;
  PyArrayObject *capi_ra_tmp = NULL;
  int capi_ra_intent = 0;
  PyObject *ra_capi = Py_None;
  double *rn = NULL;
  npy_intp rn_Dims[2] = {-1, -1};
  const int rn_Rank = 2;
  PyArrayObject *capi_rn_tmp = NULL;
  int capi_rn_intent = 0;
  double *diff = NULL;
  npy_intp diff_Dims[2] = {-1, -1};
  const int diff_Rank = 2;
  PyArrayObject *capi_diff_tmp = NULL;
  int capi_diff_intent = 0;
  PyObject *diff_capi = Py_None;
  double *conv = NULL;
  npy_intp conv_Dims[2] = {-1, -1};
  const int conv_Rank = 2;
  PyArrayObject *capi_conv_tmp = NULL;
  int capi_conv_intent = 0;
  PyObject *conv_capi = Py_None;
  double *par_loss_rate = NULL;
  npy_intp par_loss_rate_Dims[1] = {-1};
  const int par_loss_rate_Rank = 1;
  PyArrayObject *capi_par_loss_rate_tmp = NULL;
  int capi_par_loss_rate_intent = 0;
  PyObject *par_loss_rate_capi = Py_None;
  double *src_prof = NULL;
  npy_intp src_prof_Dims[1] = {-1};
  const int src_prof_Rank = 1;
  PyArrayObject *capi_src_prof_tmp = NULL;
  int capi_src_prof_intent = 0;
  PyObject *src_prof_capi = Py_None;
  double *s_rates = NULL;
  npy_intp s_rates_Dims[2] = {-1, -1};
  const int s_rates_Rank = 2;
  PyArrayObject *capi_s_rates_tmp = NULL;
  int capi_s_rates_intent = 0;
  PyObject *s_rates_capi = Py_None;
  double *r_rates = NULL;
  npy_intp r_rates_Dims[2] = {-1, -1};
  const int r_rates_Rank = 2;
  PyArrayObject *capi_r_rates_tmp = NULL;
  int capi_r_rates_intent = 0;
  PyObject *r_rates_capi = Py_None;
  double *rr = NULL;
  npy_intp rr_Dims[1] = {-1};
  const int rr_Rank = 1;
  PyArrayObject *capi_rr_tmp = NULL;
  int capi_rr_intent = 0;
  PyObject *rr_capi = Py_None;
  double flx = 0;
  PyObject *flx_capi = Py_None;
  double fall_outsol = 0;
  PyObject *fall_outsol_capi = Py_None;
  double det = 0;
  PyObject *det_capi = Py_None;
  double rcl = 0;
  PyObject *rcl_capi = Py_None;
  double tsuold = 0;
  PyObject *tsuold_capi = Py_None;
  double dsulold = 0;
  PyObject *dsulold_capi = Py_None;
  double divold = 0;
  PyObject *divold_capi = Py_None;
  double divbls = 0;
  PyObject *divbls_capi = Py_None;
  double taudiv = 0;
  PyObject *taudiv_capi = Py_None;
  double tauwret = 0;
  PyObject *tauwret_capi = Py_None;
  int evolveneut = 0;
  PyObject *evolveneut_capi = Py_None;
  double nret = 0;
  PyObject *nret_capi = Py_None;
  double rcld = 0;
  double rclw = 0;
  static char *capi_kwlist[] = {"ra","diff","conv","par_loss_rate","src_prof","s_rates","r_rates","rr","flx","fall_outsol","det","rcl","tsuold","dsulold","divold","divbls","taudiv","tauwret","evolveneut","nret","nion","ir",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OOOOOOOOOOOOOOOOOOOO|OO:_aurora.impden1",\
    capi_kwlist,&ra_capi,&diff_capi,&conv_capi,&par_loss_rate_capi,&src_prof_capi,&s_rates_capi,&r_rates_capi,&rr_capi,&flx_capi,&fall_outsol_capi,&det_capi,&rcl_capi,&tsuold_capi,&dsulold_capi,&divold_capi,&divbls_capi,&taudiv_capi,&tauwret_capi,&evolveneut_capi,&nret_capi,&nion_capi,&ir_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable ra */
  ;
  capi_ra_intent |= F2PY_INTENT_IN;
  capi_ra_tmp = array_from_pyobj(NPY_DOUBLE,ra_Dims,ra_Rank,capi_ra_intent,ra_capi);
  if (capi_ra_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 1st argument `ra' of _aurora.impden1 to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    ra = (double *)(PyArray_DATA(capi_ra_tmp));

  /* Processing variable flx */
    f2py_success = double_from_pyobj(&flx,flx_capi,"_aurora.impden1() 9th argument (flx) can't be converted to double");
  if (f2py_success) {
  /* Processing variable fall_outsol */
    f2py_success = double_from_pyobj(&fall_outsol,fall_outsol_capi,"_aurora.impden1() 10th argument (fall_outsol) can't be converted to double");
  if (f2py_success) {
  /* Processing variable det */
    f2py_success = double_from_pyobj(&det,det_capi,"_aurora.impden1() 11st argument (det) can't be converted to double");
  if (f2py_success) {
  /* Processing variable rcl */
    f2py_success = double_from_pyobj(&rcl,rcl_capi,"_aurora.impden1() 12nd argument (rcl) can't be converted to double");
  if (f2py_success) {
  /* Processing variable tsuold */
    f2py_success = double_from_pyobj(&tsuold,tsuold_capi,"_aurora.impden1() 13rd argument (tsuold) can't be converted to double");
  if (f2py_success) {
  /* Processing variable dsulold */
    f2py_success = double_from_pyobj(&dsulold,dsulold_capi,"_aurora.impden1() 14th argument (dsulold) can't be converted to double");
  if (f2py_success) {
  /* Processing variable divold */
    f2py_success = double_from_pyobj(&divold,divold_capi,"_aurora.impden1() 15th argument (divold) can't be converted to double");
  if (f2py_success) {
  /* Processing variable divbls */
    f2py_success = double_from_pyobj(&divbls,divbls_capi,"_aurora.impden1() 16th argument (divbls) can't be converted to double");
  if (f2py_success) {
  /* Processing variable taudiv */
    f2py_success = double_from_pyobj(&taudiv,taudiv_capi,"_aurora.impden1() 17th argument (taudiv) can't be converted to double");
  if (f2py_success) {
  /* Processing variable tauwret */
    f2py_success = double_from_pyobj(&tauwret,tauwret_capi,"_aurora.impden1() 18th argument (tauwret) can't be converted to double");
  if (f2py_success) {
  /* Processing variable evolveneut */
    evolveneut = (int)PyObject_IsTrue(evolveneut_capi);
    f2py_success = 1;
  if (f2py_success) {
  /* Processing variable nret */
    f2py_success = double_from_pyobj(&nret,nret_capi,"_aurora.impden1() 20th argument (nret) can't be converted to double");
  if (f2py_success) {
  /* Processing variable rcld */
  /* Processing variable rclw */
  /* Processing variable nion */
  if (nion_capi == Py_None) nion = shape(ra,1); else
    f2py_success = int_from_pyobj(&nion,nion_capi,"_aurora.impden1() 1st keyword (nion) can't be converted to int");
  if (f2py_success) {
  CHECKSCALAR(shape(ra,1)==nion,"shape(ra,1)==nion","1st keyword nion","impden1:nion=%d",nion) {
  /* Processing variable ir */
  if (ir_capi == Py_None) ir = shape(ra,0); else
    f2py_success = int_from_pyobj(&ir,ir_capi,"_aurora.impden1() 2nd keyword (ir) can't be converted to int");
  if (f2py_success) {
  CHECKSCALAR(shape(ra,0)==ir,"shape(ra,0)==ir","2nd keyword ir","impden1:ir=%d",ir) {
  /* Processing variable rn */
  rn_Dims[0]=ir,rn_Dims[1]=nion;
  capi_rn_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_rn_tmp = array_from_pyobj(NPY_DOUBLE,rn_Dims,rn_Rank,capi_rn_intent,Py_None);
  if (capi_rn_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting hidden `rn' of _aurora.impden1 to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    rn = (double *)(PyArray_DATA(capi_rn_tmp));

  /* Processing variable diff */
  diff_Dims[0]=ir,diff_Dims[1]=nion;
  capi_diff_intent |= F2PY_INTENT_IN;
  capi_diff_tmp = array_from_pyobj(NPY_DOUBLE,diff_Dims,diff_Rank,capi_diff_intent,diff_capi);
  if (capi_diff_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 2nd argument `diff' of _aurora.impden1 to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    diff = (double *)(PyArray_DATA(capi_diff_tmp));

  /* Processing variable conv */
  conv_Dims[0]=ir,conv_Dims[1]=nion;
  capi_conv_intent |= F2PY_INTENT_IN;
  capi_conv_tmp = array_from_pyobj(NPY_DOUBLE,conv_Dims,conv_Rank,capi_conv_intent,conv_capi);
  if (capi_conv_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 3rd argument `conv' of _aurora.impden1 to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    conv = (double *)(PyArray_DATA(capi_conv_tmp));

  /* Processing variable par_loss_rate */
  par_loss_rate_Dims[0]=ir;
  capi_par_loss_rate_intent |= F2PY_INTENT_IN;
  capi_par_loss_rate_tmp = array_from_pyobj(NPY_DOUBLE,par_loss_rate_Dims,par_loss_rate_Rank,capi_par_loss_rate_intent,par_loss_rate_capi);
  if (capi_par_loss_rate_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 4th argument `par_loss_rate' of _aurora.impden1 to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    par_loss_rate = (double *)(PyArray_DATA(capi_par_loss_rate_tmp));

  /* Processing variable src_prof */
  src_prof_Dims[0]=ir;
  capi_src_prof_intent |= F2PY_INTENT_IN;
  capi_src_prof_tmp = array_from_pyobj(NPY_DOUBLE,src_prof_Dims,src_prof_Rank,capi_src_prof_intent,src_prof_capi);
  if (capi_src_prof_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 5th argument `src_prof' of _aurora.impden1 to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    src_prof = (double *)(PyArray_DATA(capi_src_prof_tmp));

  /* Processing variable s_rates */
  s_rates_Dims[0]=ir,s_rates_Dims[1]=nion;
  capi_s_rates_intent |= F2PY_INTENT_IN;
  capi_s_rates_tmp = array_from_pyobj(NPY_DOUBLE,s_rates_Dims,s_rates_Rank,capi_s_rates_intent,s_rates_capi);
  if (capi_s_rates_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 6th argument `s_rates' of _aurora.impden1 to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    s_rates = (double *)(PyArray_DATA(capi_s_rates_tmp));

  /* Processing variable r_rates */
  r_rates_Dims[0]=ir,r_rates_Dims[1]=nion;
  capi_r_rates_intent |= F2PY_INTENT_IN;
  capi_r_rates_tmp = array_from_pyobj(NPY_DOUBLE,r_rates_Dims,r_rates_Rank,capi_r_rates_intent,r_rates_capi);
  if (capi_r_rates_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 7th argument `r_rates' of _aurora.impden1 to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    r_rates = (double *)(PyArray_DATA(capi_r_rates_tmp));

  /* Processing variable rr */
  rr_Dims[0]=ir;
  capi_rr_intent |= F2PY_INTENT_IN;
  capi_rr_tmp = array_from_pyobj(NPY_DOUBLE,rr_Dims,rr_Rank,capi_rr_intent,rr_capi);
  if (capi_rr_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 8th argument `rr' of _aurora.impden1 to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    rr = (double *)(PyArray_DATA(capi_rr_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(&nion,&ir,ra,rn,diff,conv,par_loss_rate,src_prof,s_rates,r_rates,rr,&flx,&fall_outsol,&det,&rcl,&tsuold,&dsulold,&divold,&divbls,&taudiv,&tauwret,&evolveneut,&nret,&rcld,&rclw);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
  f2py_success = try_pyarr_from_double(nret_capi,&nret);
  if (f2py_success) {
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("Ndd",capi_rn_tmp,rcld,rclw);
/*closepyobjfrom*/
  } /*if (f2py_success) of nret pyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  if((PyObject *)capi_rr_tmp!=rr_capi) {
    Py_XDECREF(capi_rr_tmp); }
  }  /*if (capi_rr_tmp == NULL) ... else of rr*/
  /* End of cleaning variable rr */
  if((PyObject *)capi_r_rates_tmp!=r_rates_capi) {
    Py_XDECREF(capi_r_rates_tmp); }
  }  /*if (capi_r_rates_tmp == NULL) ... else of r_rates*/
  /* End of cleaning variable r_rates */
  if((PyObject *)capi_s_rates_tmp!=s_rates_capi) {
    Py_XDECREF(capi_s_rates_tmp); }
  }  /*if (capi_s_rates_tmp == NULL) ... else of s_rates*/
  /* End of cleaning variable s_rates */
  if((PyObject *)capi_src_prof_tmp!=src_prof_capi) {
    Py_XDECREF(capi_src_prof_tmp); }
  }  /*if (capi_src_prof_tmp == NULL) ... else of src_prof*/
  /* End of cleaning variable src_prof */
  if((PyObject *)capi_par_loss_rate_tmp!=par_loss_rate_capi) {
    Py_XDECREF(capi_par_loss_rate_tmp); }
  }  /*if (capi_par_loss_rate_tmp == NULL) ... else of par_loss_rate*/
  /* End of cleaning variable par_loss_rate */
  if((PyObject *)capi_conv_tmp!=conv_capi) {
    Py_XDECREF(capi_conv_tmp); }
  }  /*if (capi_conv_tmp == NULL) ... else of conv*/
  /* End of cleaning variable conv */
  if((PyObject *)capi_diff_tmp!=diff_capi) {
    Py_XDECREF(capi_diff_tmp); }
  }  /*if (capi_diff_tmp == NULL) ... else of diff*/
  /* End of cleaning variable diff */
  }  /*if (capi_rn_tmp == NULL) ... else of rn*/
  /* End of cleaning variable rn */
  } /*CHECKSCALAR(shape(ra,0)==ir)*/
  } /*if (f2py_success) of ir*/
  /* End of cleaning variable ir */
  } /*CHECKSCALAR(shape(ra,1)==nion)*/
  } /*if (f2py_success) of nion*/
  /* End of cleaning variable nion */
  /* End of cleaning variable rclw */
  /* End of cleaning variable rcld */
  } /*if (f2py_success) of nret*/
  /* End of cleaning variable nret */
  } /*if (f2py_success) of evolveneut*/
  /* End of cleaning variable evolveneut */
  } /*if (f2py_success) of tauwret*/
  /* End of cleaning variable tauwret */
  } /*if (f2py_success) of taudiv*/
  /* End of cleaning variable taudiv */
  } /*if (f2py_success) of divbls*/
  /* End of cleaning variable divbls */
  } /*if (f2py_success) of divold*/
  /* End of cleaning variable divold */
  } /*if (f2py_success) of dsulold*/
  /* End of cleaning variable dsulold */
  } /*if (f2py_success) of tsuold*/
  /* End of cleaning variable tsuold */
  } /*if (f2py_success) of rcl*/
  /* End of cleaning variable rcl */
  } /*if (f2py_success) of det*/
  /* End of cleaning variable det */
  } /*if (f2py_success) of fall_outsol*/
  /* End of cleaning variable fall_outsol */
  } /*if (f2py_success) of flx*/
  /* End of cleaning variable flx */
  if((PyObject *)capi_ra_tmp!=ra_capi) {
    Py_XDECREF(capi_ra_tmp); }
  }  /*if (capi_ra_tmp == NULL) ... else of ra*/
  /* End of cleaning variable ra */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/******************************* end of impden1 *******************************/

/************************** impden_consttranspmatrix **************************/
static char doc_f2py_rout__aurora_impden_consttranspmatrix[] = "\
a,b,c,d = impden_consttranspmatrix(rnt,dimp,vimp,dt,fall_outsol,par_loss_rate,rr,[ir])\n\nWrapper for ``impden_consttranspmatrix``.\
\n\nParameters\n----------\n"
"rnt : input rank-1 array('d') with bounds (ir)\n"
"dimp : input rank-1 array('d') with bounds (ir)\n"
"vimp : input rank-1 array('d') with bounds (ir)\n"
"dt : input float\n"
"fall_outsol : input float\n"
"par_loss_rate : input rank-1 array('d') with bounds (ir)\n"
"rr : input rank-1 array('d') with bounds (ir)\n"
"\nOther Parameters\n----------------\n"
"ir : input int, optional\n    Default: len(rnt)\n"
"\nReturns\n-------\n"
"a : rank-1 array('d') with bounds (ir)\n"
"b : rank-1 array('d') with bounds (ir)\n"
"c : rank-1 array('d') with bounds (ir)\n"
"d : rank-1 array('d') with bounds (ir)";
/* extern void F_FUNC_US(impden_consttranspmatrix,IMPDEN_CONSTTRANSPMATRIX)(double*,double*,double*,int*,double*,double*,double*,double*,double*,double*,double*,double*); */
static PyObject *f2py_rout__aurora_impden_consttranspmatrix(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*,int*,double*,double*,double*,double*,double*,double*,double*,double*)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  double *rnt = NULL;
  npy_intp rnt_Dims[1] = {-1};
  const int rnt_Rank = 1;
  PyArrayObject *capi_rnt_tmp = NULL;
  int capi_rnt_intent = 0;
  PyObject *rnt_capi = Py_None;
  double *dimp = NULL;
  npy_intp dimp_Dims[1] = {-1};
  const int dimp_Rank = 1;
  PyArrayObject *capi_dimp_tmp = NULL;
  int capi_dimp_intent = 0;
  PyObject *dimp_capi = Py_None;
  double *vimp = NULL;
  npy_intp vimp_Dims[1] = {-1};
  const int vimp_Rank = 1;
  PyArrayObject *capi_vimp_tmp = NULL;
  int capi_vimp_intent = 0;
  PyObject *vimp_capi = Py_None;
  int ir = 0;
  PyObject *ir_capi = Py_None;
  double dt = 0;
  PyObject *dt_capi = Py_None;
  double fall_outsol = 0;
  PyObject *fall_outsol_capi = Py_None;
  double *par_loss_rate = NULL;
  npy_intp par_loss_rate_Dims[1] = {-1};
  const int par_loss_rate_Rank = 1;
  PyArrayObject *capi_par_loss_rate_tmp = NULL;
  int capi_par_loss_rate_intent = 0;
  PyObject *par_loss_rate_capi = Py_None;
  double *rr = NULL;
  npy_intp rr_Dims[1] = {-1};
  const int rr_Rank = 1;
  PyArrayObject *capi_rr_tmp = NULL;
  int capi_rr_intent = 0;
  PyObject *rr_capi = Py_None;
  double *a = NULL;
  npy_intp a_Dims[1] = {-1};
  const int a_Rank = 1;
  PyArrayObject *capi_a_tmp = NULL;
  int capi_a_intent = 0;
  double *b = NULL;
  npy_intp b_Dims[1] = {-1};
  const int b_Rank = 1;
  PyArrayObject *capi_b_tmp = NULL;
  int capi_b_intent = 0;
  double *c = NULL;
  npy_intp c_Dims[1] = {-1};
  const int c_Rank = 1;
  PyArrayObject *capi_c_tmp = NULL;
  int capi_c_intent = 0;
  double *d = NULL;
  npy_intp d_Dims[1] = {-1};
  const int d_Rank = 1;
  PyArrayObject *capi_d_tmp = NULL;
  int capi_d_intent = 0;
  static char *capi_kwlist[] = {"rnt","dimp","vimp","dt","fall_outsol","par_loss_rate","rr","ir",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OOOOOOO|O:_aurora.impden_consttranspmatrix",\
    capi_kwlist,&rnt_capi,&dimp_capi,&vimp_capi,&dt_capi,&fall_outsol_capi,&par_loss_rate_capi,&rr_capi,&ir_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable rnt */
  ;
  capi_rnt_intent |= F2PY_INTENT_IN;
  capi_rnt_tmp = array_from_pyobj(NPY_DOUBLE,rnt_Dims,rnt_Rank,capi_rnt_intent,rnt_capi);
  if (capi_rnt_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 1st argument `rnt' of _aurora.impden_consttranspmatrix to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    rnt = (double *)(PyArray_DATA(capi_rnt_tmp));

  /* Processing variable dt */
    f2py_success = double_from_pyobj(&dt,dt_capi,"_aurora.impden_consttranspmatrix() 4th argument (dt) can't be converted to double");
  if (f2py_success) {
  /* Processing variable fall_outsol */
    f2py_success = double_from_pyobj(&fall_outsol,fall_outsol_capi,"_aurora.impden_consttranspmatrix() 5th argument (fall_outsol) can't be converted to double");
  if (f2py_success) {
  /* Processing variable ir */
  if (ir_capi == Py_None) ir = len(rnt); else
    f2py_success = int_from_pyobj(&ir,ir_capi,"_aurora.impden_consttranspmatrix() 1st keyword (ir) can't be converted to int");
  if (f2py_success) {
  CHECKSCALAR(len(rnt)>=ir,"len(rnt)>=ir","1st keyword ir","impden_consttranspmatrix:ir=%d",ir) {
  /* Processing variable dimp */
  dimp_Dims[0]=ir;
  capi_dimp_intent |= F2PY_INTENT_IN;
  capi_dimp_tmp = array_from_pyobj(NPY_DOUBLE,dimp_Dims,dimp_Rank,capi_dimp_intent,dimp_capi);
  if (capi_dimp_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 2nd argument `dimp' of _aurora.impden_consttranspmatrix to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    dimp = (double *)(PyArray_DATA(capi_dimp_tmp));

  /* Processing variable vimp */
  vimp_Dims[0]=ir;
  capi_vimp_intent |= F2PY_INTENT_IN;
  capi_vimp_tmp = array_from_pyobj(NPY_DOUBLE,vimp_Dims,vimp_Rank,capi_vimp_intent,vimp_capi);
  if (capi_vimp_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 3rd argument `vimp' of _aurora.impden_consttranspmatrix to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    vimp = (double *)(PyArray_DATA(capi_vimp_tmp));

  /* Processing variable par_loss_rate */
  par_loss_rate_Dims[0]=ir;
  capi_par_loss_rate_intent |= F2PY_INTENT_IN;
  capi_par_loss_rate_tmp = array_from_pyobj(NPY_DOUBLE,par_loss_rate_Dims,par_loss_rate_Rank,capi_par_loss_rate_intent,par_loss_rate_capi);
  if (capi_par_loss_rate_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 6th argument `par_loss_rate' of _aurora.impden_consttranspmatrix to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    par_loss_rate = (double *)(PyArray_DATA(capi_par_loss_rate_tmp));

  /* Processing variable rr */
  rr_Dims[0]=ir;
  capi_rr_intent |= F2PY_INTENT_IN;
  capi_rr_tmp = array_from_pyobj(NPY_DOUBLE,rr_Dims,rr_Rank,capi_rr_intent,rr_capi);
  if (capi_rr_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 7th argument `rr' of _aurora.impden_consttranspmatrix to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    rr = (double *)(PyArray_DATA(capi_rr_tmp));

  /* Processing variable a */
  a_Dims[0]=ir;
  capi_a_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_a_tmp = array_from_pyobj(NPY_DOUBLE,a_Dims,a_Rank,capi_a_intent,Py_None);
  if (capi_a_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting hidden `a' of _aurora.impden_consttranspmatrix to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    a = (double *)(PyArray_DATA(capi_a_tmp));

  /* Processing variable b */
  b_Dims[0]=ir;
  capi_b_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_b_tmp = array_from_pyobj(NPY_DOUBLE,b_Dims,b_Rank,capi_b_intent,Py_None);
  if (capi_b_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting hidden `b' of _aurora.impden_consttranspmatrix to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    b = (double *)(PyArray_DATA(capi_b_tmp));

  /* Processing variable c */
  c_Dims[0]=ir;
  capi_c_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_c_tmp = array_from_pyobj(NPY_DOUBLE,c_Dims,c_Rank,capi_c_intent,Py_None);
  if (capi_c_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting hidden `c' of _aurora.impden_consttranspmatrix to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    c = (double *)(PyArray_DATA(capi_c_tmp));

  /* Processing variable d */
  d_Dims[0]=ir;
  capi_d_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_d_tmp = array_from_pyobj(NPY_DOUBLE,d_Dims,d_Rank,capi_d_intent,Py_None);
  if (capi_d_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting hidden `d' of _aurora.impden_consttranspmatrix to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    d = (double *)(PyArray_DATA(capi_d_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(rnt,dimp,vimp,&ir,&dt,&fall_outsol,par_loss_rate,rr,a,b,c,d);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("NNNN",capi_a_tmp,capi_b_tmp,capi_c_tmp,capi_d_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  }  /*if (capi_d_tmp == NULL) ... else of d*/
  /* End of cleaning variable d */
  }  /*if (capi_c_tmp == NULL) ... else of c*/
  /* End of cleaning variable c */
  }  /*if (capi_b_tmp == NULL) ... else of b*/
  /* End of cleaning variable b */
  }  /*if (capi_a_tmp == NULL) ... else of a*/
  /* End of cleaning variable a */
  if((PyObject *)capi_rr_tmp!=rr_capi) {
    Py_XDECREF(capi_rr_tmp); }
  }  /*if (capi_rr_tmp == NULL) ... else of rr*/
  /* End of cleaning variable rr */
  if((PyObject *)capi_par_loss_rate_tmp!=par_loss_rate_capi) {
    Py_XDECREF(capi_par_loss_rate_tmp); }
  }  /*if (capi_par_loss_rate_tmp == NULL) ... else of par_loss_rate*/
  /* End of cleaning variable par_loss_rate */
  if((PyObject *)capi_vimp_tmp!=vimp_capi) {
    Py_XDECREF(capi_vimp_tmp); }
  }  /*if (capi_vimp_tmp == NULL) ... else of vimp*/
  /* End of cleaning variable vimp */
  if((PyObject *)capi_dimp_tmp!=dimp_capi) {
    Py_XDECREF(capi_dimp_tmp); }
  }  /*if (capi_dimp_tmp == NULL) ... else of dimp*/
  /* End of cleaning variable dimp */
  } /*CHECKSCALAR(len(rnt)>=ir)*/
  } /*if (f2py_success) of ir*/
  /* End of cleaning variable ir */
  } /*if (f2py_success) of fall_outsol*/
  /* End of cleaning variable fall_outsol */
  } /*if (f2py_success) of dt*/
  /* End of cleaning variable dt */
  if((PyObject *)capi_rnt_tmp!=rnt_capi) {
    Py_XDECREF(capi_rnt_tmp); }
  }  /*if (capi_rnt_tmp == NULL) ... else of rnt*/
  /* End of cleaning variable rnt */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/********************** end of impden_consttranspmatrix **********************/

/************************************ tdma ************************************/
static char doc_f2py_rout__aurora_tdma[] = "\
sol = tdma(dlow,dmain,dupp,rhs,[n])\n\nWrapper for ``tdma``.\
\n\nParameters\n----------\n"
"dlow : input rank-1 array('d') with bounds (n)\n"
"dmain : input rank-1 array('d') with bounds (n)\n"
"dupp : input rank-1 array('d') with bounds (n)\n"
"rhs : input rank-1 array('d') with bounds (n)\n"
"\nOther Parameters\n----------------\n"
"n : input int, optional\n    Default: len(dlow)\n"
"\nReturns\n-------\n"
"sol : rank-1 array('d') with bounds (n)";
/* extern void F_FUNC(tdma,TDMA)(double*,double*,double*,double*,int*,double*); */
static PyObject *f2py_rout__aurora_tdma(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*,double*,int*,double*)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  double *dlow = NULL;
  npy_intp dlow_Dims[1] = {-1};
  const int dlow_Rank = 1;
  PyArrayObject *capi_dlow_tmp = NULL;
  int capi_dlow_intent = 0;
  PyObject *dlow_capi = Py_None;
  double *dmain = NULL;
  npy_intp dmain_Dims[1] = {-1};
  const int dmain_Rank = 1;
  PyArrayObject *capi_dmain_tmp = NULL;
  int capi_dmain_intent = 0;
  PyObject *dmain_capi = Py_None;
  double *dupp = NULL;
  npy_intp dupp_Dims[1] = {-1};
  const int dupp_Rank = 1;
  PyArrayObject *capi_dupp_tmp = NULL;
  int capi_dupp_intent = 0;
  PyObject *dupp_capi = Py_None;
  double *rhs = NULL;
  npy_intp rhs_Dims[1] = {-1};
  const int rhs_Rank = 1;
  PyArrayObject *capi_rhs_tmp = NULL;
  int capi_rhs_intent = 0;
  PyObject *rhs_capi = Py_None;
  int n = 0;
  PyObject *n_capi = Py_None;
  double *sol = NULL;
  npy_intp sol_Dims[1] = {-1};
  const int sol_Rank = 1;
  PyArrayObject *capi_sol_tmp = NULL;
  int capi_sol_intent = 0;
  static char *capi_kwlist[] = {"dlow","dmain","dupp","rhs","n",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OOOO|O:_aurora.tdma",\
    capi_kwlist,&dlow_capi,&dmain_capi,&dupp_capi,&rhs_capi,&n_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable dlow */
  ;
  capi_dlow_intent |= F2PY_INTENT_IN;
  capi_dlow_tmp = array_from_pyobj(NPY_DOUBLE,dlow_Dims,dlow_Rank,capi_dlow_intent,dlow_capi);
  if (capi_dlow_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 1st argument `dlow' of _aurora.tdma to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    dlow = (double *)(PyArray_DATA(capi_dlow_tmp));

  /* Processing variable n */
  if (n_capi == Py_None) n = len(dlow); else
    f2py_success = int_from_pyobj(&n,n_capi,"_aurora.tdma() 1st keyword (n) can't be converted to int");
  if (f2py_success) {
  CHECKSCALAR(len(dlow)>=n,"len(dlow)>=n","1st keyword n","tdma:n=%d",n) {
  /* Processing variable sol */
  sol_Dims[0]=n;
  capi_sol_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_sol_tmp = array_from_pyobj(NPY_DOUBLE,sol_Dims,sol_Rank,capi_sol_intent,Py_None);
  if (capi_sol_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting hidden `sol' of _aurora.tdma to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    sol = (double *)(PyArray_DATA(capi_sol_tmp));

  /* Processing variable dmain */
  dmain_Dims[0]=n;
  capi_dmain_intent |= F2PY_INTENT_IN;
  capi_dmain_tmp = array_from_pyobj(NPY_DOUBLE,dmain_Dims,dmain_Rank,capi_dmain_intent,dmain_capi);
  if (capi_dmain_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 2nd argument `dmain' of _aurora.tdma to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    dmain = (double *)(PyArray_DATA(capi_dmain_tmp));

  /* Processing variable dupp */
  dupp_Dims[0]=n;
  capi_dupp_intent |= F2PY_INTENT_IN;
  capi_dupp_tmp = array_from_pyobj(NPY_DOUBLE,dupp_Dims,dupp_Rank,capi_dupp_intent,dupp_capi);
  if (capi_dupp_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 3rd argument `dupp' of _aurora.tdma to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    dupp = (double *)(PyArray_DATA(capi_dupp_tmp));

  /* Processing variable rhs */
  rhs_Dims[0]=n;
  capi_rhs_intent |= F2PY_INTENT_IN;
  capi_rhs_tmp = array_from_pyobj(NPY_DOUBLE,rhs_Dims,rhs_Rank,capi_rhs_intent,rhs_capi);
  if (capi_rhs_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 4th argument `rhs' of _aurora.tdma to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    rhs = (double *)(PyArray_DATA(capi_rhs_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(dlow,dmain,dupp,rhs,&n,sol);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("N",capi_sol_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  if((PyObject *)capi_rhs_tmp!=rhs_capi) {
    Py_XDECREF(capi_rhs_tmp); }
  }  /*if (capi_rhs_tmp == NULL) ... else of rhs*/
  /* End of cleaning variable rhs */
  if((PyObject *)capi_dupp_tmp!=dupp_capi) {
    Py_XDECREF(capi_dupp_tmp); }
  }  /*if (capi_dupp_tmp == NULL) ... else of dupp*/
  /* End of cleaning variable dupp */
  if((PyObject *)capi_dmain_tmp!=dmain_capi) {
    Py_XDECREF(capi_dmain_tmp); }
  }  /*if (capi_dmain_tmp == NULL) ... else of dmain*/
  /* End of cleaning variable dmain */
  }  /*if (capi_sol_tmp == NULL) ... else of sol*/
  /* End of cleaning variable sol */
  } /*CHECKSCALAR(len(dlow)>=n)*/
  } /*if (f2py_success) of n*/
  /* End of cleaning variable n */
  if((PyObject *)capi_dlow_tmp!=dlow_capi) {
    Py_XDECREF(capi_dlow_tmp); }
  }  /*if (capi_dlow_tmp == NULL) ... else of dlow*/
  /* End of cleaning variable dlow */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/******************************** end of tdma ********************************/

/********************************* linip_arr *********************************/
static char doc_f2py_rout__aurora_linip_arr[] = "\
y = linip_arr(ts,ys,t,[m,n])\n\nWrapper for ``linip_arr``.\
\n\nParameters\n----------\n"
"ts : input rank-1 array('d') with bounds (m)\n"
"ys : input rank-2 array('d') with bounds (n,m)\n"
"t : input float\n"
"\nOther Parameters\n----------------\n"
"m : input int, optional\n    Default: len(ts)\n"
"n : input int, optional\n    Default: shape(ys,0)\n"
"\nReturns\n-------\n"
"y : rank-1 array('d') with bounds (n)";
/* extern void F_FUNC_US(linip_arr,LINIP_ARR)(int*,int*,double*,double*,double*,double*); */
static PyObject *f2py_rout__aurora_linip_arr(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,int*,double*,double*,double*,double*)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  int m = 0;
  PyObject *m_capi = Py_None;
  int n = 0;
  PyObject *n_capi = Py_None;
  double *ts = NULL;
  npy_intp ts_Dims[1] = {-1};
  const int ts_Rank = 1;
  PyArrayObject *capi_ts_tmp = NULL;
  int capi_ts_intent = 0;
  PyObject *ts_capi = Py_None;
  double *ys = NULL;
  npy_intp ys_Dims[2] = {-1, -1};
  const int ys_Rank = 2;
  PyArrayObject *capi_ys_tmp = NULL;
  int capi_ys_intent = 0;
  PyObject *ys_capi = Py_None;
  double t = 0;
  PyObject *t_capi = Py_None;
  double *y = NULL;
  npy_intp y_Dims[1] = {-1};
  const int y_Rank = 1;
  PyArrayObject *capi_y_tmp = NULL;
  int capi_y_intent = 0;
  static char *capi_kwlist[] = {"ts","ys","t","m","n",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OOO|OO:_aurora.linip_arr",\
    capi_kwlist,&ts_capi,&ys_capi,&t_capi,&m_capi,&n_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable ts */
  ;
  capi_ts_intent |= F2PY_INTENT_IN;
  capi_ts_tmp = array_from_pyobj(NPY_DOUBLE,ts_Dims,ts_Rank,capi_ts_intent,ts_capi);
  if (capi_ts_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 1st argument `ts' of _aurora.linip_arr to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    ts = (double *)(PyArray_DATA(capi_ts_tmp));

  /* Processing variable t */
    f2py_success = double_from_pyobj(&t,t_capi,"_aurora.linip_arr() 3rd argument (t) can't be converted to double");
  if (f2py_success) {
  /* Processing variable m */
  if (m_capi == Py_None) m = len(ts); else
    f2py_success = int_from_pyobj(&m,m_capi,"_aurora.linip_arr() 1st keyword (m) can't be converted to int");
  if (f2py_success) {
  CHECKSCALAR(len(ts)>=m,"len(ts)>=m","1st keyword m","linip_arr:m=%d",m) {
  /* Processing variable ys */
  ys_Dims[1]=m;
  capi_ys_intent |= F2PY_INTENT_IN;
  capi_ys_tmp = array_from_pyobj(NPY_DOUBLE,ys_Dims,ys_Rank,capi_ys_intent,ys_capi);
  if (capi_ys_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 2nd argument `ys' of _aurora.linip_arr to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    ys = (double *)(PyArray_DATA(capi_ys_tmp));

  /* Processing variable n */
  if (n_capi == Py_None) n = shape(ys,0); else
    f2py_success = int_from_pyobj(&n,n_capi,"_aurora.linip_arr() 2nd keyword (n) can't be converted to int");
  if (f2py_success) {
  CHECKSCALAR(shape(ys,0)==n,"shape(ys,0)==n","2nd keyword n","linip_arr:n=%d",n) {
  /* Processing variable y */
  y_Dims[0]=n;
  capi_y_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_y_tmp = array_from_pyobj(NPY_DOUBLE,y_Dims,y_Rank,capi_y_intent,Py_None);
  if (capi_y_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting hidden `y' of _aurora.linip_arr to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    y = (double *)(PyArray_DATA(capi_y_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(&m,&n,ts,ys,&t,y);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("N",capi_y_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  }  /*if (capi_y_tmp == NULL) ... else of y*/
  /* End of cleaning variable y */
  } /*CHECKSCALAR(shape(ys,0)==n)*/
  } /*if (f2py_success) of n*/
  /* End of cleaning variable n */
  if((PyObject *)capi_ys_tmp!=ys_capi) {
    Py_XDECREF(capi_ys_tmp); }
  }  /*if (capi_ys_tmp == NULL) ... else of ys*/
  /* End of cleaning variable ys */
  } /*CHECKSCALAR(len(ts)>=m)*/
  } /*if (f2py_success) of m*/
  /* End of cleaning variable m */
  } /*if (f2py_success) of t*/
  /* End of cleaning variable t */
  if((PyObject *)capi_ts_tmp!=ts_capi) {
    Py_XDECREF(capi_ts_tmp); }
  }  /*if (capi_ts_tmp == NULL) ... else of ts*/
  /* End of cleaning variable ts */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/****************************** end of linip_arr ******************************/

/********************************** asc_sort **********************************/
static char doc_f2py_rout__aurora_asc_sort[] = "\
index_bn = asc_sort(a,[n])\n\nWrapper for ``asc_sort``.\
\n\nParameters\n----------\n"
"a : in/output rank-1 array('d') with bounds (n)\n"
"\nOther Parameters\n----------------\n"
"n : input int, optional\n    Default: len(a)\n"
"\nReturns\n-------\n"
"index_bn : rank-1 array('i') with bounds (n)";
/* extern void F_FUNC_US(asc_sort,ASC_SORT)(int*,double*,int*); */
static PyObject *f2py_rout__aurora_asc_sort(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,double*,int*)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  int n = 0;
  PyObject *n_capi = Py_None;
  double *a = NULL;
  npy_intp a_Dims[1] = {-1};
  const int a_Rank = 1;
  PyArrayObject *capi_a_tmp = NULL;
  int capi_a_intent = 0;
  PyObject *a_capi = Py_None;
  int *index_bn = NULL;
  npy_intp index_bn_Dims[1] = {-1};
  const int index_bn_Rank = 1;
  PyArrayObject *capi_index_bn_tmp = NULL;
  int capi_index_bn_intent = 0;
  static char *capi_kwlist[] = {"a","n",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "O|O:_aurora.asc_sort",\
    capi_kwlist,&a_capi,&n_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable a */
  ;
  capi_a_intent |= F2PY_INTENT_INOUT;
  capi_a_tmp = array_from_pyobj(NPY_DOUBLE,a_Dims,a_Rank,capi_a_intent,a_capi);
  if (capi_a_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 1st argument `a' of _aurora.asc_sort to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    a = (double *)(PyArray_DATA(capi_a_tmp));

  /* Processing variable n */
  if (n_capi == Py_None) n = len(a); else
    f2py_success = int_from_pyobj(&n,n_capi,"_aurora.asc_sort() 1st keyword (n) can't be converted to int");
  if (f2py_success) {
  CHECKSCALAR(len(a)>=n,"len(a)>=n","1st keyword n","asc_sort:n=%d",n) {
  /* Processing variable index_bn */
  index_bn_Dims[0]=n;
  capi_index_bn_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_index_bn_tmp = array_from_pyobj(NPY_INT,index_bn_Dims,index_bn_Rank,capi_index_bn_intent,Py_None);
  if (capi_index_bn_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting hidden `index_bn' of _aurora.asc_sort to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    index_bn = (int *)(PyArray_DATA(capi_index_bn_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(&n,a,index_bn);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("N",capi_index_bn_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  }  /*if (capi_index_bn_tmp == NULL) ... else of index_bn*/
  /* End of cleaning variable index_bn */
  } /*CHECKSCALAR(len(a)>=n)*/
  } /*if (f2py_success) of n*/
  /* End of cleaning variable n */
  if((PyObject *)capi_a_tmp!=a_capi) {
    Py_XDECREF(capi_a_tmp); }
  }  /*if (capi_a_tmp == NULL) ... else of a*/
  /* End of cleaning variable a */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/****************************** end of asc_sort ******************************/

/********************************* chg_ord_r *********************************/
static char doc_f2py_rout__aurora_chg_ord_r[] = "\
wksp = chg_ord_r(a,index_bn,[n])\n\nWrapper for ``chg_ord_r``.\
\n\nParameters\n----------\n"
"a : in/output rank-1 array('d') with bounds (n)\n"
"index_bn : input rank-1 array('i') with bounds (n)\n"
"\nOther Parameters\n----------------\n"
"n : input int, optional\n    Default: len(a)\n"
"\nReturns\n-------\n"
"wksp : rank-1 array('d') with bounds (n)";
/* extern void F_FUNC_US(chg_ord_r,CHG_ORD_R)(int*,double*,int*,double*); */
static PyObject *f2py_rout__aurora_chg_ord_r(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,double*,int*,double*)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  int n = 0;
  PyObject *n_capi = Py_None;
  double *a = NULL;
  npy_intp a_Dims[1] = {-1};
  const int a_Rank = 1;
  PyArrayObject *capi_a_tmp = NULL;
  int capi_a_intent = 0;
  PyObject *a_capi = Py_None;
  int *index_bn = NULL;
  npy_intp index_bn_Dims[1] = {-1};
  const int index_bn_Rank = 1;
  PyArrayObject *capi_index_bn_tmp = NULL;
  int capi_index_bn_intent = 0;
  PyObject *index_bn_capi = Py_None;
  double *wksp = NULL;
  npy_intp wksp_Dims[1] = {-1};
  const int wksp_Rank = 1;
  PyArrayObject *capi_wksp_tmp = NULL;
  int capi_wksp_intent = 0;
  static char *capi_kwlist[] = {"a","index_bn","n",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OO|O:_aurora.chg_ord_r",\
    capi_kwlist,&a_capi,&index_bn_capi,&n_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable a */
  ;
  capi_a_intent |= F2PY_INTENT_INOUT;
  capi_a_tmp = array_from_pyobj(NPY_DOUBLE,a_Dims,a_Rank,capi_a_intent,a_capi);
  if (capi_a_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 1st argument `a' of _aurora.chg_ord_r to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    a = (double *)(PyArray_DATA(capi_a_tmp));

  /* Processing variable n */
  if (n_capi == Py_None) n = len(a); else
    f2py_success = int_from_pyobj(&n,n_capi,"_aurora.chg_ord_r() 1st keyword (n) can't be converted to int");
  if (f2py_success) {
  CHECKSCALAR(len(a)>=n,"len(a)>=n","1st keyword n","chg_ord_r:n=%d",n) {
  /* Processing variable index_bn */
  index_bn_Dims[0]=n;
  capi_index_bn_intent |= F2PY_INTENT_IN;
  capi_index_bn_tmp = array_from_pyobj(NPY_INT,index_bn_Dims,index_bn_Rank,capi_index_bn_intent,index_bn_capi);
  if (capi_index_bn_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 2nd argument `index_bn' of _aurora.chg_ord_r to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    index_bn = (int *)(PyArray_DATA(capi_index_bn_tmp));

  /* Processing variable wksp */
  wksp_Dims[0]=n;
  capi_wksp_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_wksp_tmp = array_from_pyobj(NPY_DOUBLE,wksp_Dims,wksp_Rank,capi_wksp_intent,Py_None);
  if (capi_wksp_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting hidden `wksp' of _aurora.chg_ord_r to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    wksp = (double *)(PyArray_DATA(capi_wksp_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(&n,a,index_bn,wksp);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("N",capi_wksp_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  }  /*if (capi_wksp_tmp == NULL) ... else of wksp*/
  /* End of cleaning variable wksp */
  if((PyObject *)capi_index_bn_tmp!=index_bn_capi) {
    Py_XDECREF(capi_index_bn_tmp); }
  }  /*if (capi_index_bn_tmp == NULL) ... else of index_bn*/
  /* End of cleaning variable index_bn */
  } /*CHECKSCALAR(len(a)>=n)*/
  } /*if (f2py_success) of n*/
  /* End of cleaning variable n */
  if((PyObject *)capi_a_tmp!=a_capi) {
    Py_XDECREF(capi_a_tmp); }
  }  /*if (capi_a_tmp == NULL) ... else of a*/
  /* End of cleaning variable a */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/****************************** end of chg_ord_r ******************************/

/********************************* chg_ord_i *********************************/
static char doc_f2py_rout__aurora_chg_ord_i[] = "\
wksp = chg_ord_i(a,index_bn,[n])\n\nWrapper for ``chg_ord_i``.\
\n\nParameters\n----------\n"
"a : in/output rank-1 array('i') with bounds (n)\n"
"index_bn : input rank-1 array('i') with bounds (n)\n"
"\nOther Parameters\n----------------\n"
"n : input int, optional\n    Default: len(a)\n"
"\nReturns\n-------\n"
"wksp : rank-1 array('i') with bounds (n)";
/* extern void F_FUNC_US(chg_ord_i,CHG_ORD_I)(int*,int*,int*,int*); */
static PyObject *f2py_rout__aurora_chg_ord_i(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,int*,int*,int*)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  int n = 0;
  PyObject *n_capi = Py_None;
  int *a = NULL;
  npy_intp a_Dims[1] = {-1};
  const int a_Rank = 1;
  PyArrayObject *capi_a_tmp = NULL;
  int capi_a_intent = 0;
  PyObject *a_capi = Py_None;
  int *index_bn = NULL;
  npy_intp index_bn_Dims[1] = {-1};
  const int index_bn_Rank = 1;
  PyArrayObject *capi_index_bn_tmp = NULL;
  int capi_index_bn_intent = 0;
  PyObject *index_bn_capi = Py_None;
  int *wksp = NULL;
  npy_intp wksp_Dims[1] = {-1};
  const int wksp_Rank = 1;
  PyArrayObject *capi_wksp_tmp = NULL;
  int capi_wksp_intent = 0;
  static char *capi_kwlist[] = {"a","index_bn","n",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OO|O:_aurora.chg_ord_i",\
    capi_kwlist,&a_capi,&index_bn_capi,&n_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable a */
  ;
  capi_a_intent |= F2PY_INTENT_INOUT;
  capi_a_tmp = array_from_pyobj(NPY_INT,a_Dims,a_Rank,capi_a_intent,a_capi);
  if (capi_a_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 1st argument `a' of _aurora.chg_ord_i to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    a = (int *)(PyArray_DATA(capi_a_tmp));

  /* Processing variable n */
  if (n_capi == Py_None) n = len(a); else
    f2py_success = int_from_pyobj(&n,n_capi,"_aurora.chg_ord_i() 1st keyword (n) can't be converted to int");
  if (f2py_success) {
  CHECKSCALAR(len(a)>=n,"len(a)>=n","1st keyword n","chg_ord_i:n=%d",n) {
  /* Processing variable index_bn */
  index_bn_Dims[0]=n;
  capi_index_bn_intent |= F2PY_INTENT_IN;
  capi_index_bn_tmp = array_from_pyobj(NPY_INT,index_bn_Dims,index_bn_Rank,capi_index_bn_intent,index_bn_capi);
  if (capi_index_bn_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting 2nd argument `index_bn' of _aurora.chg_ord_i to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    index_bn = (int *)(PyArray_DATA(capi_index_bn_tmp));

  /* Processing variable wksp */
  wksp_Dims[0]=n;
  capi_wksp_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_wksp_tmp = array_from_pyobj(NPY_INT,wksp_Dims,wksp_Rank,capi_wksp_intent,Py_None);
  if (capi_wksp_tmp == NULL) {
    PyObject *exc, *val, *tb;
    PyErr_Fetch(&exc, &val, &tb);
    PyErr_SetString(exc ? exc : _aurora_error,"failed in converting hidden `wksp' of _aurora.chg_ord_i to C/Fortran array" );
    npy_PyErr_ChainExceptionsCause(exc, val, tb);
  } else {
    wksp = (int *)(PyArray_DATA(capi_wksp_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(&n,a,index_bn,wksp);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("N",capi_wksp_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  }  /*if (capi_wksp_tmp == NULL) ... else of wksp*/
  /* End of cleaning variable wksp */
  if((PyObject *)capi_index_bn_tmp!=index_bn_capi) {
    Py_XDECREF(capi_index_bn_tmp); }
  }  /*if (capi_index_bn_tmp == NULL) ... else of index_bn*/
  /* End of cleaning variable index_bn */
  } /*CHECKSCALAR(len(a)>=n)*/
  } /*if (f2py_success) of n*/
  /* End of cleaning variable n */
  if((PyObject *)capi_a_tmp!=a_capi) {
    Py_XDECREF(capi_a_tmp); }
  }  /*if (capi_a_tmp == NULL) ... else of a*/
  /* End of cleaning variable a */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/****************************** end of chg_ord_i ******************************/
/*eof body*/

/******************* See f2py2e/f90mod_rules.py: buildhooks *******************/
/*need_f90modhooks*/

/************** See f2py2e/rules.py: module_rules['modulebody'] **************/

/******************* See f2py2e/common_rules.py: buildhooks *******************/

/*need_commonhooks*/

/**************************** See f2py2e/rules.py ****************************/

static FortranDataDef f2py_routine_defs[] = {
  {"run",-1,{{-1}},0,(char *)F_FUNC(run,RUN),(f2py_init_func)f2py_rout__aurora_run,doc_f2py_rout__aurora_run},
  {"saw_mix",-1,{{-1}},0,(char *)F_FUNC_US(saw_mix,SAW_MIX),(f2py_init_func)f2py_rout__aurora_saw_mix,doc_f2py_rout__aurora_saw_mix},
  {"edge_model",-1,{{-1}},0,(char *)F_FUNC_US(edge_model,EDGE_MODEL),(f2py_init_func)f2py_rout__aurora_edge_model,doc_f2py_rout__aurora_edge_model},
  {"get_radial_grid",-1,{{-1}},0,(char *)F_FUNC_US(get_radial_grid,GET_RADIAL_GRID),(f2py_init_func)f2py_rout__aurora_get_radial_grid,doc_f2py_rout__aurora_get_radial_grid},
  {"time_steps",-1,{{-1}},0,(char *)F_FUNC_US(time_steps,TIME_STEPS),(f2py_init_func)f2py_rout__aurora_time_steps,doc_f2py_rout__aurora_time_steps},
  {"impden0",-1,{{-1}},0,(char *)F_FUNC(impden0,IMPDEN0),(f2py_init_func)f2py_rout__aurora_impden0,doc_f2py_rout__aurora_impden0},
  {"impden1",-1,{{-1}},0,(char *)F_FUNC(impden1,IMPDEN1),(f2py_init_func)f2py_rout__aurora_impden1,doc_f2py_rout__aurora_impden1},
  {"impden_consttranspmatrix",-1,{{-1}},0,(char *)F_FUNC_US(impden_consttranspmatrix,IMPDEN_CONSTTRANSPMATRIX),(f2py_init_func)f2py_rout__aurora_impden_consttranspmatrix,doc_f2py_rout__aurora_impden_consttranspmatrix},
  {"tdma",-1,{{-1}},0,(char *)F_FUNC(tdma,TDMA),(f2py_init_func)f2py_rout__aurora_tdma,doc_f2py_rout__aurora_tdma},
  {"linip_arr",-1,{{-1}},0,(char *)F_FUNC_US(linip_arr,LINIP_ARR),(f2py_init_func)f2py_rout__aurora_linip_arr,doc_f2py_rout__aurora_linip_arr},
  {"asc_sort",-1,{{-1}},0,(char *)F_FUNC_US(asc_sort,ASC_SORT),(f2py_init_func)f2py_rout__aurora_asc_sort,doc_f2py_rout__aurora_asc_sort},
  {"chg_ord_r",-1,{{-1}},0,(char *)F_FUNC_US(chg_ord_r,CHG_ORD_R),(f2py_init_func)f2py_rout__aurora_chg_ord_r,doc_f2py_rout__aurora_chg_ord_r},
  {"chg_ord_i",-1,{{-1}},0,(char *)F_FUNC_US(chg_ord_i,CHG_ORD_I),(f2py_init_func)f2py_rout__aurora_chg_ord_i,doc_f2py_rout__aurora_chg_ord_i},

/*eof routine_defs*/
  {NULL}
};

static PyMethodDef f2py_module_methods[] = {

  {NULL,NULL}
};

static struct PyModuleDef moduledef = {
  PyModuleDef_HEAD_INIT,
  "_aurora",
  NULL,
  -1,
  f2py_module_methods,
  NULL,
  NULL,
  NULL,
  NULL
};

PyMODINIT_FUNC PyInit__aurora(void) {
  int i;
  PyObject *m,*d, *s, *tmp;
  m = _aurora_module = PyModule_Create(&moduledef);
  Py_SET_TYPE(&PyFortran_Type, &PyType_Type);
  import_array();
  if (PyErr_Occurred())
    {PyErr_SetString(PyExc_ImportError, "can't initialize module _aurora (failed to import numpy)"); return m;}
  d = PyModule_GetDict(m);
  s = PyString_FromString("$Revision: $");
  PyDict_SetItemString(d, "__version__", s);
  Py_DECREF(s);
  s = PyUnicode_FromString(
    "This module '_aurora' is auto-generated with f2py (version:2).\nFunctions:\n"
"  rn_out,n_wall,n_div,n_pump,n_ret,n_tsu,n_dsu,n_dsul,rcld_rate,rclw_rate = run(nt_out,t_trans,d,v,par_loss_rates,src_rad_prof,s_rates,r_rates,rr,pro,qpr,r_saw,dlen,time,saw,flx,it_out,dsaw,rcl,divbls,taudiv,taupump,tauwret,rvol_lcfs,dbound,dlim,prox,nion=shape(d,2),ir=shape(d,0),nt=shape(par_loss_rates,1),nt_trans=len(t_trans),rn_t0=,alg_opt=,evolneut=)\n"
"  saw_mix(rn,rsaw,dsaw,rr,pro,nion=shape(rn,1),ir=shape(rn,0))\n"
"  divnew,tsu,dsu,dsul = edge_model(ra,rn,diff,conv,par_loss_rate,det,rvol_lcfs,dbound,dlim,prox,rr,pro,rcl,taudiv,taupump,divbls,divold,flx,tve,npump,nion=shape(ra,1),ir=shape(ra,0))\n"
"  rr,pro,prox,qpr = get_radial_grid(ir,dbound,k,dr_0,dr_1,rvol_lcfs)\n"
"  t_vals,i_save = time_steps(t,dtstart,itz,tinc,n=len(t),verbose=)\n"
"  rn,rcld,rclw = impden0(ra,diff,conv,par_loss_rate,src_prof,s_rates,r_rates,rr,pro,qpr,flx,dlen,det,rcl,tsuold,dsulold,divold,divbls,taudiv,tauwret,a,b,c,d1,bet,gam,nret,nion=shape(ra,1),ir=shape(ra,0))\n"
"  rn,rcld,rclw = impden1(ra,diff,conv,par_loss_rate,src_prof,s_rates,r_rates,rr,flx,fall_outsol,det,rcl,tsuold,dsulold,divold,divbls,taudiv,tauwret,evolveneut,nret,nion=shape(ra,1),ir=shape(ra,0))\n"
"  a,b,c,d = impden_consttranspmatrix(rnt,dimp,vimp,dt,fall_outsol,par_loss_rate,rr,ir=len(rnt))\n"
"  sol = tdma(dlow,dmain,dupp,rhs,n=len(dlow))\n"
"  y = linip_arr(ts,ys,t,m=len(ts),n=shape(ys,0))\n"
"  index_bn = asc_sort(a,n=len(a))\n"
"  wksp = chg_ord_r(a,index_bn,n=len(a))\n"
"  wksp = chg_ord_i(a,index_bn,n=len(a))\n"
".");
  PyDict_SetItemString(d, "__doc__", s);
  Py_DECREF(s);
  _aurora_error = PyErr_NewException ("_aurora.error", NULL, NULL);
  /*
   * Store the error object inside the dict, so that it could get deallocated.
   * (in practice, this is a module, so it likely will not and cannot.)
   */
  PyDict_SetItemString(d, "__aurora_error", _aurora_error);
  Py_DECREF(_aurora_error);
  for(i=0;f2py_routine_defs[i].name!=NULL;i++) {
    tmp = PyFortranObject_NewAsAttr(&f2py_routine_defs[i]);
    PyDict_SetItemString(d, f2py_routine_defs[i].name, tmp);
    Py_DECREF(tmp);
  }













/*eof initf2pywraphooks*/
/*eof initf90modhooks*/

/*eof initcommonhooks*/


#ifdef F2PY_REPORT_ATEXIT
  if (! PyErr_Occurred())
    on_exit(f2py_report_on_exit,(void*)"_aurora");
#endif
  return m;
}
#ifdef __cplusplus
}
#endif
