
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>aurora.atomic &#8212; aurora 1.0.0 documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for aurora.atomic</h1><div class="highlight"><pre>
<span></span><span class="c1">#-*-Python-*-</span>
<span class="c1"># Created by sciortinof at 05 Feb 2020  14:59</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">RectBivariateSpline</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">scipy.ndimage</span>
<span class="kn">from</span> <span class="nn">scipy.linalg</span> <span class="kn">import</span> <span class="n">svd</span>
<span class="kn">from</span> <span class="nn">IPython</span> <span class="kn">import</span> <span class="n">embed</span>

<div class="viewcode-block" id="get_file_types"><a class="viewcode-back" href="../../aurora.html#aurora.atomic.get_file_types">[docs]</a><span class="k">def</span> <span class="nf">get_file_types</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;Returns main types of ADAS atomic data of interest &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;acd&#39;</span><span class="p">:</span><span class="s1">&#39;recombination&#39;</span><span class="p">,</span>
            <span class="s1">&#39;scd&#39;</span><span class="p">:</span><span class="s1">&#39;ionization&#39;</span><span class="p">,</span>
            <span class="s1">&#39;prb&#39;</span><span class="p">:</span><span class="s1">&#39;continuum radiation&#39;</span><span class="p">,</span>
            <span class="s1">&#39;plt&#39;</span><span class="p">:</span><span class="s1">&#39;line radiation&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ccd&#39;</span><span class="p">:</span><span class="s1">&#39;thermal charge exchange&#39;</span><span class="p">,</span>
            <span class="s1">&#39;prc&#39;</span><span class="p">:</span><span class="s1">&#39;thermal charge exchange continuum radiation&#39;</span><span class="p">,</span>
            <span class="s1">&#39;pls&#39;</span><span class="p">:</span><span class="s1">&#39;line radiation in sxr range&#39;</span><span class="p">,</span>
            <span class="s1">&#39;prs&#39;</span><span class="p">:</span><span class="s1">&#39;continuum radiation in sxr range&#39;</span><span class="p">,</span>
            <span class="s1">&#39;brs&#39;</span><span class="p">:</span><span class="s1">&#39;continuum spectral bremstrahlung&#39;</span><span class="p">,</span>
            <span class="s1">&#39;fis&#39;</span><span class="p">:</span><span class="s1">&#39;sensitivity of sxr&#39;</span><span class="p">}</span></div>


<div class="viewcode-block" id="get_atomdat_info"><a class="viewcode-back" href="../../aurora.html#aurora.atomic.get_atomdat_info">[docs]</a><span class="k">def</span> <span class="nf">get_atomdat_info</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;Function to identify location of ADAS atomic data in a generalized fashion</span>
<span class="sd">    and to obtain the list of file_types of interest.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="s1">&#39;STRAHL_DIR&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">:</span>
        <span class="c1"># STRAHL_DIR env variable can in principle be used by user to point to a personal installation</span>
        <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;STRAHL_DIR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;HOME&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;/strahl&#39;</span>

    <span class="c1"># Define hierarchy of directories that should be searched in order</span>
    <span class="n">paths</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;HOME&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;/atomlib/atomdat_master/newdat/&#39;</span><span class="p">,</span>
             <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;HOME&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;/atomAI/atomdat_master/newdat/&#39;</span><span class="p">,</span>
             <span class="s1">&#39;/fusion/projects/codes/strahl/</span><span class="si">{}</span><span class="s1">/intel-18/strahl20/atomdat/newdat/&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;USER&#39;</span><span class="p">]),</span>
             <span class="s1">&#39;/fusion/projects/codes/strahl/</span><span class="si">{}</span><span class="s1">/strahl/atomdat/newdat/&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;USER&#39;</span><span class="p">]),</span>
             <span class="s1">&#39;/fusion/projects/codes/strahl/public20/atomdat/newdat/&#39;</span><span class="p">,</span>
             <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;STRAHL_DIR&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;/atomdat/newdat/&#39;</span><span class="p">,</span>
             <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;HOME&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;/strahl/atomdat/newdat/&#39;</span><span class="p">,</span>
             <span class="s1">&#39;&#39;</span><span class="p">]</span>
    
    <span class="k">for</span> <span class="n">atomdat_dir</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">atomdat_dir</span><span class="p">):</span>
            <span class="k">break</span>

    <span class="k">return</span> <span class="n">atomdat_dir</span></div>



<div class="viewcode-block" id="adas_file"><a class="viewcode-back" href="../../aurora.html#aurora.atomic.adas_file">[docs]</a><span class="k">class</span> <span class="nc">adas_file</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;Read ADAS file in ADF11 format over the given ne, T. &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">filepath</span> <span class="o">=</span> <span class="n">filepath</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="o">=</span><span class="n">filepath</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;brs&#39;</span><span class="p">,</span><span class="s1">&#39;sxr&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">imp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># get data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>

        <span class="c1"># settings for plotting</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_ion</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ncol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_ion</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nrow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_ion</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">ncol</span><span class="p">)</span>


<div class="viewcode-block" id="adas_file.load"><a class="viewcode-back" href="../../aurora.html#aurora.atomic.adas_file.load">[docs]</a>    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">header</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="n">n_ions</span><span class="p">,</span> <span class="n">n_ne</span><span class="p">,</span> <span class="n">n_T</span> <span class="o">=</span> <span class="n">header</span><span class="o">.</span><span class="n">split</span><span class="p">()[:</span><span class="mi">3</span><span class="p">]</span>
            <span class="n">details</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">header</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">3</span><span class="p">:])</span>

            <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>

            <span class="n">n_ions</span><span class="p">,</span><span class="n">n_ne</span><span class="p">,</span><span class="n">n_T</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n_ions</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">n_ne</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">n_T</span><span class="p">)</span>
            <span class="n">logT</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">logNe</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">logNe</span><span class="p">)</span><span class="o">&lt;</span> <span class="n">n_ne</span><span class="p">:</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                <span class="n">logNe</span> <span class="o">=</span> <span class="n">logNe</span><span class="o">+</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()]</span>
            <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">logT</span><span class="p">)</span><span class="o">&lt;</span> <span class="n">n_T</span><span class="p">:</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                <span class="n">logT</span> <span class="o">=</span> <span class="n">logT</span><span class="o">+</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()]</span>

            <span class="n">logT</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">logT</span><span class="p">)</span>
            <span class="n">logNe</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">logNe</span><span class="p">)</span>

            <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i_ion</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_ions</span><span class="p">):</span>
                <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                <span class="n">plsx</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">plsx</span><span class="p">)</span><span class="o">&lt;</span> <span class="n">n_ne</span><span class="o">*</span><span class="n">n_T</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                    <span class="n">plsx</span> <span class="o">=</span> <span class="n">plsx</span><span class="o">+</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">L</span><span class="p">)</span> <span class="k">for</span> <span class="n">L</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()]</span>
                <span class="n">plsx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">plsx</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_T</span><span class="p">,</span> <span class="n">n_ne</span><span class="p">)</span>
                <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">plsx</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logNe</span> <span class="o">=</span> <span class="n">logNe</span><span class="p">;</span> <span class="bp">self</span><span class="o">.</span><span class="n">logT</span> <span class="o">=</span> <span class="n">logT</span><span class="p">;</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></div>


<div class="viewcode-block" id="adas_file.plot"><a class="viewcode-back" href="../../aurora.html#aurora.atomic.adas_file.plot">[docs]</a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">axes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span><span class="p">,</span><span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ncol</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nrow</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">axes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span>
        <span class="n">colormap</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">rainbow</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="o">+</span><span class="s1">&#39;  &#39;</span><span class="o">+</span> <span class="n">get_file_types</span><span class="p">()[</span><span class="bp">self</span><span class="o">.</span><span class="n">file_type</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_ion</span><span class="p">:</span> <span class="k">break</span>
            <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">,:,:]</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">):</span> <span class="c1">#independent of density</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">,:,</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_prop_cycle</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="n">colormap</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">])))</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_type</span> <span class="o">!=</span> <span class="s1">&#39;brs&#39;</span><span class="p">:</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;scd&#39;</span><span class="p">,</span><span class="s1">&#39;prs&#39;</span><span class="p">,</span><span class="s1">&#39;ccd&#39;</span><span class="p">,</span><span class="s1">&#39;prb&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="n">i</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">imp</span><span class="o">+</span><span class="s1">&#39;$^{</span><span class="si">%d</span><span class="s1">\!+}$&#39;</span><span class="o">%</span> <span class="p">(</span><span class="n">charge</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>   <span class="c1"># check?</span>

        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$\log T_e\ \mathrm{[eV]}$&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;scd&#39;</span><span class="p">,</span><span class="s1">&#39;acd&#39;</span><span class="p">,</span><span class="s1">&#39;ccd&#39;</span><span class="p">]:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$\log(&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">file_type</span><span class="o">+</span><span class="s1">&#39;)\ \mathrm{[cm^3/s]}$&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;prb&#39;</span><span class="p">,</span><span class="s1">&#39;plt&#39;</span><span class="p">,</span><span class="s1">&#39;prc&#39;</span><span class="p">,</span><span class="s1">&#39;pls&#39;</span><span class="p">,</span><span class="s1">&#39;brs&#39;</span><span class="p">,</span><span class="s1">&#39;prs&#39;</span><span class="p">]:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$\log(&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">file_type</span><span class="o">+</span><span class="s1">&#39;)\ \mathrm{[W\cdot cm^3]}$&#39;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="get_all_atom_data"><a class="viewcode-back" href="../../aurora.html#aurora.atomic.get_all_atom_data">[docs]</a><span class="k">def</span> <span class="nf">get_all_atom_data</span><span class="p">(</span><span class="n">imp</span><span class="p">,</span> <span class="n">files</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Collect atomic data for a given impurity from all types of ADAS files available.</span>

<span class="sd">    imp: str</span>
<span class="sd">        Atomic symbol of impurity ion.</span>
<span class="sd">    files : list or array-like</span>
<span class="sd">        ADAS file names to be fetched. </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">atomdat_dir</span> <span class="o">=</span> <span class="n">get_atomdat_info</span><span class="p">()</span>

    <span class="n">atom_data</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">if</span> <span class="n">files</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># fetch all file types</span>
        <span class="n">files</span> <span class="o">=</span> <span class="n">get_file_types</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

    <span class="c1"># get dictionary containing default list of ADAS atomic files</span>
    <span class="n">files_dict</span> <span class="o">=</span>  <span class="n">adas_files_dict</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
        <span class="n">file</span> <span class="o">=</span> <span class="n">files_dict</span><span class="p">[</span><span class="n">imp</span><span class="p">][</span><span class="n">key</span><span class="p">]</span>
        
        <span class="c1"># load specific file and add it to output dictionary</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">adas_file</span><span class="p">(</span><span class="n">atomdat_dir</span><span class="o">+</span><span class="n">file</span><span class="p">)</span>
        <span class="n">atom_data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">logNe</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">logT</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">data</span>

    <span class="k">return</span> <span class="n">atom_data</span></div>


<div class="viewcode-block" id="read_adf15"><a class="viewcode-back" href="../../aurora.html#aurora.atomic.read_adf15">[docs]</a><span class="k">def</span> <span class="nf">read_adf15</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Te_max</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ne_max</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">plot_log</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">plot_3d</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
               <span class="n">recomb</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
               <span class="n">pec_plot_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="n">pec_plot_max</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">plot_lines</span><span class="o">=</span><span class="p">[]):</span>
    <span class="sd">&quot;&quot;&quot;Read photon emissivity coefficients from an ADF15 file.</span>

<span class="sd">    Returns a dictionary whose keys are the wavelengths of the lines in</span>
<span class="sd">    angstroms. The value is an interp2d instance that will evaluate the PEC at</span>
<span class="sd">    a desired dens, temp.</span>

<span class="sd">    Args:</span>
<span class="sd">        path : str</span>
<span class="sd">            Path to adf15 file to read.</span>
<span class="sd">        order : int, opt</span>
<span class="sd">            Parameter to control the order of interpolation.</span>
<span class="sd">        recomb : bool, opt</span>
<span class="sd">            If True, fetch recombination contributions to available lines. If False,</span>
<span class="sd">            fetch only ionization contributions.</span>

<span class="sd">        To plot PEC data:</span>
<span class="sd">        </span>
<span class="sd">        plot_lines : list</span>
<span class="sd">            List of lines whose PEC data should be displayed. Lines should be identified</span>
<span class="sd">            by their wavelengths. The list of available wavelengths in a given file can be retrieved</span>
<span class="sd">            by first running this function ones, checking dictionary keys, and then requesting a</span>
<span class="sd">            plot of one (or more) of them.</span>
<span class="sd">        plot_log : bool</span>
<span class="sd">            When plotting, set a log scale</span>
<span class="sd">        plot_3d : bool</span>
<span class="sd">            Display PEC data as a 3D plot rather than a 2D one.</span>
<span class="sd">        pec_plot_min : float</span>
<span class="sd">            Minimum value of PEC to visualize in a plot</span>
<span class="sd">        pec_plot_max : float</span>
<span class="sd">            Maximum value of PEC to visualize in a plot</span>
<span class="sd">        ax : matplotlib axes instance</span>
<span class="sd">            If not None, plot on this set of axes</span>
<span class="sd">        Te_max : float</span>
<span class="sd">            Maximum Te value to plot when len(plot_lines)&gt;1</span>
<span class="sd">        ne_max : float</span>
<span class="sd">            Maximum ne value to plot when len(plot_lines)&gt;1</span>

<span class="sd">    Returns:</span>
<span class="sd">        pec_dict : dict</span>
<span class="sd">            Dictionary containing interpolation functions for each of the available lines of the</span>
<span class="sd">            indicated type (ionization or recombination). Each interpolation function takes as arguments</span>
<span class="sd">            the log-10 of ne and Te.</span>

<span class="sd">    MWE:</span>
<span class="sd">        path=&#39;/home/sciortino/atomlib/atomdat_master/adf15/h/pju#h0.dat&#39;</span>
<span class="sd">        pec = read_adf15(path, recomb=False)</span>
<span class="sd">        pec = read_adf15(path, plot_lines=[list(pec.keys())[0]], recomb=False)</span>

<span class="sd">    This function should work with PEC files produced via adas810 or adas218.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">plot_3d</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="n">cs</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.dat&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">header</span> <span class="o">=</span> <span class="n">lines</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="c1"># Get the expected number of lines by reading the header:</span>
    <span class="n">num_lines</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">header</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">pec_dict</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_lines</span><span class="p">):</span>
        <span class="c1"># Get the wavelength, number of densities and number of temperatures</span>
        <span class="c1"># from the first line of the entry:</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">lines</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">header</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>

        <span class="c1"># sometimes the wavelength and its units are not separated. Rough solution:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1">#header = np.concatenate( [hh.split(&#39;A&#39;)[0] for hh in header])</span>
            <span class="n">header</span> <span class="o">=</span> <span class="p">[</span><span class="n">hh</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">hh</span> <span class="ow">in</span> <span class="n">header</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="c1"># lam and A are separated. Delete &#39;A&#39; unit.</span>
            <span class="n">header</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">header</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">lam</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="c1"># These lines appear to occur when lam has more digits than the</span>
            <span class="c1"># allowed field width. For the moment, ignore these.</span>
            <span class="n">lam</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">recomb</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;recom&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">l</span><span class="o">.</span><span class="n">lower</span><span class="p">()):</span>
            <span class="n">lam</span><span class="o">=</span><span class="kc">None</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">recomb</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;excit&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">l</span><span class="o">.</span><span class="n">lower</span><span class="p">()):</span>
            <span class="n">lam</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">num_den</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">num_temp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="c1"># 2nd element was empty -- annoyingly, this happens sometimes</span>
            <span class="n">num_den</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="n">num_temp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>

        <span class="c1"># Get the densities:</span>
        <span class="n">dens</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">dens</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">num_den</span><span class="p">:</span>
            <span class="n">dens</span> <span class="o">+=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">lines</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()]</span>
        <span class="n">dens</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">dens</span><span class="p">)</span>

        <span class="c1"># Get the temperatures:</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">num_temp</span><span class="p">:</span>
            <span class="n">temp</span> <span class="o">+=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">lines</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()]</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>

        <span class="c1"># Get the PEC&#39;s:</span>
        <span class="n">PEC</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">PEC</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">num_den</span><span class="p">:</span>
            <span class="n">PEC</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
            <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">PEC</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">num_temp</span><span class="p">:</span>
                <span class="n">PEC</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">lines</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()]</span>
        <span class="n">PEC</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">PEC</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">lam</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">lam</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">pec_dict</span><span class="p">:</span>
                <span class="n">pec_dict</span><span class="p">[</span><span class="n">lam</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="n">pec_dict</span><span class="p">[</span><span class="n">lam</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">RectBivariateSpline</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">dens</span><span class="p">),</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">temp</span><span class="p">),</span>
                    <span class="n">PEC</span><span class="p">,</span>
                    <span class="n">kx</span><span class="o">=</span><span class="n">order</span><span class="p">,</span>
                    <span class="n">ky</span><span class="o">=</span><span class="n">order</span>
                <span class="p">)</span>
            <span class="p">)</span>

            <span class="c1"># {&#39;dens&#39;: dens, &#39;temp&#39;: temp, &#39;PEC&#39;: PEC}</span>
            <span class="k">if</span> <span class="n">lam</span> <span class="ow">in</span> <span class="n">plot_lines</span><span class="p">:</span>

                <span class="c1"># use log spacing for ne values</span>
                <span class="k">if</span> <span class="n">ne_max</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="c1"># avoid overflow inside of np.logspace</span>
                    <span class="n">ne_eval</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">dens</span><span class="o">.</span><span class="n">min</span><span class="p">()),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">ne_max</span><span class="p">),</span> <span class="mi">10</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ne_eval</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">dens</span><span class="o">.</span><span class="n">min</span><span class="p">()),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">dens</span><span class="o">.</span><span class="n">max</span><span class="p">()),</span> <span class="mi">10</span><span class="p">)</span>
                    <span class="c1">#scipy.logspace(dens.min(), dens.max(), 10)</span>

                <span class="c1"># linear spacing for Te values</span>
                <span class="k">if</span> <span class="n">Te_max</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">Te_eval</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">temp</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">Te_max</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">Te_eval</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">temp</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">temp</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">100</span><span class="p">)</span>

                <span class="n">NE</span><span class="p">,</span> <span class="n">TE</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">ne_eval</span><span class="p">,</span> <span class="n">Te_eval</span><span class="p">)</span>
                <span class="n">PEC_eval</span> <span class="o">=</span> <span class="n">pec_dict</span><span class="p">[</span><span class="n">lam</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">ev</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">NE</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">TE</span><span class="p">))</span>

                <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">f1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">plot_3d</span><span class="p">:</span>
                        <span class="n">ax1</span> <span class="o">=</span> <span class="n">f1</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">ax1</span> <span class="o">=</span> <span class="n">f1</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ax1</span> <span class="o">=</span> <span class="n">ax</span>

                <span class="k">if</span> <span class="n">plot_3d</span><span class="p">:</span>

                    <span class="c1"># linear scales (log doesn&#39;t work in matplotlib 3D)</span>
                    <span class="c1"># but can do all plotting on log quantities</span>
                    <span class="k">if</span> <span class="n">plot_log</span><span class="p">:</span>
                        <span class="n">logNE</span><span class="p">,</span> <span class="n">logTE</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">ne_eval</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Te_eval</span><span class="p">))</span>
                        <span class="n">ax1</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">logNE</span><span class="p">,</span> <span class="n">logTE</span><span class="p">,</span> <span class="n">PEC_eval</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">ax1</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">NE</span><span class="p">,</span> <span class="n">TE</span><span class="p">,</span> <span class="n">PEC_eval</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">plot_log</span><span class="p">:</span>
                        <span class="n">dens</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">dens</span><span class="p">);</span> <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">Te_max</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">ne_max</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">DENS</span><span class="p">,</span> <span class="n">TEMP</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">dens</span><span class="p">,</span> <span class="n">temp</span><span class="p">)</span>
                        <span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">DENS</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">TEMP</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">PEC</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">Te_max</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">ne_max</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">Te_max_ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">temp</span> <span class="o">-</span> <span class="n">Te_max</span><span class="o">*</span><span class="mi">1000</span><span class="p">))</span>
                        <span class="n">DENS</span><span class="p">,</span> <span class="n">TEMP</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">dens</span><span class="p">,</span> <span class="n">temp</span><span class="p">[:</span><span class="n">Te_max_ind</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
                        <span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">DENS</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">TEMP</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">PEC</span><span class="p">[:,:</span><span class="n">Te_max_ind</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">Te_max</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">ne_max</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">ne_max_ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">dens</span> <span class="o">-</span> <span class="n">ne_max</span><span class="p">))</span>
                        <span class="n">DENS</span><span class="p">,</span> <span class="n">TEMP</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">dens</span><span class="p">[:</span><span class="n">ne_max_ind</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">temp</span><span class="p">)</span>
                        <span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">DENS</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">TEMP</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">PEC</span><span class="p">[:</span><span class="n">ne_max_ind</span><span class="o">+</span><span class="mi">1</span><span class="p">,:]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">Te_max</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">ne_max</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">Te_max_ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">temp</span> <span class="o">-</span> <span class="n">Te_max</span><span class="o">*</span><span class="mi">1000</span><span class="p">))</span>
                        <span class="n">ne_max_ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">dens</span> <span class="o">-</span> <span class="n">ne_max</span><span class="p">))</span>
                        <span class="n">DENS</span><span class="p">,</span> <span class="n">TEMP</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">dens</span><span class="p">[:</span><span class="n">ne_max_ind</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">temp</span><span class="p">[:</span><span class="n">Te_max_ind</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
                        <span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">DENS</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">TEMP</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">PEC</span><span class="p">[:</span><span class="n">ne_max_ind</span><span class="o">+</span><span class="mi">1</span><span class="p">,:</span><span class="n">Te_max_ind</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$n_e$ [cm$^{-3}$]&#39;</span><span class="p">)</span>
                        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$T_e$ [eV]&#39;</span><span class="p">)</span>

                        <span class="n">ax1</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;PEC&#39;</span><span class="p">)</span>
                        <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">cs</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39; --- $\lambda$ = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">lam</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39; A&#39;</span><span class="p">)</span>
                        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

                <span class="k">else</span><span class="p">:</span>

                    <span class="c1"># plot in 2D</span>
                    <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">{:.0e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ne</span><span class="p">)</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39; $cm^{-3}$&#39;</span> <span class="k">for</span> <span class="n">ne</span> <span class="ow">in</span> <span class="n">ne_eval</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">ine</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">PEC_eval</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Te_eval</span><span class="p">,</span> <span class="n">PEC_eval</span><span class="p">[:,</span><span class="n">ine</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">labels</span><span class="p">[</span><span class="n">ine</span><span class="p">])</span>
                    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$T_e$ [kev]&#39;</span><span class="p">)</span>
                    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;PEC&#39;</span><span class="p">)</span>
                    <span class="n">ax1</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">pec_plot_min</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">pec_plot_min</span><span class="p">,</span> <span class="n">ax1</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]])</span>
                    <span class="k">if</span> <span class="n">pec_plot_max</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pec_plot_max</span> <span class="p">])</span>

                    <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set_draggable</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                    <span class="c1">#ax1.legend(loc=&#39;best&#39;).draggable(True)</span>
                    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">cs</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39; --- $\lambda$ = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">lam</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39; A&#39;</span><span class="p">)</span>


    <span class="k">return</span> <span class="n">pec_dict</span></div>


<span class="c1"># -------------------------------------------------------------------------------</span>
<span class="c1">#</span>
<span class="c1">#   Routines to examine ionization equilibrium</span>
<span class="c1">#</span>
<span class="c1"># -------------------------------------------------------------------------------</span>

<div class="viewcode-block" id="null_space"><a class="viewcode-back" href="../../aurora.html#aurora.atomic.null_space">[docs]</a><span class="k">def</span> <span class="nf">null_space</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Find null space of matrix A &#39;&#39;&#39;</span>
    <span class="n">u</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">vh</span> <span class="o">=</span> <span class="n">svd</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">full_matrices</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">Q</span> <span class="o">=</span> <span class="n">vh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,:]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span>    <span class="c1"># -1 index is after infinite time/equilibration</span>
    <span class="c1"># return the smallest singular eigenvalue</span>
    <span class="k">return</span> <span class="n">Q</span><span class="p">,</span> <span class="n">s</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># matrix is singular, so last index is ~0</span></div>


<div class="viewcode-block" id="get_frac_abundances"><a class="viewcode-back" href="../../aurora.html#aurora.atomic.get_frac_abundances">[docs]</a><span class="k">def</span> <span class="nf">get_frac_abundances</span><span class="p">(</span><span class="n">atom_data</span><span class="p">,</span> <span class="n">ne</span><span class="p">,</span><span class="n">Te</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n0_by_ne</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span> <span class="n">include_cx</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">rho</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">rho_lbl</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span>
                        <span class="n">compute_rates</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Calculate fractional abundances from ionization and recombination equilibrium.</span>
<span class="sd">    If include_cx=True, radiative recombination and thermal charge exchange are summed.</span>

<span class="sd">    Args:</span>
<span class="sd">        atom_data : dictionary of atomic ADAS files (only acd, scd are required; ccd is </span>
<span class="sd">            necessary only if include_cx=True</span>
<span class="sd">        ne : float or array</span>
<span class="sd">            Electron density in units of m^-3</span>
<span class="sd">        Te : float or array, optional</span>
<span class="sd">            Electron temperature in units of eV. If left to None, the Te grid given in the </span>
<span class="sd">            atomic data is used.</span>
<span class="sd">        n0_by_ne: float or array, optional</span>
<span class="sd">            Ratio of background neutral hydrogen to electron density, used if include_cx=True. </span>
<span class="sd">        include_cx : bool</span>
<span class="sd">            If True, charge exchange with background thermal neutrals is included. </span>
<span class="sd">        plot : bool, optional</span>
<span class="sd">            Show fractional abundances as a function of ne,Te profiles parameterization.</span>
<span class="sd">        ax : matplotlib.pyplot Axes instance</span>
<span class="sd">            Axes on which to plot if plot=True. If False, it creates new axes</span>
<span class="sd">        rho : list or array, optional</span>
<span class="sd">            Vector of radial coordinates on which ne,Te (and possibly n0_by_ne) are given. </span>
<span class="sd">            This is only used for plotting, if given. </span>
<span class="sd">        rho_lbl: str, optional</span>
<span class="sd">            Label to be used for rho. If left to None, defaults to a general &quot;rho&quot;.</span>
<span class="sd">        ls : str, optional</span>
<span class="sd">            Line style for plots. Continuous lines are used by default. </span>
<span class="sd">        compute_rates : bool</span>
<span class="sd">            If True, compute rate coefficients for ionization/recombination equilibrium on top</span>
<span class="sd">            of fractional abundances (which should be the same regardless of the method used). </span>

<span class="sd">    Returns:</span>
<span class="sd">        logTe : array</span>
<span class="sd">            log10 of electron temperatures as a function of which the fractional abundances and</span>
<span class="sd">            rate coefficients are given.</span>
<span class="sd">        fz : array, (space,nZ)</span>
<span class="sd">            Fractional abundances across the same grid used by the input ne,Te values. </span>
<span class="sd">        rate_coeff : array, (space, nZ)</span>
<span class="sd">            Rate coefficients in units of [s^-1]. </span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">logTe</span><span class="p">,</span> <span class="n">logS</span><span class="p">,</span><span class="n">logR</span><span class="p">,</span><span class="n">logcx</span> <span class="o">=</span> <span class="n">get_cs_balance_terms</span><span class="p">(</span><span class="n">atom_data</span><span class="p">,</span> <span class="n">ne</span><span class="p">,</span><span class="n">Te</span><span class="p">,</span> <span class="n">maxTe</span><span class="o">=</span><span class="mf">10e3</span><span class="p">,</span> <span class="n">include_cx</span><span class="o">=</span><span class="n">include_cx</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">include_cx</span><span class="p">:</span>
        <span class="c1"># Get an effective recombination rate by summing radiative &amp; CX recombination rates</span>
        <span class="n">logR</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logaddexp</span><span class="p">(</span><span class="n">logR</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">n0_by_ne</span><span class="p">)[:,</span><span class="kc">None</span><span class="p">]</span> <span class="o">+</span><span class="n">logcx</span><span class="p">)</span>
        
    <span class="c1"># analytical formula for fractional abundance</span>
    <span class="n">rate_ratio</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">logTe</span><span class="p">)[:,</span><span class="kc">None</span><span class="p">],</span> <span class="n">logS</span><span class="o">-</span><span class="n">logR</span><span class="p">))</span>
    <span class="n">rate_ratio</span><span class="p">[</span><span class="n">rate_ratio</span><span class="o">&lt;-</span><span class="mf">10.</span><span class="p">]</span><span class="o">=-</span><span class="mf">10.</span>  <span class="c1"># to avoid underflow in exponential</span>
    <span class="n">fz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">rate_ratio</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">fz</span> <span class="o">/=</span> <span class="n">fz</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">)[:,</span><span class="kc">None</span><span class="p">]</span>
    
    <span class="k">if</span> <span class="n">compute_rates</span><span class="p">:</span>
        <span class="c1"># numerical method which calculates also rate_coeff</span>
        <span class="n">nion</span> <span class="o">=</span> <span class="n">logR</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">fz</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">logTe</span><span class="o">.</span><span class="n">size</span><span class="p">,</span><span class="n">nion</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">rate_coeff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">logTe</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">it</span><span class="p">,</span><span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">logTe</span><span class="p">):</span>

            <span class="n">A</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">logS</span><span class="p">[</span><span class="n">it</span><span class="p">]),</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">logS</span><span class="p">[</span><span class="n">it</span><span class="p">]),</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span>\
                <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">logR</span><span class="p">[</span><span class="n">it</span><span class="p">]),</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">logR</span><span class="p">[</span><span class="n">it</span><span class="p">])])</span>
            
            <span class="n">N</span><span class="p">,</span><span class="n">rate_coeff</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">null_space</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
            <span class="n">fz</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">N</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="n">rate_coeff</span><span class="o">*=</span><span class="n">ne</span>
    
    <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>
        <span class="c1"># plot fractional abundances</span>
        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span><span class="p">,</span><span class="n">axx</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">axx</span> <span class="o">=</span> <span class="n">ax</span>

        <span class="k">if</span> <span class="n">rho</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="n">logTe</span>
            <span class="n">axx</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;T$_e$ [eV]&#39;</span><span class="p">)</span>
            <span class="n">axx</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">rho_lbl</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">rho_lbl</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\rho$&#39;</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">rho</span>
            <span class="n">axx</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">rho_lbl</span><span class="p">)</span>

        <span class="n">axx</span><span class="o">.</span><span class="n">set_prop_cycle</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">,</span><span class="n">cm</span><span class="o">.</span><span class="n">plasma</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">fz</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span>
        <span class="n">axx</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">fz</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="n">ls</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fz</span><span class="o">.</span><span class="n">T</span><span class="p">)):</span>
            <span class="n">imax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">fz</span><span class="p">[:,</span><span class="n">i</span><span class="p">])</span>
            <span class="n">axx</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="mf">0.05</span><span class="p">,</span><span class="n">x</span><span class="p">[</span><span class="n">imax</span><span class="p">]]),</span> <span class="n">fz</span><span class="p">[</span><span class="n">imax</span><span class="p">,</span><span class="n">i</span><span class="p">],</span> <span class="n">i</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">clip_on</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">axx</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
        <span class="n">axx</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.05</span><span class="p">)</span>
        <span class="n">axx</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">axx</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Fractional abundances&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">axx</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">axx</span> <span class="o">=</span> <span class="kc">None</span>    

    <span class="k">if</span> <span class="n">compute_rates</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">logTe</span><span class="p">,</span> <span class="n">fz</span><span class="p">,</span> <span class="n">axx</span><span class="p">,</span> <span class="n">rate_coeff</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">logTe</span><span class="p">,</span> <span class="n">fz</span><span class="p">,</span> <span class="n">axx</span></div>





<div class="viewcode-block" id="get_cs_balance_terms"><a class="viewcode-back" href="../../aurora.html#aurora.atomic.get_cs_balance_terms">[docs]</a><span class="k">def</span> <span class="nf">get_cs_balance_terms</span><span class="p">(</span><span class="n">atom_data</span><span class="p">,</span> <span class="n">ne</span><span class="o">=</span><span class="mf">5e19</span><span class="p">,</span><span class="n">Te</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">maxTe</span><span class="o">=</span><span class="mf">10e3</span><span class="p">,</span> <span class="n">include_cx</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Get S, R and cx on the same logTe grid. </span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        atom_data : dictionary of atomic ADAS files (only acd, scd are required; ccd is </span>
<span class="sd">            necessary only if include_cx=True</span>
<span class="sd">        ne : float or array</span>
<span class="sd">            Electron density in units of m^-3</span>
<span class="sd">        Te : float or array</span>
<span class="sd">            Electron temperature in units of eV. If left to None, the Te grid</span>
<span class="sd">            given in the atomic data is used.</span>
<span class="sd">        maxTe : float</span>
<span class="sd">            Maximum temperature of interest; only used if Te is left to None. </span>
<span class="sd">        include_cx : bool</span>
<span class="sd">            If True, obtain charge exchange terms as well. </span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        logTe : array (n_Te)</span>
<span class="sd">            log10 Te grid on which atomic rates are given</span>
<span class="sd">        logS, logR (,logcx): arrays (n_ne,n_Te)</span>
<span class="sd">            atomic rates for effective ionization, radiative+dielectronic</span>
<span class="sd">            recombination (+ charge exchange, if requested). After exponentiation, all terms</span>
<span class="sd">            will be in units of s^-1. </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">Te</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1">#find smallest Te grid from all files</span>
        <span class="n">logne1</span><span class="p">,</span> <span class="n">logTe1</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">atom_data</span><span class="p">[</span><span class="s1">&#39;scd&#39;</span><span class="p">]</span>  <span class="c1"># ionization</span>
        <span class="n">logne2</span><span class="p">,</span> <span class="n">logTe2</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">atom_data</span><span class="p">[</span><span class="s1">&#39;acd&#39;</span><span class="p">]</span>  <span class="c1"># radiative recombination</span>

        <span class="n">minTe</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">logTe1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">logTe2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">maxTe</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">maxTe</span><span class="p">)</span><span class="c1"># don&#39;t go further than some given temperature keV</span>
        <span class="n">maxTe</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">maxTe</span><span class="p">,</span><span class="n">logTe1</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">logTe2</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>  <span class="c1"># avoid extrapolation</span>

        <span class="k">if</span> <span class="n">include_cx</span><span class="p">:</span>
            <span class="n">logne3</span><span class="p">,</span> <span class="n">logTe3</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">atom_data</span><span class="p">[</span><span class="s1">&#39;ccd&#39;</span><span class="p">]</span>  <span class="c1"># thermal cx recombination</span>
            <span class="n">minTe</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">minTe</span><span class="p">,</span><span class="n">logTe3</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">maxTe</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">maxTe</span><span class="p">,</span><span class="n">logTe3</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>  <span class="c1"># avoid extrapolation</span>

        <span class="n">logTe</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">minTe</span><span class="p">,</span><span class="n">maxTe</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">logTe</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Te</span><span class="p">)</span>


    <span class="n">logne</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">ne</span><span class="p">)</span><span class="o">-</span><span class="mi">6</span>

    <span class="n">logS</span> <span class="o">=</span> <span class="n">interp_atom_prof</span><span class="p">(</span><span class="n">atom_data</span><span class="p">[</span><span class="s1">&#39;scd&#39;</span><span class="p">],</span><span class="n">logne</span><span class="p">,</span> <span class="n">logTe</span><span class="p">,</span><span class="n">log_val</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">x_multiply</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">logR</span> <span class="o">=</span> <span class="n">interp_atom_prof</span><span class="p">(</span><span class="n">atom_data</span><span class="p">[</span><span class="s1">&#39;acd&#39;</span><span class="p">],</span><span class="n">logne</span><span class="p">,</span> <span class="n">logTe</span><span class="p">,</span><span class="n">log_val</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">x_multiply</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">include_cx</span><span class="p">:</span>
        <span class="n">logcx</span> <span class="o">=</span> <span class="n">interp_atom_prof</span><span class="p">(</span><span class="n">atom_data</span><span class="p">[</span><span class="s1">&#39;ccd&#39;</span><span class="p">],</span><span class="n">logne</span><span class="p">,</span> <span class="n">logTe</span><span class="p">,</span><span class="n">log_val</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">x_multiply</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">logcx</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">logTe</span><span class="p">,</span> <span class="n">logS</span><span class="p">,</span> <span class="n">logR</span><span class="p">,</span> <span class="n">logcx</span></div>



<div class="viewcode-block" id="plot_relax_time"><a class="viewcode-back" href="../../aurora.html#aurora.atomic.plot_relax_time">[docs]</a><span class="k">def</span> <span class="nf">plot_relax_time</span><span class="p">(</span><span class="n">logTe</span><span class="p">,</span> <span class="n">rate_coeff</span><span class="p">,</span> <span class="n">ne_mean</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Plot relaxation time of the ionization equilibrium corresponding</span>
<span class="sd">    to the inverse of the given rate coefficients &#39;&#39;&#39;</span>

    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="n">logTe</span><span class="p">,</span><span class="mf">1e3</span><span class="o">/</span><span class="n">rate_coeff</span><span class="p">,</span><span class="s1">&#39;b&#39;</span> <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="n">logTe</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">10</span><span class="o">**</span><span class="n">logTe</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;T$_e$ [eV]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\tau_\mathrm</span><span class="si">{relax}</span><span class="s1">$ [ms]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;n$_e$ = </span><span class="si">%.2g</span><span class="s1"> m$^{-3}$&#39;</span><span class="o">%</span><span class="n">ne_mean</span><span class="p">)</span></div>




<div class="viewcode-block" id="CartesianGrid"><a class="viewcode-back" href="../../aurora.html#aurora.atomic.CartesianGrid">[docs]</a><span class="k">class</span> <span class="nc">CartesianGrid</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Linear multivariate Cartesian grid interpolation in arbitrary dimensions</span>
<span class="sd">    This is a regular grid with equal spacing.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">grids</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; grids: list of arrays or ranges of each dimension</span>
<span class="sd">        values: array with shape (ndim, len(grid[0]), len(grid[1]),...)</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">g</span><span class="p">,</span><span class="n">s</span> <span class="ow">in</span>  <span class="nb">zip</span><span class="p">(</span><span class="n">grids</span><span class="p">,</span><span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">g</span><span class="p">)</span> <span class="o">!=</span> <span class="n">s</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;wrong size of values array&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">offsets</span> <span class="o">=</span> <span class="p">[</span><span class="n">g</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">grids</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scales</span>  <span class="o">=</span> <span class="p">[(</span><span class="n">g</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">g</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">g</span><span class="p">,</span><span class="n">n</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">grids</span><span class="p">,</span> <span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:])]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">coords</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Transform coords into pixel values &#39;&#39;&#39;</span>
        <span class="n">out_shape</span> <span class="o">=</span> <span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>

        <span class="n">coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
        <span class="n">coords</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offsets</span>
        <span class="n">coords</span> <span class="o">/=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scales</span>
        <span class="n">coords</span> <span class="o">=</span> <span class="n">coords</span><span class="o">.</span><span class="n">T</span>

        <span class="c1">#clip dimension - it will extrapolation by a nearest value</span>
        <span class="k">for</span> <span class="n">coord</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">):</span>
            <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">coord</span><span class="p">)</span>

        <span class="c1">#prepare output array</span>
        <span class="n">inter_out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],)</span><span class="o">+</span><span class="n">out_shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>

        <span class="c1">#fast interpolation on a regular grid</span>
        <span class="k">for</span> <span class="n">out</span><span class="p">,</span><span class="n">val</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">inter_out</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
            <span class="n">scipy</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">map_coordinates</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span>
                                            <span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="n">out</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">inter_out</span></div>


<div class="viewcode-block" id="interp_atom_prof"><a class="viewcode-back" href="../../aurora.html#aurora.atomic.interp_atom_prof">[docs]</a><span class="k">def</span> <span class="nf">interp_atom_prof</span><span class="p">(</span><span class="n">atom_table</span><span class="p">,</span><span class="n">x_prof</span><span class="p">,</span> <span class="n">y_prof</span><span class="p">,</span><span class="n">log_val</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">x_multiply</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Fast interpolate atomic data in atom_table onto the x_prof and y_prof profiles.</span>
<span class="sd">    assume that x_prof, y_prof, x,y, table are all decadic logarithms</span>
<span class="sd">    and x_prof, y_prof are equally spaced(always for ADAS data)</span>
<span class="sd">    log_val bool: return natural logarithm of the data</span>
<span class="sd">    x_multiply bool: multiply output by 10**x_prof , it will not not multiplied if x_prof is None</span>

<span class="sd">    return data interpolated on shape(nt,nion,nr)</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">table</span> <span class="o">=</span> <span class="n">atom_table</span>

    <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">table</span><span class="o">-</span><span class="n">table</span><span class="p">[</span><span class="o">...</span><span class="p">,[</span><span class="mi">0</span><span class="p">]])</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>  <span class="o">&lt;</span> <span class="o">.</span><span class="mi">05</span><span class="p">)</span> <span class="ow">or</span> <span class="n">x_prof</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1">#1D interpolaion if independent of the last dimension - like SXR radiation data</span>

        <span class="n">reg_interp</span> <span class="o">=</span> <span class="n">CartesianGrid</span><span class="p">((</span><span class="n">y</span><span class="p">,</span> <span class="p">),</span><span class="n">table</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
        <span class="n">interp_vals</span> <span class="o">=</span> <span class="n">reg_interp</span><span class="p">(</span><span class="n">y_prof</span><span class="p">)</span> 

        <span class="c1">#multipling of logarithms is just adding</span>
        <span class="k">if</span> <span class="n">x_multiply</span> <span class="ow">and</span> <span class="n">x_prof</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">interp_vals</span> <span class="o">+=</span> <span class="n">x_prof</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span><span class="c1">#2D interpolation</span>
        <span class="k">if</span> <span class="n">x_multiply</span><span class="p">:</span> <span class="c1">#multipling of logarithms is just adding</span>
            <span class="n">table</span> <span class="o">+=</span> <span class="n">x</span>
        <span class="c1">#breadcast both variables in the sae shape</span>
        <span class="n">x_prof</span><span class="p">,</span> <span class="n">y_prof</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_arrays</span><span class="p">(</span><span class="n">x_prof</span><span class="p">,</span> <span class="n">y_prof</span><span class="p">)</span>
        <span class="c1">#perform fast linear interpolation</span>
        <span class="n">reg_interp</span> <span class="o">=</span> <span class="n">CartesianGrid</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span><span class="n">table</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
        <span class="n">interp_vals</span> <span class="o">=</span> <span class="n">reg_interp</span><span class="p">(</span><span class="n">x_prof</span><span class="p">,</span><span class="n">y_prof</span><span class="p">)</span> 

    <span class="c1">#reshape to shape(nt,nion,nr)</span>
    <span class="n">interp_vals</span> <span class="o">=</span> <span class="n">interp_vals</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">log_val</span><span class="p">:</span>
        <span class="c1">#return actual value, not logarithm</span>
        <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">interp_vals</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">interp_vals</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">interp_vals</span></div>





<div class="viewcode-block" id="gff_mean"><a class="viewcode-back" href="../../aurora.html#aurora.atomic.gff_mean">[docs]</a><span class="k">def</span> <span class="nf">gff_mean</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span><span class="n">Te</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Total free-free gaunt factor yielding the total radiated bremsstrahlung power</span>
<span class="sd">    when multiplying with the result for gff=1.</span>
<span class="sd">    Data originally from Karzas &amp; Latter, extracted from STRAHL&#39;s atomic_data.f.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="kn">from</span> <span class="nn">scipy.constants</span> <span class="kn">import</span> <span class="n">e</span><span class="p">,</span><span class="n">h</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">Rydberg</span>
    <span class="n">thirteenpointsix</span> <span class="o">=</span> <span class="n">h</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="n">Rydberg</span><span class="o">/</span><span class="n">e</span>

    <span class="n">log_gamma2_grid</span> <span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">3.000</span><span class="p">,</span><span class="o">-</span><span class="mf">2.833</span><span class="p">,</span><span class="o">-</span><span class="mf">2.667</span><span class="p">,</span><span class="o">-</span><span class="mf">2.500</span><span class="p">,</span><span class="o">-</span><span class="mf">2.333</span><span class="p">,</span><span class="o">-</span><span class="mf">2.167</span><span class="p">,</span><span class="o">-</span><span class="mf">2.000</span><span class="p">,</span><span class="o">-</span><span class="mf">1.833</span><span class="p">,</span><span class="o">-</span><span class="mf">1.667</span><span class="p">,</span><span class="o">-</span><span class="mf">1.500</span><span class="p">,</span>
                        <span class="o">-</span><span class="mf">1.333</span><span class="p">,</span><span class="o">-</span><span class="mf">1.167</span><span class="p">,</span><span class="o">-</span><span class="mf">1.000</span><span class="p">,</span><span class="o">-</span><span class="mf">0.833</span><span class="p">,</span><span class="o">-</span><span class="mf">0.667</span><span class="p">,</span><span class="o">-</span><span class="mf">0.500</span><span class="p">,</span><span class="o">-</span><span class="mf">0.333</span><span class="p">,</span><span class="o">-</span><span class="mf">0.167</span><span class="p">,</span> <span class="mf">0.000</span><span class="p">,</span> <span class="mf">0.167</span><span class="p">,</span>
                        <span class="mf">0.333</span><span class="p">,</span> <span class="mf">0.500</span><span class="p">,</span> <span class="mf">0.667</span><span class="p">,</span> <span class="mf">0.833</span><span class="p">,</span> <span class="mf">1.000</span><span class="p">]</span>

    <span class="n">gff_mean_grid</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.140</span><span class="p">,</span> <span class="mf">1.149</span><span class="p">,</span> <span class="mf">1.159</span><span class="p">,</span> <span class="mf">1.170</span><span class="p">,</span> <span class="mf">1.181</span><span class="p">,</span> <span class="mf">1.193</span><span class="p">,</span> <span class="mf">1.210</span><span class="p">,</span> <span class="mf">1.233</span><span class="p">,</span> <span class="mf">1.261</span><span class="p">,</span> <span class="mf">1.290</span><span class="p">,</span>
                     <span class="mf">1.318</span><span class="p">,</span> <span class="mf">1.344</span><span class="p">,</span> <span class="mf">1.370</span><span class="p">,</span> <span class="mf">1.394</span><span class="p">,</span> <span class="mf">1.416</span><span class="p">,</span> <span class="mf">1.434</span><span class="p">,</span> <span class="mf">1.445</span><span class="p">,</span> <span class="mf">1.448</span><span class="p">,</span> <span class="mf">1.440</span><span class="p">,</span> <span class="mf">1.418</span><span class="p">,</span>
                     <span class="mf">1.389</span><span class="p">,</span> <span class="mf">1.360</span><span class="p">,</span> <span class="mf">1.336</span><span class="p">,</span> <span class="mf">1.317</span><span class="p">,</span> <span class="mf">1.300</span><span class="p">]</span>

    <span class="c1"># set min Te here to 10 eV (as in STRAHL), because the grid above does not extend to lower temperatures</span>
    <span class="n">Te</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">Te</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">)</span>

    <span class="n">log_gamma2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Z</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">thirteenpointsix</span><span class="o">/</span><span class="n">Te</span><span class="p">)</span>

    <span class="c1"># dangerous/inaccurate extrapolation...??</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">log_gamma2</span><span class="p">,</span> <span class="n">log_gamma2_grid</span><span class="p">,</span><span class="n">gff_mean_grid</span><span class="p">)</span></div>



<div class="viewcode-block" id="impurity_brems"><a class="viewcode-back" href="../../aurora.html#aurora.atomic.impurity_brems">[docs]</a><span class="k">def</span> <span class="nf">impurity_brems</span><span class="p">(</span><span class="n">nz</span><span class="p">,</span> <span class="n">ne</span><span class="p">,</span> <span class="n">Te</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Impurity bremsstrahlung in units of mW/nm/sr/m^3.cm^3.</span>

<span class="sd">    This is only approximate and may not be very useful, since this contribution</span>
<span class="sd">    is already included in the continuum in x2.</span>

<span class="sd">    This estimate does not have the correct ne-dependence of the Gaunt factor... use with care!</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="c1"># neutral stage doesn&#39;t produce brems</span>
    <span class="n">Z_imp</span> <span class="o">=</span> <span class="n">nz</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">Z_imp</span><span class="p">)[</span><span class="kc">None</span><span class="p">,:,</span><span class="kc">None</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span>

    <span class="n">gff</span> <span class="o">=</span> <span class="n">gff_mean</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span><span class="n">Te</span><span class="p">[:,</span><span class="kc">None</span><span class="p">])</span>
    <span class="n">imp_brems</span> <span class="o">=</span> <span class="n">Z</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">nz</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:]</span> <span class="o">*</span> <span class="n">gff</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.69e-32</span> <span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Te</span><span class="p">)</span> <span class="o">*</span> <span class="n">ne</span><span class="p">)</span> <span class="p">[:,</span><span class="kc">None</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">imp_brems</span></div>


<div class="viewcode-block" id="main_ion_brems"><a class="viewcode-back" href="../../aurora.html#aurora.atomic.main_ion_brems">[docs]</a><span class="k">def</span> <span class="nf">main_ion_brems</span><span class="p">(</span><span class="n">Zi</span><span class="p">,</span> <span class="n">ni</span><span class="p">,</span> <span class="n">ne</span><span class="p">,</span> <span class="n">Te</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Main-ion bremsstrahlung in units of  mW/nm/sr/m^3.cm^3.</span>

<span class="sd">    It is likely better to calculate this from H/D/T plt files, which will have more accurate </span>
<span class="sd">    Gaunt factors with the correct density dependence.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="mf">1.69e-32</span> <span class="o">*</span> <span class="n">ni</span> <span class="o">*</span> <span class="n">Zi</span><span class="o">**</span><span class="mf">2.</span> <span class="o">*</span> <span class="n">ne</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Te</span><span class="p">)</span> <span class="o">*</span> <span class="n">gff_mean</span><span class="p">(</span><span class="n">Zi</span><span class="p">,</span><span class="n">Te</span><span class="p">)</span></div>




<div class="viewcode-block" id="get_adas_ion_rad"><a class="viewcode-back" href="../../aurora.html#aurora.atomic.get_adas_ion_rad">[docs]</a><span class="k">def</span> <span class="nf">get_adas_ion_rad</span><span class="p">(</span><span class="n">ion_name</span><span class="p">,</span> <span class="n">n_ion</span><span class="p">,</span> <span class="n">logne_prof</span><span class="p">,</span> <span class="n">logTe_prof</span><span class="p">,</span> <span class="n">sxr</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Get ADAS estimate for total radiation in [M/m^3] for the given ion</span>
<span class="sd">    with the given (log) density and temperature profiles. </span>

<span class="sd">    If sxr=True, &#39;prs&#39; files are used instead of &#39;prb&#39; ones, thus giving SXR-filtered</span>
<span class="sd">    radiation for the SXR filter indicated by the atomic data dictionary.</span>
<span class="sd">    &#39;&#39;&#39;</span>        
    <span class="c1"># get all atomic data for chosen ion</span>
    <span class="n">atom_data</span> <span class="o">=</span> <span class="n">get_all_atom_data</span><span class="p">(</span><span class="n">ion_name</span><span class="p">,[</span><span class="s1">&#39;prs&#39;</span> <span class="k">if</span> <span class="n">sxr</span> <span class="k">else</span> <span class="s1">&#39;prb&#39;</span><span class="p">])</span>

    <span class="c1"># load filtered data in the SXR range</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">tab</span> <span class="o">=</span> <span class="n">atom_data</span><span class="p">[</span><span class="s1">&#39;prs&#39;</span> <span class="k">if</span> <span class="n">sxr</span> <span class="k">else</span> <span class="s1">&#39;prb&#39;</span><span class="p">]</span>
    
    <span class="c1">#recombination and bremstrahlung of fully striped ion</span>
    <span class="n">prs</span> <span class="o">=</span> <span class="n">interp_atom_prof</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">tab</span><span class="p">[[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]),</span><span class="n">logne_prof</span><span class="p">,</span><span class="n">logTe_prof</span><span class="p">,</span><span class="n">x_multiply</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Now compute expected radiation expected from this background ion:</span>
    <span class="n">bckg</span> <span class="o">=</span> <span class="n">prs</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">n_ion</span> <span class="o">*</span> <span class="mf">1e6</span> <span class="c1"># bulk fully-stripped ion radiation [W/m^3]</span>

    <span class="k">return</span> <span class="n">bckg</span></div>


<div class="viewcode-block" id="get_cooling_factors"><a class="viewcode-back" href="../../aurora.html#aurora.atomic.get_cooling_factors">[docs]</a><span class="k">def</span> <span class="nf">get_cooling_factors</span><span class="p">(</span><span class="n">atom_data</span><span class="p">,</span> <span class="n">logTe_</span><span class="p">,</span> <span class="n">fz</span><span class="p">,</span> <span class="n">ion_resolved</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Calculate cooling coefficients from fz and prs,  pls (if these are available).</span>
<span class="sd">    Also plot the inverse of rate coefficients, which gives an estimate for relaxation times.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">atom_data</span><span class="p">[</span><span class="s1">&#39;prs&#39;</span><span class="p">]</span>
        <span class="n">atom_data</span><span class="p">[</span><span class="s1">&#39;pls&#39;</span><span class="p">]</span>
        <span class="n">atom_data</span><span class="p">[</span><span class="s1">&#39;plt&#39;</span><span class="p">]</span>
        <span class="n">atom_data</span><span class="p">[</span><span class="s1">&#39;prb&#39;</span><span class="p">]</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;prs, plt and/or prb files not available!&#39;</span><span class="p">)</span>


    <span class="n">prs</span> <span class="o">=</span> <span class="n">interp_atom_prof</span><span class="p">(</span><span class="n">atom_data</span><span class="p">[</span><span class="s1">&#39;prs&#39;</span><span class="p">],</span><span class="kc">None</span><span class="p">,</span><span class="n">logTe_</span><span class="p">)</span><span class="c1">#continuum radiation in SXR range</span>
    <span class="n">pls</span> <span class="o">=</span> <span class="n">interp_atom_prof</span><span class="p">(</span><span class="n">atom_data</span><span class="p">[</span><span class="s1">&#39;pls&#39;</span><span class="p">],</span><span class="kc">None</span><span class="p">,</span><span class="n">logTe_</span><span class="p">)</span><span class="c1">#line radiation in SXR range</span>
    <span class="n">pltt</span><span class="o">=</span> <span class="n">interp_atom_prof</span><span class="p">(</span><span class="n">atom_data</span><span class="p">[</span><span class="s1">&#39;plt&#39;</span><span class="p">],</span><span class="kc">None</span><span class="p">,</span><span class="n">logTe_</span><span class="p">)</span> <span class="c1">#line radiation</span>
    <span class="n">prb</span> <span class="o">=</span> <span class="n">interp_atom_prof</span><span class="p">(</span><span class="n">atom_data</span><span class="p">[</span><span class="s1">&#39;prb&#39;</span><span class="p">],</span><span class="kc">None</span><span class="p">,</span><span class="n">logTe_</span><span class="p">)</span><span class="c1">#continuum radiation</span>

    <span class="n">pls</span> <span class="o">*=</span> <span class="n">fz</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">prs</span> <span class="o">*=</span> <span class="n">fz</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span>
    <span class="n">pltt</span><span class="o">*=</span> <span class="n">fz</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">prb</span> <span class="o">*=</span> <span class="n">fz</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span>

    <span class="n">line_rad_sxr</span>  <span class="o">=</span> <span class="n">pls</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">brems_rad_sxr</span> <span class="o">=</span> <span class="n">prs</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">line_rad_tot</span>  <span class="o">=</span> <span class="n">pltt</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">brems_rad_tot</span> <span class="o">=</span> <span class="n">prb</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>
        <span class="c1"># plot cooling factors</span>
        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="n">logTe_</span><span class="p">,</span> <span class="n">line_rad_sxr</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;SXR line radiation &#39;</span><span class="p">)</span>   <span class="c1"># can be many orders of magnitude different from brms_rad_sxr (e.g. lower in F)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="n">logTe_</span><span class="p">,</span> <span class="n">brems_rad_sxr</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;SXR bremsstrahlung and recombination&#39;</span><span class="p">)</span>

        <span class="c1"># total SXR rad = brems + line rad in SXR range:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="n">logTe_</span><span class="p">,</span> <span class="n">brems_rad_sxr</span><span class="o">+</span><span class="n">line_rad_sxr</span><span class="p">,</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;total SXR radiation&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="c1"># total radiation (includes hard X-ray, visible, UV, etc.)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="n">logTe_</span><span class="p">,</span> <span class="n">line_rad_tot</span><span class="p">,</span><span class="s1">&#39;g--&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;total line radiation&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="n">logTe_</span><span class="p">,</span> <span class="n">brems_rad_tot</span><span class="p">,</span><span class="s1">&#39;y--&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;total continuum radiation&#39;</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
        <span class="c1">#### set xlims to visualize scales better</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">10</span><span class="o">**</span><span class="n">logTe_</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span> <span class="n">line_rad_sxr</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="n">logTe_</span> <span class="o">-</span> <span class="mi">50</span><span class="p">))],</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span> <span class="n">line_rad_tot</span><span class="p">)</span><span class="o">*</span><span class="mi">10</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;T$_e$ [eV]&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;L$_z$ [Wm$^3$]&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Cooling factors&#39;</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">ion_resolved</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pls</span><span class="p">,</span> <span class="n">prs</span><span class="p">,</span> <span class="n">pltt</span><span class="p">,</span><span class="n">prb</span>


    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">line_rad_sxr</span><span class="p">,</span> <span class="n">brems_rad_sxr</span><span class="p">,</span> <span class="n">line_rad_tot</span><span class="p">,</span> <span class="n">brems_rad_tot</span></div>




<div class="viewcode-block" id="plot_radiation_profs"><a class="viewcode-back" href="../../aurora.html#aurora.atomic.plot_radiation_profs">[docs]</a><span class="k">def</span> <span class="nf">plot_radiation_profs</span><span class="p">(</span><span class="n">atom_data</span><span class="p">,</span> <span class="n">nz_prof</span><span class="p">,</span> <span class="n">logne_prof</span><span class="p">,</span> <span class="n">logTe_prof</span><span class="p">,</span> <span class="n">xvar</span><span class="p">,</span> <span class="n">imp</span><span class="o">=</span><span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Obtain profiles of predicted radiation.</span>

<span class="sd">    This function can be used to plot radial profiles (setting xvar to a radial grid)</span>
<span class="sd">    or profiles as a function of any variable on which the logne_prof and logTe_prof</span>
<span class="sd">    may depend.</span>

<span class="sd">    The variable :param:nz_prof may be a full description of impurity charge state densities</span>
<span class="sd">    (e.g. the output of Aurora), or profiles of fractional abundances from ionization</span>
<span class="sd">    equilibrium.</span>

<span class="sd">    Note that the variables :param:xvar (array) and :param:imp (str) are only needed if plotting is requested.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">pls</span><span class="p">,</span> <span class="n">prs</span><span class="p">,</span> <span class="n">pltt</span><span class="p">,</span> <span class="n">prb</span> <span class="o">=</span> <span class="n">get_cooling_factors</span><span class="p">(</span><span class="n">atom_data</span><span class="p">,</span> <span class="n">logTe_prof</span><span class="p">,</span> <span class="n">nz_prof</span><span class="p">,</span> <span class="n">ion_resolved</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">emiss_sxr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">xvar</span><span class="p">),</span><span class="n">nion</span><span class="p">))</span>
    <span class="n">emiss_tot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">xvar</span><span class="p">),</span><span class="n">nion</span><span class="p">))</span>
    <span class="n">emiss_sxr</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:</span> <span class="p">]</span> <span class="o">+=</span> <span class="n">prs</span>
    <span class="n">emiss_sxr</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">pls</span>
    <span class="n">emiss_tot</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:</span> <span class="p">]</span> <span class="o">+=</span> <span class="n">prb</span>
    <span class="n">emiss_tot</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">pltt</span>

    <span class="c1"># plot radiation components</span>
    <span class="n">fig</span><span class="p">,</span><span class="n">axx</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span><span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axx</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">nion</span> <span class="o">=</span> <span class="n">prs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">plasma</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">nion</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">ax</span><span class="p">:</span>
        <span class="n">a</span><span class="o">.</span><span class="n">set_prop_cycle</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">,</span><span class="n">colors</span><span class="p">)</span>
        <span class="n">a</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[])</span> <span class="c1">#empty plot for bremstrahlung of neutral ion</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvar</span><span class="p">,</span><span class="n">prs</span><span class="p">);</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;PRS: cont SXR rad&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvar</span><span class="p">,</span><span class="n">pls</span><span class="p">);</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;PLS: SXR line rad&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvar</span><span class="p">,</span><span class="n">pltt</span><span class="p">);</span> <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;PLT: tot line rad&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[])</span><span class="c1">#empty plot for bremstrahlung of neutral ion</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvar</span><span class="p">,</span><span class="n">prb</span><span class="p">);</span> <span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;PRB: tot cont rad&#39;</span><span class="p">)</span>

    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$r/a$&#39;</span><span class="p">);</span> <span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$r/a$&#39;</span><span class="p">)</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$</span><span class="si">%s</span><span class="s1">^{</span><span class="si">%d</span><span class="s1">\!+}$&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">imp</span><span class="p">,</span><span class="n">cc</span><span class="p">)</span> <span class="k">for</span> <span class="n">cc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nion</span><span class="p">)]</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xvar</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xvar</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

    <span class="c1"># plot total power (in SXR and whole range)</span>
    <span class="n">fig</span><span class="p">,</span><span class="n">axx</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span><span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axx</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">ax</span><span class="p">:</span>
        <span class="n">a</span><span class="o">.</span><span class="n">set_prop_cycle</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">,</span><span class="n">colors</span><span class="p">)</span>
        <span class="n">a</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvar</span><span class="p">,</span><span class="n">emiss_sxr</span><span class="p">);</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;SXR power [W]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvar</span><span class="p">,</span><span class="n">emiss_tot</span><span class="p">);</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Tot. rad. power [W]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvar</span><span class="p">,</span><span class="n">emiss_sxr</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="n">logne_prof</span><span class="p">[:,</span><span class="kc">None</span><span class="p">]);</span> <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;SXR power [W/m$^{-3}$]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvar</span><span class="p">,</span><span class="n">emiss_tot</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="n">logne_prof</span><span class="p">[:,</span><span class="kc">None</span><span class="p">]);</span> <span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Tot. rad. power [W/m$^{-3}$]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$r/a$&#39;</span><span class="p">);</span> <span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$r/a$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xvar</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xvar</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span></div>





<div class="viewcode-block" id="balance"><a class="viewcode-back" href="../../aurora.html#aurora.atomic.balance">[docs]</a><span class="k">def</span> <span class="nf">balance</span><span class="p">(</span><span class="n">logTe_val</span><span class="p">,</span> <span class="n">cs</span><span class="p">,</span> <span class="n">n0_by_ne</span><span class="p">,</span> <span class="n">logTe_</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">cx</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Evaluate balance of effective ionization, recombination and charge exchange at a given temperature. &#39;&#39;&#39;</span>

    <span class="n">a</span> <span class="o">=</span> <span class="n">R</span> <span class="o">+</span><span class="n">n0_by_ne</span> <span class="o">*</span> <span class="n">cx</span>
    <span class="n">SS_0</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">interp1d</span><span class="p">(</span><span class="n">logTe_</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="n">cs</span><span class="o">-</span><span class="mi">1</span><span class="p">,:]),</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">,</span> <span class="n">bounds_error</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">logTe_val</span><span class="p">))</span>
    <span class="n">aa_0</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">interp1d</span><span class="p">(</span><span class="n">logTe_</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">cs</span><span class="o">-</span><span class="mi">1</span><span class="p">,:]),</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">,</span> <span class="n">bounds_error</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">logTe_val</span><span class="p">))</span>
    <span class="n">SS_1</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">interp1d</span><span class="p">(</span><span class="n">logTe_</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="n">cs</span><span class="p">,:]),</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">,</span> <span class="n">bounds_error</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">logTe_val</span><span class="p">))</span>
    <span class="n">aa_1</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">interp1d</span><span class="p">(</span><span class="n">logTe_</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">cs</span><span class="p">,:]),</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">,</span> <span class="n">bounds_error</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">logTe_val</span><span class="p">))</span>

    <span class="n">val</span> <span class="o">=</span> <span class="n">SS_0</span> <span class="o">-</span> <span class="n">SS_1</span> <span class="o">-</span> <span class="n">aa_0</span> <span class="o">+</span> <span class="n">aa_1</span>
    <span class="k">return</span> <span class="n">val</span><span class="o">*</span><span class="mf">1e20</span> <span class="c1"># get this to large-ish units to avoid tolerance issues due to small powers of 10</span></div>




<div class="viewcode-block" id="adas_files_dict"><a class="viewcode-back" href="../../aurora.html#aurora.atomic.adas_files_dict">[docs]</a><span class="k">def</span> <span class="nf">adas_files_dict</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;Selections for ADAS files for Aurora runs and radiation calculations.</span>
<span class="sd">    This function can be called to fetch a set of default files, which can then be modified (e.g. to </span>
<span class="sd">    use a new file for a specific SXR filter) before running a calculation. </span>
<span class="sd">    &#39;&#39;&#39;</span>
            
    <span class="n">files</span><span class="o">=</span><span class="p">{}</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>   <span class="c1">#1</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">][</span><span class="s1">&#39;acd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;acd96_h.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">][</span><span class="s1">&#39;scd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;scd96_h.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">][</span><span class="s1">&#39;prb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prb96_h.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">][</span><span class="s1">&#39;plt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plt96_h.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">][</span><span class="s1">&#39;ccd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ccd96_h.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">][</span><span class="s1">&#39;prc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prc96_h.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">][</span><span class="s1">&#39;pls&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pls_H_14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">][</span><span class="s1">&#39;prs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prs_H_14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">][</span><span class="s1">&#39;fis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sxrfil14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">][</span><span class="s1">&#39;brs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;brs05360.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;He&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>   <span class="c1">#2</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;He&quot;</span><span class="p">][</span><span class="s1">&#39;acd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;acd96_he.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;He&quot;</span><span class="p">][</span><span class="s1">&#39;scd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;scd96_he.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;He&quot;</span><span class="p">][</span><span class="s1">&#39;prb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prb96_he.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;He&quot;</span><span class="p">][</span><span class="s1">&#39;plt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plt96_he.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;He&quot;</span><span class="p">][</span><span class="s1">&#39;ccd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ccd07_he.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;He&quot;</span><span class="p">][</span><span class="s1">&#39;prc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prc96_he.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;He&quot;</span><span class="p">][</span><span class="s1">&#39;pls&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pls_He_14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;He&quot;</span><span class="p">][</span><span class="s1">&#39;prs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prs_He_14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;He&quot;</span><span class="p">][</span><span class="s1">&#39;fis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sxrfil14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;He&quot;</span><span class="p">][</span><span class="s1">&#39;brs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;brs05360.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Li&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>   <span class="c1">#3</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Li&quot;</span><span class="p">][</span><span class="s1">&#39;acd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;acd96_li.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Li&quot;</span><span class="p">][</span><span class="s1">&#39;scd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;scd96_li.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Li&quot;</span><span class="p">][</span><span class="s1">&#39;ccd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ccd89_li.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Li&quot;</span><span class="p">][</span><span class="s1">&#39;prb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prb96_li.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Li&quot;</span><span class="p">][</span><span class="s1">&#39;plt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plt96_li.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Li&quot;</span><span class="p">][</span><span class="s1">&#39;prc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prc89_li.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Li&quot;</span><span class="p">][</span><span class="s1">&#39;pls&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pls89_li.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Be&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>   <span class="c1">#4</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Be&quot;</span><span class="p">][</span><span class="s1">&#39;acd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;acd96_be.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Be&quot;</span><span class="p">][</span><span class="s1">&#39;scd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;scd96_be.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Be&quot;</span><span class="p">][</span><span class="s1">&#39;prb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prb96_be.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Be&quot;</span><span class="p">][</span><span class="s1">&#39;plt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plt96_be.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Be&quot;</span><span class="p">][</span><span class="s1">&#39;ccd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ccd89_be.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Be&quot;</span><span class="p">][</span><span class="s1">&#39;prc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prc89_be.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Be&quot;</span><span class="p">][</span><span class="s1">&#39;pls&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plsx5_be.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Be&quot;</span><span class="p">][</span><span class="s1">&#39;prs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prsx5_be.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>   <span class="c1">#5</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">][</span><span class="s1">&#39;acd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;acd89_b.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">][</span><span class="s1">&#39;scd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;scd89_b.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">][</span><span class="s1">&#39;ccd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ccd89_b.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">][</span><span class="s1">&#39;prb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prb89_b.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">][</span><span class="s1">&#39;plt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plt89_b.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">][</span><span class="s1">&#39;prc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prc89_b.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">][</span><span class="s1">&#39;pls&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plsx5_b.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">][</span><span class="s1">&#39;prs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prsx5_b.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>    <span class="c1">#6</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">][</span><span class="s1">&#39;acd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;acd96_c.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">][</span><span class="s1">&#39;scd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;scd96_c.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">][</span><span class="s1">&#39;prb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prb96_c.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">][</span><span class="s1">&#39;plt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plt96_c.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">][</span><span class="s1">&#39;ccd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ccd96_c.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">][</span><span class="s1">&#39;prc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prc96_c.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">][</span><span class="s1">&#39;pls&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pls_C_14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">][</span><span class="s1">&#39;prs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prs_C_14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">][</span><span class="s1">&#39;fis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sxrfil14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">][</span><span class="s1">&#39;brs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;brs05360.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>    <span class="c1">#7</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">][</span><span class="s1">&#39;acd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;acd96_n.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">][</span><span class="s1">&#39;scd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;scd96_n.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">][</span><span class="s1">&#39;ccd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ccd89_n.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">][</span><span class="s1">&#39;prb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prb96_n.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">][</span><span class="s1">&#39;plt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plt96_n.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">][</span><span class="s1">&#39;pls&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plsx8_n.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">][</span><span class="s1">&#39;prs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prsx8_n.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">][</span><span class="s1">&#39;fis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sxrfilD1.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">][</span><span class="s1">&#39;brs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;brs05360.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">][</span><span class="s1">&#39;ccd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ccd96_n.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;O&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>    <span class="c1">#8</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;O&quot;</span><span class="p">][</span><span class="s1">&#39;acd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;acd96_o.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;O&quot;</span><span class="p">][</span><span class="s1">&#39;scd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;scd96_o.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;O&quot;</span><span class="p">][</span><span class="s1">&#39;ccd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ccd89_o.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;O&quot;</span><span class="p">][</span><span class="s1">&#39;prb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prb96_o.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;O&quot;</span><span class="p">][</span><span class="s1">&#39;plt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plt96_o.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;O&quot;</span><span class="p">][</span><span class="s1">&#39;pls&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plsx5_o.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;O&quot;</span><span class="p">][</span><span class="s1">&#39;prs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prsx5_o.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;F&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>    <span class="c1">#9</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;F&quot;</span><span class="p">][</span><span class="s1">&#39;acd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;acd89_f.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;F&quot;</span><span class="p">][</span><span class="s1">&#39;scd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;scd89_f.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;F&quot;</span><span class="p">][</span><span class="s1">&#39;ccd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ccd89_f.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;F&quot;</span><span class="p">][</span><span class="s1">&#39;prb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prb89_f.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;F&quot;</span><span class="p">][</span><span class="s1">&#39;plt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plt89_f.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;F&quot;</span><span class="p">][</span><span class="s1">&#39;fis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sxrfil14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;F&quot;</span><span class="p">][</span><span class="s1">&#39;brs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;brs05360.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;F&quot;</span><span class="p">][</span><span class="s1">&#39;pls&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pls_F_14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;F&quot;</span><span class="p">][</span><span class="s1">&#39;prs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prs_F_14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;F&quot;</span><span class="p">][</span><span class="s1">&#39;prc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prc89_f.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ne&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>   <span class="c1">#10</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ne&quot;</span><span class="p">][</span><span class="s1">&#39;acd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;acd96_ne.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ne&quot;</span><span class="p">][</span><span class="s1">&#39;scd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;scd96_ne.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ne&quot;</span><span class="p">][</span><span class="s1">&#39;prb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prb96_ne.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ne&quot;</span><span class="p">][</span><span class="s1">&#39;plt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plt96_ne.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ne&quot;</span><span class="p">][</span><span class="s1">&#39;ccd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ccd89_ne.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ne&quot;</span><span class="p">][</span><span class="s1">&#39;prc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prc89_ne.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ne&quot;</span><span class="p">][</span><span class="s1">&#39;pls&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plsx8_ne.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ne&quot;</span><span class="p">][</span><span class="s1">&#39;prs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prsx8_ne.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ne&quot;</span><span class="p">][</span><span class="s1">&#39;fis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sxrfilD1.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ne&quot;</span><span class="p">][</span><span class="s1">&#39;brs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;brs05360.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Al&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>    <span class="c1">#13</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Al&quot;</span><span class="p">][</span><span class="s1">&#39;acd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;acd00_al.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Al&quot;</span><span class="p">][</span><span class="s1">&#39;scd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;scd00_al.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Al&quot;</span><span class="p">][</span><span class="s1">&#39;prb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prb00_al.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Al&quot;</span><span class="p">][</span><span class="s1">&#39;plt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plt00_al.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Al&quot;</span><span class="p">][</span><span class="s1">&#39;ccd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ccd89_al.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Al&quot;</span><span class="p">][</span><span class="s1">&#39;prc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prc89_al.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Al&quot;</span><span class="p">][</span><span class="s1">&#39;pls&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pls_Al_14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Al&quot;</span><span class="p">][</span><span class="s1">&#39;prs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prs_Al_14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Al&quot;</span><span class="p">][</span><span class="s1">&#39;fis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sxrfil14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Al&quot;</span><span class="p">][</span><span class="s1">&#39;brs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;brs05360.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Si&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>     <span class="c1">#14</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Si&quot;</span><span class="p">][</span><span class="s1">&#39;acd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;acd00_si.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Si&quot;</span><span class="p">][</span><span class="s1">&#39;scd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;scd00_si.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Si&quot;</span><span class="p">][</span><span class="s1">&#39;prb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prb00_si.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Si&quot;</span><span class="p">][</span><span class="s1">&#39;plt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plt97_si.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Si&quot;</span><span class="p">][</span><span class="s1">&#39;pls&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pls_Si_14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Si&quot;</span><span class="p">][</span><span class="s1">&#39;prs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prs_Si_14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Si&quot;</span><span class="p">][</span><span class="s1">&#39;fis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sxrfil14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Si&quot;</span><span class="p">][</span><span class="s1">&#39;brs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;brs05360.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Si&quot;</span><span class="p">][</span><span class="s1">&#39;ccd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ccd89_si.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ar&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>     <span class="c1">#18</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ar&quot;</span><span class="p">][</span><span class="s1">&#39;acd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;acd00_ar.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ar&quot;</span><span class="p">][</span><span class="s1">&#39;scd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;scd00_ar.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ar&quot;</span><span class="p">][</span><span class="s1">&#39;prb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prb00_ar.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ar&quot;</span><span class="p">][</span><span class="s1">&#39;plt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plt00_ar.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ar&quot;</span><span class="p">][</span><span class="s1">&#39;ccd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ccd89_ar.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ar&quot;</span><span class="p">][</span><span class="s1">&#39;prc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prc89_ar.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ar&quot;</span><span class="p">][</span><span class="s1">&#39;pls&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pls_Ar_14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ar&quot;</span><span class="p">][</span><span class="s1">&#39;prs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prs_Ar_14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ar&quot;</span><span class="p">][</span><span class="s1">&#39;fis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sxrfil14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ar&quot;</span><span class="p">][</span><span class="s1">&#39;brs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;brs05360.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ca&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>     <span class="c1">#20</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ca&quot;</span><span class="p">][</span><span class="s1">&#39;acd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;acd85_ca.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ca&quot;</span><span class="p">][</span><span class="s1">&#39;scd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;scd85_ca.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ca&quot;</span><span class="p">][</span><span class="s1">&#39;ccd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ccd89_w.dat&quot;</span>  <span class="c1"># file not available, use first 20 ion stages using Foster scaling</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ca&quot;</span><span class="p">][</span><span class="s1">&#39;prb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prb85_ca.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ca&quot;</span><span class="p">][</span><span class="s1">&#39;plt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plt85_ca.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ca&quot;</span><span class="p">][</span><span class="s1">&#39;pls&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pls_Ca_14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ca&quot;</span><span class="p">][</span><span class="s1">&#39;prs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prs_Ca_14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ca&quot;</span><span class="p">][</span><span class="s1">&#39;fis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sxrfil14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ca&quot;</span><span class="p">][</span><span class="s1">&#39;brs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;brs05360.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Fe&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>     <span class="c1">#26</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Fe&quot;</span><span class="p">][</span><span class="s1">&#39;acd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;acd89_fe.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Fe&quot;</span><span class="p">][</span><span class="s1">&#39;scd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;scd89_fe.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Fe&quot;</span><span class="p">][</span><span class="s1">&#39;prb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prb89_fe.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Fe&quot;</span><span class="p">][</span><span class="s1">&#39;plt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plt89_fe.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Fe&quot;</span><span class="p">][</span><span class="s1">&#39;pls&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pls_Fe_14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Fe&quot;</span><span class="p">][</span><span class="s1">&#39;prs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prs_Fe_14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Fe&quot;</span><span class="p">][</span><span class="s1">&#39;fis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sxrfil14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Fe&quot;</span><span class="p">][</span><span class="s1">&#39;brs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;brs05360.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Fe&quot;</span><span class="p">][</span><span class="s1">&#39;ccd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ccd89_fe.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ni&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>     <span class="c1">#28</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ni&quot;</span><span class="p">][</span><span class="s1">&#39;acd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;acd00_ni.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ni&quot;</span><span class="p">][</span><span class="s1">&#39;scd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;scd00_ni.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ni&quot;</span><span class="p">][</span><span class="s1">&#39;prb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prb00_ni.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ni&quot;</span><span class="p">][</span><span class="s1">&#39;plt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plt00_ni.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ni&quot;</span><span class="p">][</span><span class="s1">&#39;pls&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pls_Ni_14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ni&quot;</span><span class="p">][</span><span class="s1">&#39;prs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prs_Ni_14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ni&quot;</span><span class="p">][</span><span class="s1">&#39;fis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sxrfil14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ni&quot;</span><span class="p">][</span><span class="s1">&#39;brs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;brs05360.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ni&quot;</span><span class="p">][</span><span class="s1">&#39;ccd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ccd89_ni.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Kr&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>     <span class="c1">#36</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Kr&quot;</span><span class="p">][</span><span class="s1">&#39;acd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;acd89_kr.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Kr&quot;</span><span class="p">][</span><span class="s1">&#39;scd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;scd89_kr.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Kr&quot;</span><span class="p">][</span><span class="s1">&#39;ccd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ccd89_kr.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Kr&quot;</span><span class="p">][</span><span class="s1">&#39;prb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prb89_kr.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Kr&quot;</span><span class="p">][</span><span class="s1">&#39;plt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plt89_kr.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Kr&quot;</span><span class="p">][</span><span class="s1">&#39;pls&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plsx5_kr.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Kr&quot;</span><span class="p">][</span><span class="s1">&#39;prs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prsx5_kr.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Mo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>     <span class="c1">#42</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Mo&quot;</span><span class="p">][</span><span class="s1">&#39;acd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;acd89_mo.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Mo&quot;</span><span class="p">][</span><span class="s1">&#39;scd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;scd89_mo.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Mo&quot;</span><span class="p">][</span><span class="s1">&#39;ccd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ccd89_mo.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Mo&quot;</span><span class="p">][</span><span class="s1">&#39;plt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plt89_mo.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Mo&quot;</span><span class="p">][</span><span class="s1">&#39;prb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prb89_mo.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Mo&quot;</span><span class="p">][</span><span class="s1">&#39;prc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prc89_mo.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Xe&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>     <span class="c1">#56</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Xe&quot;</span><span class="p">][</span><span class="s1">&#39;acd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;acd89_xe.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Xe&quot;</span><span class="p">][</span><span class="s1">&#39;scd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;scd89_xe.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Xe&quot;</span><span class="p">][</span><span class="s1">&#39;ccd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ccd89_xe.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Xe&quot;</span><span class="p">][</span><span class="s1">&#39;plt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plt89_xe.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Xe&quot;</span><span class="p">][</span><span class="s1">&#39;prb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prb89_xe.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Xe&quot;</span><span class="p">][</span><span class="s1">&#39;prs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prsx1_xe.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Xe&quot;</span><span class="p">][</span><span class="s1">&#39;pls&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prsx1_xe.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Xe&quot;</span><span class="p">][</span><span class="s1">&#39;prc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prc89_xe.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;W&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>     <span class="c1">#74</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;W&quot;</span><span class="p">][</span><span class="s1">&#39;acd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;acd89_w.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;W&quot;</span><span class="p">][</span><span class="s1">&#39;scd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;scd89_w.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;W&quot;</span><span class="p">][</span><span class="s1">&#39;prb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prb89_w.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;W&quot;</span><span class="p">][</span><span class="s1">&#39;plt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plt89_w.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;W&quot;</span><span class="p">][</span><span class="s1">&#39;fis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sxrfil14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;W&quot;</span><span class="p">][</span><span class="s1">&#39;brs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;brs05360.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;W&quot;</span><span class="p">][</span><span class="s1">&#39;pls&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pls_W_14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;W&quot;</span><span class="p">][</span><span class="s1">&#39;prs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prs_W_14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;W&quot;</span><span class="p">][</span><span class="s1">&#39;ccd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ccd89_w.dat&quot;</span>

    <span class="k">return</span> <span class="n">files</span></div>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">aurora</a></h1>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../aurora.html">aurora package</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, F.Sciortino.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.2.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>