

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>aurora.atomic &mdash; aurora 1.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> aurora
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../aurora.html">aurora package</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">aurora</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>aurora.atomic</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for aurora.atomic</h1><div class="highlight"><pre>
<span></span><span class="c1">#-*-Python-*-</span>
<span class="c1"># Created by sciortinof at 05 Feb 2020  14:59</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">RectBivariateSpline</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">scipy.ndimage</span>
<span class="kn">from</span> <span class="nn">scipy.linalg</span> <span class="kn">import</span> <span class="n">svd</span>
<span class="kn">from</span> <span class="nn">IPython</span> <span class="kn">import</span> <span class="n">embed</span>
<span class="kn">from</span> <span class="nn">scipy.constants</span> <span class="kn">import</span> <span class="n">m_p</span><span class="p">,</span> <span class="n">e</span> <span class="k">as</span> <span class="n">q_electron</span>


<div class="viewcode-block" id="get_file_types"><a class="viewcode-back" href="../../aurora.html#aurora.atomic.get_file_types">[docs]</a><span class="k">def</span> <span class="nf">get_file_types</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;Returns main types of ADAS atomic data of interest &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;acd&#39;</span><span class="p">:</span><span class="s1">&#39;recombination&#39;</span><span class="p">,</span>
            <span class="s1">&#39;scd&#39;</span><span class="p">:</span><span class="s1">&#39;ionization&#39;</span><span class="p">,</span>
            <span class="s1">&#39;prb&#39;</span><span class="p">:</span><span class="s1">&#39;continuum radiation&#39;</span><span class="p">,</span>
            <span class="s1">&#39;plt&#39;</span><span class="p">:</span><span class="s1">&#39;line radiation&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ccd&#39;</span><span class="p">:</span><span class="s1">&#39;thermal charge exchange&#39;</span><span class="p">,</span>
            <span class="s1">&#39;prc&#39;</span><span class="p">:</span><span class="s1">&#39;thermal charge exchange continuum radiation&#39;</span><span class="p">,</span>
            <span class="s1">&#39;pls&#39;</span><span class="p">:</span><span class="s1">&#39;line radiation in sxr range&#39;</span><span class="p">,</span>
            <span class="s1">&#39;prs&#39;</span><span class="p">:</span><span class="s1">&#39;continuum radiation in sxr range&#39;</span><span class="p">,</span>
            <span class="s1">&#39;brs&#39;</span><span class="p">:</span><span class="s1">&#39;continuum spectral bremstrahlung&#39;</span><span class="p">,</span>
            <span class="s1">&#39;fis&#39;</span><span class="p">:</span><span class="s1">&#39;sensitivity of sxr&#39;</span><span class="p">}</span></div>


<div class="viewcode-block" id="get_atomdat_info"><a class="viewcode-back" href="../../aurora.html#aurora.atomic.get_atomdat_info">[docs]</a><span class="k">def</span> <span class="nf">get_atomdat_info</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;Function to identify location of ADAS atomic data in a generalized fashion</span>
<span class="sd">    and to obtain the list of file_types of interest.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="s1">&#39;STRAHL_DIR&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">:</span>
        <span class="c1"># STRAHL_DIR env variable can in principle be used by user to point to a personal installation</span>
        <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;STRAHL_DIR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;HOME&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;/strahl&#39;</span>

    <span class="c1"># Define hierarchy of directories that should be searched in order</span>
    <span class="n">paths</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;HOME&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;/atomlib/atomdat_master/newdat/&#39;</span><span class="p">,</span>
             <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;HOME&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;/atomAI/atomdat_master/newdat/&#39;</span><span class="p">,</span>
             <span class="s1">&#39;/fusion/projects/codes/strahl/</span><span class="si">{}</span><span class="s1">/intel-18/strahl20/atomdat/newdat/&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;USER&#39;</span><span class="p">]),</span>
             <span class="s1">&#39;/fusion/projects/codes/strahl/</span><span class="si">{}</span><span class="s1">/strahl/atomdat/newdat/&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;USER&#39;</span><span class="p">]),</span>
             <span class="s1">&#39;/fusion/projects/codes/strahl/public20/atomdat/newdat/&#39;</span><span class="p">,</span>
             <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;STRAHL_DIR&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;/atomdat/newdat/&#39;</span><span class="p">,</span>
             <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;HOME&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;/strahl/atomdat/newdat/&#39;</span><span class="p">,</span>
             <span class="s1">&#39;&#39;</span><span class="p">]</span>
    
    <span class="k">for</span> <span class="n">atomdat_dir</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">atomdat_dir</span><span class="p">):</span>
            <span class="k">break</span>

    <span class="k">return</span> <span class="n">atomdat_dir</span></div>



<div class="viewcode-block" id="adas_file"><a class="viewcode-back" href="../../aurora.html#aurora.atomic.adas_file">[docs]</a><span class="k">class</span> <span class="nc">adas_file</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;Read ADAS file in ADF11 format over the given ne, T. &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">filepath</span> <span class="o">=</span> <span class="n">filepath</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="o">=</span><span class="n">filepath</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;brs&#39;</span><span class="p">,</span><span class="s1">&#39;sxr&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">imp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># get data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>

        <span class="c1"># settings for plotting</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_ion</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ncol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_ion</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nrow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_ion</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">ncol</span><span class="p">)</span>


<div class="viewcode-block" id="adas_file.load"><a class="viewcode-back" href="../../aurora.html#aurora.atomic.adas_file.load">[docs]</a>    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">header</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="n">n_ions</span><span class="p">,</span> <span class="n">n_ne</span><span class="p">,</span> <span class="n">n_T</span> <span class="o">=</span> <span class="n">header</span><span class="o">.</span><span class="n">split</span><span class="p">()[:</span><span class="mi">3</span><span class="p">]</span>
            <span class="n">details</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">header</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">3</span><span class="p">:])</span>

            <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>

            <span class="n">n_ions</span><span class="p">,</span><span class="n">n_ne</span><span class="p">,</span><span class="n">n_T</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n_ions</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">n_ne</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">n_T</span><span class="p">)</span>
            <span class="n">logT</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">logNe</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">logNe</span><span class="p">)</span><span class="o">&lt;</span> <span class="n">n_ne</span><span class="p">:</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                <span class="n">logNe</span> <span class="o">=</span> <span class="n">logNe</span><span class="o">+</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()]</span>
            <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">logT</span><span class="p">)</span><span class="o">&lt;</span> <span class="n">n_T</span><span class="p">:</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                <span class="n">logT</span> <span class="o">=</span> <span class="n">logT</span><span class="o">+</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()]</span>

            <span class="n">logT</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">logT</span><span class="p">)</span>
            <span class="n">logNe</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">logNe</span><span class="p">)</span>

            <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i_ion</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_ions</span><span class="p">):</span>
                <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                <span class="n">plsx</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">plsx</span><span class="p">)</span><span class="o">&lt;</span> <span class="n">n_ne</span><span class="o">*</span><span class="n">n_T</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                    <span class="n">plsx</span> <span class="o">=</span> <span class="n">plsx</span><span class="o">+</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">L</span><span class="p">)</span> <span class="k">for</span> <span class="n">L</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()]</span>
                <span class="n">plsx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">plsx</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_T</span><span class="p">,</span> <span class="n">n_ne</span><span class="p">)</span>
                <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">plsx</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logNe</span> <span class="o">=</span> <span class="n">logNe</span><span class="p">;</span> <span class="bp">self</span><span class="o">.</span><span class="n">logT</span> <span class="o">=</span> <span class="n">logT</span><span class="p">;</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></div>


<div class="viewcode-block" id="adas_file.plot"><a class="viewcode-back" href="../../aurora.html#aurora.atomic.adas_file.plot">[docs]</a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">axes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span><span class="p">,</span><span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ncol</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nrow</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">axes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span>
        <span class="n">colormap</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">rainbow</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="o">+</span><span class="s1">&#39;  &#39;</span><span class="o">+</span> <span class="n">get_file_types</span><span class="p">()[</span><span class="bp">self</span><span class="o">.</span><span class="n">file_type</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_ion</span><span class="p">:</span> <span class="k">break</span>
            <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">,:,:]</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">):</span> <span class="c1">#independent of density</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">,:,</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_prop_cycle</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="n">colormap</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">])))</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_type</span> <span class="o">!=</span> <span class="s1">&#39;brs&#39;</span><span class="p">:</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;scd&#39;</span><span class="p">,</span><span class="s1">&#39;prs&#39;</span><span class="p">,</span><span class="s1">&#39;ccd&#39;</span><span class="p">,</span><span class="s1">&#39;prb&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="n">i</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">imp</span><span class="o">+</span><span class="s1">&#39;$^{</span><span class="si">%d</span><span class="s1">\!+}$&#39;</span><span class="o">%</span> <span class="p">(</span><span class="n">charge</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>   <span class="c1"># check?</span>

        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$\log T_e\ \mathrm{[eV]}$&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;scd&#39;</span><span class="p">,</span><span class="s1">&#39;acd&#39;</span><span class="p">,</span><span class="s1">&#39;ccd&#39;</span><span class="p">]:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$\log(&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">file_type</span><span class="o">+</span><span class="s1">&#39;)\ \mathrm{[cm^3/s]}$&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;prb&#39;</span><span class="p">,</span><span class="s1">&#39;plt&#39;</span><span class="p">,</span><span class="s1">&#39;prc&#39;</span><span class="p">,</span><span class="s1">&#39;pls&#39;</span><span class="p">,</span><span class="s1">&#39;brs&#39;</span><span class="p">,</span><span class="s1">&#39;prs&#39;</span><span class="p">]:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$\log(&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">file_type</span><span class="o">+</span><span class="s1">&#39;)\ \mathrm{[W\cdot cm^3]}$&#39;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="get_atom_data"><a class="viewcode-back" href="../../aurora.html#aurora.atomic.get_atom_data">[docs]</a><span class="k">def</span> <span class="nf">get_atom_data</span><span class="p">(</span><span class="n">imp</span><span class="p">,</span> <span class="n">filetypes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;acd&#39;</span><span class="p">,</span><span class="s1">&#39;scd&#39;</span><span class="p">],</span> <span class="n">filenames</span><span class="o">=</span><span class="p">[]):</span>
    <span class="sd">&#39;&#39;&#39; Collect atomic data for a given impurity from all types of ADAS files available or</span>
<span class="sd">    for only those requested. </span>

<span class="sd">    Args:</span>
<span class="sd">        imp : str</span>
<span class="sd">            Atomic symbol of impurity ion.</span>
<span class="sd">        filetypes : list or array-like </span>
<span class="sd">            ADAS file types to be fetched. Default is [&quot;acd&quot;,&quot;scd&quot;] for effective ionization </span>
<span class="sd">            and recombination rates (excluding CX).</span>
<span class="sd">        filenames : list or array-like, optional</span>
<span class="sd">            ADAS file names to be used in place of the defaults given by </span>
<span class="sd">            :py:meth:`~aurora.atomic.adas_file_dict`.</span>
<span class="sd">            If left empty, such defaults are used. Note that the order of filenames must be </span>
<span class="sd">            the same as the one in the &quot;filetypes&quot; list.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        atom_data : dict</span>
<span class="sd">           Dictionary containing data for each of the requested files. </span>
<span class="sd">           Each entry of the dictionary gives log-10 of ne, log-10 of Te and log-10 of the data</span>
<span class="sd">           as attributes atom_data[key].logNe, atom_data[key].logT, atom_data[key].data</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">atom_data</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">if</span> <span class="n">filenames</span><span class="p">:</span>
        <span class="n">files</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">ii</span><span class="p">,</span><span class="n">typ</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">filetypes</span><span class="p">):</span>
            <span class="n">files</span><span class="p">[</span><span class="n">typ</span><span class="p">]</span> <span class="o">=</span> <span class="n">filenames</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># get dictionary containing default list of ADAS atomic files</span>
        <span class="n">def_adas_files_dict</span> <span class="o">=</span> <span class="n">adas_files_dict</span><span class="p">()</span>
        <span class="n">files</span> <span class="o">=</span> <span class="n">def_adas_files_dict</span><span class="p">[</span><span class="n">imp</span><span class="p">]</span>

    <span class="n">atomdat_dir</span> <span class="o">=</span> <span class="n">get_atomdat_info</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">filetype</span> <span class="ow">in</span> <span class="n">filetypes</span><span class="p">:</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">files</span><span class="p">[</span><span class="n">filetype</span><span class="p">]</span>

        <span class="c1"># load specific file and add it to output dictionary</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">adas_file</span><span class="p">(</span><span class="n">atomdat_dir</span><span class="o">+</span><span class="n">filename</span><span class="p">)</span>
        <span class="n">atom_data</span><span class="p">[</span><span class="n">filetype</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">logNe</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">logT</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">data</span>

    <span class="k">return</span> <span class="n">atom_data</span></div>


<div class="viewcode-block" id="read_adf15"><a class="viewcode-back" href="../../aurora.html#aurora.atomic.read_adf15">[docs]</a><span class="k">def</span> <span class="nf">read_adf15</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Te_max</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ne_max</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">plot_log</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">plot_3d</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
               <span class="n">recomb</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
               <span class="n">pec_plot_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="n">pec_plot_max</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">plot_lines</span><span class="o">=</span><span class="p">[]):</span>
    <span class="sd">&quot;&quot;&quot;Read photon emissivity coefficients from an ADF15 file.</span>

<span class="sd">    Returns a dictionary whose keys are the wavelengths of the lines in</span>
<span class="sd">    angstroms. The value is an interp2d instance that will evaluate the PEC at</span>
<span class="sd">    a desired dens, temp.</span>

<span class="sd">    Args:</span>
<span class="sd">        path : str</span>
<span class="sd">            Path to adf15 file to read.</span>
<span class="sd">        order : int, opt</span>
<span class="sd">            Parameter to control the order of interpolation.</span>
<span class="sd">        recomb : bool, opt</span>
<span class="sd">            If True, fetch recombination contributions to available lines. If False,</span>
<span class="sd">            fetch only ionization contributions.</span>

<span class="sd">        To plot PEC data:</span>
<span class="sd">        </span>
<span class="sd">        plot_lines : list</span>
<span class="sd">            List of lines whose PEC data should be displayed. Lines should be identified</span>
<span class="sd">            by their wavelengths. The list of available wavelengths in a given file can be retrieved</span>
<span class="sd">            by first running this function ones, checking dictionary keys, and then requesting a</span>
<span class="sd">            plot of one (or more) of them.</span>
<span class="sd">        plot_log : bool</span>
<span class="sd">            When plotting, set a log scale</span>
<span class="sd">        plot_3d : bool</span>
<span class="sd">            Display PEC data as a 3D plot rather than a 2D one.</span>
<span class="sd">        pec_plot_min : float</span>
<span class="sd">            Minimum value of PEC to visualize in a plot</span>
<span class="sd">        pec_plot_max : float</span>
<span class="sd">            Maximum value of PEC to visualize in a plot</span>
<span class="sd">        ax : matplotlib axes instance</span>
<span class="sd">            If not None, plot on this set of axes</span>
<span class="sd">        Te_max : float</span>
<span class="sd">            Maximum Te value to plot when len(plot_lines)&gt;1</span>
<span class="sd">        ne_max : float</span>
<span class="sd">            Maximum ne value to plot when len(plot_lines)&gt;1</span>

<span class="sd">    Returns:</span>
<span class="sd">        pec_dict : dict</span>
<span class="sd">            Dictionary containing interpolation functions for each of the available lines of the</span>
<span class="sd">            indicated type (ionization or recombination). Each interpolation function takes as arguments</span>
<span class="sd">            the log-10 of ne and Te.</span>

<span class="sd">    MWE:</span>
<span class="sd">        path=&#39;/home/sciortino/atomlib/atomdat_master/adf15/h/pju#h0.dat&#39;</span>
<span class="sd">        pec = read_adf15(path, recomb=False)</span>
<span class="sd">        pec = read_adf15(path, plot_lines=[list(pec.keys())[0]], recomb=False)</span>

<span class="sd">    This function should work with PEC files produced via adas810 or adas218.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">plot_3d</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="n">cs</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.dat&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">header</span> <span class="o">=</span> <span class="n">lines</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="c1"># Get the expected number of lines by reading the header:</span>
    <span class="n">num_lines</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">header</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">pec_dict</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_lines</span><span class="p">):</span>
        <span class="c1"># Get the wavelength, number of densities and number of temperatures</span>
        <span class="c1"># from the first line of the entry:</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">lines</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">header</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>

        <span class="c1"># sometimes the wavelength and its units are not separated. Rough solution:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1">#header = np.concatenate( [hh.split(&#39;A&#39;)[0] for hh in header])</span>
            <span class="n">header</span> <span class="o">=</span> <span class="p">[</span><span class="n">hh</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">hh</span> <span class="ow">in</span> <span class="n">header</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="c1"># lam and A are separated. Delete &#39;A&#39; unit.</span>
            <span class="n">header</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">header</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">lam</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="c1"># These lines appear to occur when lam has more digits than the</span>
            <span class="c1"># allowed field width. For the moment, ignore these.</span>
            <span class="n">lam</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">recomb</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;recom&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">l</span><span class="o">.</span><span class="n">lower</span><span class="p">()):</span>
            <span class="n">lam</span><span class="o">=</span><span class="kc">None</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">recomb</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;excit&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">l</span><span class="o">.</span><span class="n">lower</span><span class="p">()):</span>
            <span class="n">lam</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">num_den</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">num_temp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="c1"># 2nd element was empty -- annoyingly, this happens sometimes</span>
            <span class="n">num_den</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="n">num_temp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>

        <span class="c1"># Get the densities:</span>
        <span class="n">dens</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">dens</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">num_den</span><span class="p">:</span>
            <span class="n">dens</span> <span class="o">+=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">lines</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()]</span>
        <span class="n">dens</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">dens</span><span class="p">)</span>

        <span class="c1"># Get the temperatures:</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">num_temp</span><span class="p">:</span>
            <span class="n">temp</span> <span class="o">+=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">lines</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()]</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>

        <span class="c1"># Get the PEC&#39;s:</span>
        <span class="n">PEC</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">PEC</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">num_den</span><span class="p">:</span>
            <span class="n">PEC</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
            <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">PEC</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">num_temp</span><span class="p">:</span>
                <span class="n">PEC</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">lines</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()]</span>
        <span class="n">PEC</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">PEC</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">lam</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">lam</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">pec_dict</span><span class="p">:</span>
                <span class="n">pec_dict</span><span class="p">[</span><span class="n">lam</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="n">pec_dict</span><span class="p">[</span><span class="n">lam</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">RectBivariateSpline</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">dens</span><span class="p">),</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">temp</span><span class="p">),</span>
                    <span class="n">PEC</span><span class="p">,</span>
                    <span class="n">kx</span><span class="o">=</span><span class="n">order</span><span class="p">,</span>
                    <span class="n">ky</span><span class="o">=</span><span class="n">order</span>
                <span class="p">)</span>
            <span class="p">)</span>

            <span class="c1"># {&#39;dens&#39;: dens, &#39;temp&#39;: temp, &#39;PEC&#39;: PEC}</span>
            <span class="k">if</span> <span class="n">lam</span> <span class="ow">in</span> <span class="n">plot_lines</span><span class="p">:</span>

                <span class="c1"># use log spacing for ne values</span>
                <span class="k">if</span> <span class="n">ne_max</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="c1"># avoid overflow inside of np.logspace</span>
                    <span class="n">ne_eval</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">dens</span><span class="o">.</span><span class="n">min</span><span class="p">()),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">ne_max</span><span class="p">),</span> <span class="mi">10</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ne_eval</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">dens</span><span class="o">.</span><span class="n">min</span><span class="p">()),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">dens</span><span class="o">.</span><span class="n">max</span><span class="p">()),</span> <span class="mi">10</span><span class="p">)</span>
                    <span class="c1">#scipy.logspace(dens.min(), dens.max(), 10)</span>

                <span class="c1"># linear spacing for Te values</span>
                <span class="k">if</span> <span class="n">Te_max</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">Te_eval</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">temp</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">Te_max</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">Te_eval</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">temp</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">temp</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">100</span><span class="p">)</span>

                <span class="n">NE</span><span class="p">,</span> <span class="n">TE</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">ne_eval</span><span class="p">,</span> <span class="n">Te_eval</span><span class="p">)</span>
                <span class="n">PEC_eval</span> <span class="o">=</span> <span class="n">pec_dict</span><span class="p">[</span><span class="n">lam</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">ev</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">NE</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">TE</span><span class="p">))</span>

                <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">f1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">plot_3d</span><span class="p">:</span>
                        <span class="n">ax1</span> <span class="o">=</span> <span class="n">f1</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">ax1</span> <span class="o">=</span> <span class="n">f1</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ax1</span> <span class="o">=</span> <span class="n">ax</span>

                <span class="k">if</span> <span class="n">plot_3d</span><span class="p">:</span>

                    <span class="c1"># linear scales (log doesn&#39;t work in matplotlib 3D)</span>
                    <span class="c1"># but can do all plotting on log quantities</span>
                    <span class="k">if</span> <span class="n">plot_log</span><span class="p">:</span>
                        <span class="n">logNE</span><span class="p">,</span> <span class="n">logTE</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">ne_eval</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Te_eval</span><span class="p">))</span>
                        <span class="n">ax1</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">logNE</span><span class="p">,</span> <span class="n">logTE</span><span class="p">,</span> <span class="n">PEC_eval</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">ax1</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">NE</span><span class="p">,</span> <span class="n">TE</span><span class="p">,</span> <span class="n">PEC_eval</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">plot_log</span><span class="p">:</span>
                        <span class="n">dens</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">dens</span><span class="p">);</span> <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">Te_max</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">ne_max</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">DENS</span><span class="p">,</span> <span class="n">TEMP</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">dens</span><span class="p">,</span> <span class="n">temp</span><span class="p">)</span>
                        <span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">DENS</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">TEMP</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">PEC</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">Te_max</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">ne_max</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">Te_max_ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">temp</span> <span class="o">-</span> <span class="n">Te_max</span><span class="o">*</span><span class="mi">1000</span><span class="p">))</span>
                        <span class="n">DENS</span><span class="p">,</span> <span class="n">TEMP</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">dens</span><span class="p">,</span> <span class="n">temp</span><span class="p">[:</span><span class="n">Te_max_ind</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
                        <span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">DENS</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">TEMP</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">PEC</span><span class="p">[:,:</span><span class="n">Te_max_ind</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">Te_max</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">ne_max</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">ne_max_ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">dens</span> <span class="o">-</span> <span class="n">ne_max</span><span class="p">))</span>
                        <span class="n">DENS</span><span class="p">,</span> <span class="n">TEMP</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">dens</span><span class="p">[:</span><span class="n">ne_max_ind</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">temp</span><span class="p">)</span>
                        <span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">DENS</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">TEMP</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">PEC</span><span class="p">[:</span><span class="n">ne_max_ind</span><span class="o">+</span><span class="mi">1</span><span class="p">,:]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">Te_max</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">ne_max</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">Te_max_ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">temp</span> <span class="o">-</span> <span class="n">Te_max</span><span class="o">*</span><span class="mi">1000</span><span class="p">))</span>
                        <span class="n">ne_max_ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">dens</span> <span class="o">-</span> <span class="n">ne_max</span><span class="p">))</span>
                        <span class="n">DENS</span><span class="p">,</span> <span class="n">TEMP</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">dens</span><span class="p">[:</span><span class="n">ne_max_ind</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">temp</span><span class="p">[:</span><span class="n">Te_max_ind</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
                        <span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">DENS</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">TEMP</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">PEC</span><span class="p">[:</span><span class="n">ne_max_ind</span><span class="o">+</span><span class="mi">1</span><span class="p">,:</span><span class="n">Te_max_ind</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$n_e$ [cm$^{-3}$]&#39;</span><span class="p">)</span>
                        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$T_e$ [eV]&#39;</span><span class="p">)</span>

                        <span class="n">ax1</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;PEC&#39;</span><span class="p">)</span>
                        <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">cs</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39; --- $\lambda$ = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">lam</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39; A&#39;</span><span class="p">)</span>
                        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

                <span class="k">else</span><span class="p">:</span>

                    <span class="c1"># plot in 2D</span>
                    <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">{:.0e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ne</span><span class="p">)</span><span class="o">+</span><span class="sa">r</span><span class="s1">&#39; $cm^{-3}$&#39;</span> <span class="k">for</span> <span class="n">ne</span> <span class="ow">in</span> <span class="n">ne_eval</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">ine</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">PEC_eval</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Te_eval</span><span class="p">,</span> <span class="n">PEC_eval</span><span class="p">[:,</span><span class="n">ine</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">labels</span><span class="p">[</span><span class="n">ine</span><span class="p">])</span>
                    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$T_e$ [kev]&#39;</span><span class="p">)</span>
                    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;PEC&#39;</span><span class="p">)</span>
                    <span class="n">ax1</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">pec_plot_min</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">pec_plot_min</span><span class="p">,</span> <span class="n">ax1</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]])</span>
                    <span class="k">if</span> <span class="n">pec_plot_max</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pec_plot_max</span> <span class="p">])</span>

                    <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set_draggable</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">cs</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39; --- $\lambda$ = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">lam</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39; A&#39;</span><span class="p">)</span>


    <span class="k">return</span> <span class="n">pec_dict</span></div>



<div class="viewcode-block" id="null_space"><a class="viewcode-back" href="../../aurora.html#aurora.atomic.null_space">[docs]</a><span class="k">def</span> <span class="nf">null_space</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Find null space of matrix A &#39;&#39;&#39;</span>
    <span class="n">u</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">vh</span> <span class="o">=</span> <span class="n">svd</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">full_matrices</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">Q</span> <span class="o">=</span> <span class="n">vh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,:]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span>    <span class="c1"># -1 index is after infinite time/equilibration</span>
    <span class="c1"># return the smallest singular eigenvalue</span>
    <span class="k">return</span> <span class="n">Q</span><span class="p">,</span> <span class="n">s</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># matrix is singular, so last index is ~0</span></div>


<div class="viewcode-block" id="get_frac_abundances"><a class="viewcode-back" href="../../aurora.html#aurora.atomic.get_frac_abundances">[docs]</a><span class="k">def</span> <span class="nf">get_frac_abundances</span><span class="p">(</span><span class="n">atom_data</span><span class="p">,</span> <span class="n">ne_cm3</span><span class="p">,</span><span class="n">Te_eV</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n0_by_ne</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span> <span class="n">include_cx</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">rho</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">rho_lbl</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">compute_rates</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Calculate fractional abundances from ionization and recombination equilibrium.</span>
<span class="sd">    If include_cx=True, radiative recombination and thermal charge exchange are summed.</span>

<span class="sd">    Args:</span>
<span class="sd">        atom_data : dictionary of atomic ADAS files (only acd, scd are required; ccd is </span>
<span class="sd">            necessary only if include_cx=True</span>
<span class="sd">        ne_cm3 : float or array</span>
<span class="sd">            Electron density in units of cm^-3</span>
<span class="sd">        Te_eV : float or array, optional</span>
<span class="sd">            Electron temperature in units of eV. If left to None, the Te grid given in the </span>
<span class="sd">            atomic data is used.</span>
<span class="sd">        n0_by_ne: float or array, optional</span>
<span class="sd">            Ratio of background neutral hydrogen to electron density, used if include_cx=True. </span>
<span class="sd">        include_cx : bool</span>
<span class="sd">            If True, charge exchange with background thermal neutrals is included. </span>
<span class="sd">        plot : bool, optional</span>
<span class="sd">            Show fractional abundances as a function of ne,Te profiles parameterization.</span>
<span class="sd">        ax : matplotlib.pyplot Axes instance</span>
<span class="sd">            Axes on which to plot if plot=True. If False, it creates new axes</span>
<span class="sd">        rho : list or array, optional</span>
<span class="sd">            Vector of radial coordinates on which ne,Te (and possibly n0_by_ne) are given. </span>
<span class="sd">            This is only used for plotting, if given. </span>
<span class="sd">        rho_lbl: str, optional</span>
<span class="sd">            Label to be used for rho. If left to None, defaults to a general &quot;rho&quot;.</span>
<span class="sd">        ls : str, optional</span>
<span class="sd">            Line style for plots. Continuous lines are used by default. </span>
<span class="sd">        compute_rates : bool</span>
<span class="sd">            If True, compute rate coefficients for ionization/recombination equilibrium on top</span>
<span class="sd">            of fractional abundances (which should be the same regardless of the method used). </span>

<span class="sd">    Returns:</span>
<span class="sd">        logTe : array</span>
<span class="sd">            log10 of electron temperatures as a function of which the fractional abundances and</span>
<span class="sd">            rate coefficients are given.</span>
<span class="sd">        fz : array, (space,nZ)</span>
<span class="sd">            Fractional abundances across the same grid used by the input ne,Te values. </span>
<span class="sd">        rate_coeff : array, (space, nZ)</span>
<span class="sd">            Rate coefficients in units of [s^-1]. </span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">logTe</span><span class="p">,</span> <span class="n">logS</span><span class="p">,</span><span class="n">logR</span><span class="p">,</span><span class="n">logcx</span> <span class="o">=</span> <span class="n">get_cs_balance_terms</span><span class="p">(</span><span class="n">atom_data</span><span class="p">,</span><span class="n">ne_cm3</span><span class="p">,</span><span class="n">Te_eV</span><span class="p">,</span><span class="n">maxTe</span><span class="o">=</span><span class="mf">10e3</span><span class="p">,</span><span class="n">include_cx</span><span class="o">=</span><span class="n">include_cx</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">include_cx</span><span class="p">:</span>
        <span class="c1"># Get an effective recombination rate by summing radiative &amp; CX recombination rates</span>
        <span class="n">logR</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logaddexp</span><span class="p">(</span><span class="n">logR</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">n0_by_ne</span><span class="p">)[:,</span><span class="kc">None</span><span class="p">]</span> <span class="o">+</span><span class="n">logcx</span><span class="p">)</span>
        
    <span class="c1"># analytical formula for fractional abundance</span>
    <span class="n">rate_ratio</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">logTe</span><span class="p">)[:,</span><span class="kc">None</span><span class="p">],</span> <span class="n">logS</span><span class="o">-</span><span class="n">logR</span><span class="p">))</span>
    <span class="n">rate_ratio</span><span class="p">[</span><span class="n">rate_ratio</span><span class="o">&lt;-</span><span class="mf">10.</span><span class="p">]</span><span class="o">=-</span><span class="mf">10.</span>  <span class="c1"># to avoid underflow in exponential</span>
    <span class="n">fz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">rate_ratio</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">fz</span> <span class="o">/=</span> <span class="n">fz</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">)[:,</span><span class="kc">None</span><span class="p">]</span>
    
    <span class="k">if</span> <span class="n">compute_rates</span><span class="p">:</span>
        <span class="c1"># numerical method which calculates also rate_coeff</span>
        <span class="n">nion</span> <span class="o">=</span> <span class="n">logR</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">fz</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">logTe</span><span class="o">.</span><span class="n">size</span><span class="p">,</span><span class="n">nion</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">rate_coeff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">logTe</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">it</span><span class="p">,</span><span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">logTe</span><span class="p">):</span>

            <span class="n">A</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">logS</span><span class="p">[</span><span class="n">it</span><span class="p">]),</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">logS</span><span class="p">[</span><span class="n">it</span><span class="p">]),</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span>\
                <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">logR</span><span class="p">[</span><span class="n">it</span><span class="p">]),</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">logR</span><span class="p">[</span><span class="n">it</span><span class="p">])])</span>
            
            <span class="n">N</span><span class="p">,</span><span class="n">rate_coeff</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">null_space</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
            <span class="n">fz</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">N</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="n">rate_coeff</span><span class="o">*=</span><span class="p">(</span><span class="n">ne_cm3</span> <span class="o">*</span> <span class="mf">1e-6</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>
        <span class="c1"># plot fractional abundances</span>
        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span><span class="p">,</span><span class="n">axx</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">axx</span> <span class="o">=</span> <span class="n">ax</span>

        <span class="k">if</span> <span class="n">rho</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="n">logTe</span>
            <span class="n">axx</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;T$_e$ [eV]&#39;</span><span class="p">)</span>
            <span class="n">axx</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">rho_lbl</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">rho_lbl</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\rho$&#39;</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">rho</span>
            <span class="n">axx</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">rho_lbl</span><span class="p">)</span>

        <span class="n">axx</span><span class="o">.</span><span class="n">set_prop_cycle</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">,</span><span class="n">cm</span><span class="o">.</span><span class="n">plasma</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">fz</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span>
        <span class="n">axx</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">fz</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="n">ls</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fz</span><span class="o">.</span><span class="n">T</span><span class="p">)):</span>
            <span class="n">imax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">fz</span><span class="p">[:,</span><span class="n">i</span><span class="p">])</span>
            <span class="n">axx</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="mf">0.05</span><span class="p">,</span><span class="n">x</span><span class="p">[</span><span class="n">imax</span><span class="p">]]),</span> <span class="n">fz</span><span class="p">[</span><span class="n">imax</span><span class="p">,</span><span class="n">i</span><span class="p">],</span> <span class="n">i</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">clip_on</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">axx</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
        <span class="n">axx</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.05</span><span class="p">)</span>
        <span class="n">axx</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">axx</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Fractional abundances&#39;</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">axx</span> <span class="o">=</span> <span class="kc">None</span>    

    <span class="k">if</span> <span class="n">compute_rates</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">logTe</span><span class="p">,</span> <span class="n">fz</span><span class="p">,</span> <span class="n">rate_coeff</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">logTe</span><span class="p">,</span> <span class="n">fz</span></div>





<div class="viewcode-block" id="get_cs_balance_terms"><a class="viewcode-back" href="../../aurora.html#aurora.atomic.get_cs_balance_terms">[docs]</a><span class="k">def</span> <span class="nf">get_cs_balance_terms</span><span class="p">(</span><span class="n">atom_data</span><span class="p">,</span> <span class="n">ne_cm3</span><span class="o">=</span><span class="mf">5e13</span><span class="p">,</span> <span class="n">Te_eV</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">maxTe</span><span class="o">=</span><span class="mf">10e3</span><span class="p">,</span> <span class="n">include_cx</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Get S, R and cx on the same logTe grid. </span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        atom_data : dictionary of atomic ADAS files (only acd, scd are required; ccd is </span>
<span class="sd">            necessary only if include_cx=True</span>
<span class="sd">        ne_cm3 : float or array</span>
<span class="sd">            Electron density in units of cm^-3</span>
<span class="sd">        Te_eV : float or array</span>
<span class="sd">            Electron temperature in units of eV. If left to None, the Te grid</span>
<span class="sd">            given in the atomic data is used.</span>
<span class="sd">        maxTe : float</span>
<span class="sd">            Maximum temperature of interest; only used if Te is left to None. </span>
<span class="sd">        include_cx : bool</span>
<span class="sd">            If True, obtain charge exchange terms as well. </span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        logTe : array (n_Te)</span>
<span class="sd">            log10 Te grid on which atomic rates are given</span>
<span class="sd">        logS, logR (,logcx): arrays (n_ne,n_Te)</span>
<span class="sd">            atomic rates for effective ionization, radiative+dielectronic</span>
<span class="sd">            recombination (+ charge exchange, if requested). After exponentiation, all terms</span>
<span class="sd">            will be in units of s^-1. </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">Te_eV</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># find smallest Te grid from all files</span>
        <span class="n">logne1</span><span class="p">,</span> <span class="n">logTe1</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">atom_data</span><span class="p">[</span><span class="s1">&#39;scd&#39;</span><span class="p">]</span>  <span class="c1"># ionization</span>
        <span class="n">logne2</span><span class="p">,</span> <span class="n">logTe2</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">atom_data</span><span class="p">[</span><span class="s1">&#39;acd&#39;</span><span class="p">]</span>  <span class="c1"># radiative recombination</span>

        <span class="n">minTe</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">logTe1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">logTe2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">maxTe</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">maxTe</span><span class="p">)</span><span class="c1"># don&#39;t go further than some given temperature keV</span>
        <span class="n">maxTe</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">maxTe</span><span class="p">,</span><span class="n">logTe1</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">logTe2</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>  <span class="c1"># avoid extrapolation</span>

        <span class="k">if</span> <span class="n">include_cx</span><span class="p">:</span>
            <span class="n">logne3</span><span class="p">,</span> <span class="n">logTe3</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">atom_data</span><span class="p">[</span><span class="s1">&#39;ccd&#39;</span><span class="p">]</span>  <span class="c1"># thermal cx recombination</span>
            <span class="n">minTe</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">minTe</span><span class="p">,</span><span class="n">logTe3</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">maxTe</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">maxTe</span><span class="p">,</span><span class="n">logTe3</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>  <span class="c1"># avoid extrapolation</span>

        <span class="n">logTe</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">minTe</span><span class="p">,</span><span class="n">maxTe</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">logTe</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Te_eV</span><span class="p">)</span>

    <span class="n">logne</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">ne_cm3</span><span class="p">)</span>

    <span class="n">logS</span> <span class="o">=</span> <span class="n">interp_atom_prof</span><span class="p">(</span><span class="n">atom_data</span><span class="p">[</span><span class="s1">&#39;scd&#39;</span><span class="p">],</span><span class="n">logne</span><span class="p">,</span> <span class="n">logTe</span><span class="p">,</span><span class="n">log_val</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">x_multiply</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">logR</span> <span class="o">=</span> <span class="n">interp_atom_prof</span><span class="p">(</span><span class="n">atom_data</span><span class="p">[</span><span class="s1">&#39;acd&#39;</span><span class="p">],</span><span class="n">logne</span><span class="p">,</span> <span class="n">logTe</span><span class="p">,</span><span class="n">log_val</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">x_multiply</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">include_cx</span><span class="p">:</span>
        <span class="n">logcx</span> <span class="o">=</span> <span class="n">interp_atom_prof</span><span class="p">(</span><span class="n">atom_data</span><span class="p">[</span><span class="s1">&#39;ccd&#39;</span><span class="p">],</span><span class="n">logne</span><span class="p">,</span> <span class="n">logTe</span><span class="p">,</span><span class="n">log_val</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">x_multiply</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">logcx</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">logTe</span><span class="p">,</span> <span class="n">logS</span><span class="p">,</span> <span class="n">logR</span><span class="p">,</span> <span class="n">logcx</span></div>



<div class="viewcode-block" id="plot_relax_time"><a class="viewcode-back" href="../../aurora.html#aurora.atomic.plot_relax_time">[docs]</a><span class="k">def</span> <span class="nf">plot_relax_time</span><span class="p">(</span><span class="n">logTe</span><span class="p">,</span> <span class="n">rate_coeff</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Plot relaxation time of the ionization equilibrium corresponding</span>
<span class="sd">    to the inverse of the given rate coefficients.</span>

<span class="sd">    Args:</span>
<span class="sd">        logTe : array (nr,)</span>
<span class="sd">            log-10 of Te [eV], on an arbitrary grid (same as other arguments, but not</span>
<span class="sd">            necessarily radial)</span>
<span class="sd">        rate_coeff : array (nr,)</span>
<span class="sd">            Rate coefficients from ionization balance. See :py:meth:`~aurora.atomic.get_frac_abundances`</span>
<span class="sd">            to obtain these via the &quot;compute_rates&quot; argument. </span>
<span class="sd">            N.B.: these rate coefficients will depend also on electron density, which does affect </span>
<span class="sd">            relaxation times. </span>
<span class="sd">        ax : matplotlib axes instance, optional</span>
<span class="sd">            If provided, plot relaxation times on these axes.    </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="n">logTe</span><span class="p">,</span><span class="mf">1e3</span><span class="o">/</span><span class="n">rate_coeff</span><span class="p">,</span><span class="s1">&#39;b&#39;</span> <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="n">logTe</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">10</span><span class="o">**</span><span class="n">logTe</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;T$_e$ [eV]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\tau_\mathrm</span><span class="si">{relax}</span><span class="s1">$ [ms]&#39;</span><span class="p">)</span></div>





<div class="viewcode-block" id="CartesianGrid"><a class="viewcode-back" href="../../aurora.html#aurora.atomic.CartesianGrid">[docs]</a><span class="k">class</span> <span class="nc">CartesianGrid</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Linear multivariate Cartesian grid interpolation in arbitrary dimensions</span>
<span class="sd">    This is a regular grid with equal spacing.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">grids</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; grids: list of arrays or ranges of each dimension</span>
<span class="sd">        values: array with shape (ndim, len(grid[0]), len(grid[1]),...)</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">g</span><span class="p">,</span><span class="n">s</span> <span class="ow">in</span>  <span class="nb">zip</span><span class="p">(</span><span class="n">grids</span><span class="p">,</span><span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">g</span><span class="p">)</span> <span class="o">!=</span> <span class="n">s</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;wrong size of values array&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">offsets</span> <span class="o">=</span> <span class="p">[</span><span class="n">g</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">grids</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scales</span>  <span class="o">=</span> <span class="p">[(</span><span class="n">g</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">g</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">g</span><span class="p">,</span><span class="n">n</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">grids</span><span class="p">,</span> <span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:])]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">coords</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Transform coords into pixel values &#39;&#39;&#39;</span>
        <span class="n">out_shape</span> <span class="o">=</span> <span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>

        <span class="n">coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
        <span class="n">coords</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offsets</span>
        <span class="n">coords</span> <span class="o">/=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scales</span>
        <span class="n">coords</span> <span class="o">=</span> <span class="n">coords</span><span class="o">.</span><span class="n">T</span>

        <span class="c1">#clip dimension - it will extrapolation by a nearest value</span>
        <span class="k">for</span> <span class="n">coord</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">):</span>
            <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">coord</span><span class="p">)</span>

        <span class="c1">#prepare output array</span>
        <span class="n">inter_out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],)</span><span class="o">+</span><span class="n">out_shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>

        <span class="c1">#fast interpolation on a regular grid</span>
        <span class="k">for</span> <span class="n">out</span><span class="p">,</span><span class="n">val</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">inter_out</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
            <span class="n">scipy</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">map_coordinates</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span>
                                            <span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="n">out</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">inter_out</span></div>


<div class="viewcode-block" id="interp_atom_prof"><a class="viewcode-back" href="../../aurora.html#aurora.atomic.interp_atom_prof">[docs]</a><span class="k">def</span> <span class="nf">interp_atom_prof</span><span class="p">(</span><span class="n">atom_table</span><span class="p">,</span><span class="n">x_prof</span><span class="p">,</span> <span class="n">y_prof</span><span class="p">,</span><span class="n">log_val</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">x_multiply</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Fast interpolate atomic data in atom_table onto the x_prof and y_prof profiles.</span>
<span class="sd">    This function assume that x_prof, y_prof, x,y, table are all base-10 logarithms,</span>
<span class="sd">    and x_prof, y_prof are equally spaced.</span>

<span class="sd">    Args:</span>
<span class="sd">        atom_table : list</span>
<span class="sd">            List with x,y, table = atom_table, containing atomic data from one of the ADAS files. </span>
<span class="sd">        x_prof : array (nt,nr)</span>
<span class="sd">            Spatio-temporal profiles of the first coordinate of the ADAS file table (usually </span>
<span class="sd">            electron density in cm^-3)</span>
<span class="sd">        y_prof : array (nt,nr)</span>
<span class="sd">            Spatio-temporal profiles of the second coordinate of the ADAS file table (usually </span>
<span class="sd">            electron temperature in eV)</span>
<span class="sd">        log_val : bool</span>
<span class="sd">            If True, return natural logarithm of the data</span>
<span class="sd">        x_multiply : bool</span>
<span class="sd">            If True, multiply output by 10**x_prof. </span>

<span class="sd">    Returns:</span>
<span class="sd">        interp_vals : array (nt,nion,nr)</span>
<span class="sd">            Interpolated atomic data on time,charge state and spatial grid that correspond to the </span>
<span class="sd">            ion of interest and the spatiotemporal grids of x_prof and y_prof. </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">table</span> <span class="o">=</span> <span class="n">atom_table</span>

    <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">table</span><span class="o">-</span><span class="n">table</span><span class="p">[</span><span class="o">...</span><span class="p">,[</span><span class="mi">0</span><span class="p">]])</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>  <span class="o">&lt;</span> <span class="o">.</span><span class="mi">05</span><span class="p">)</span> <span class="ow">or</span> <span class="n">x_prof</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># 1D interpolaion if independent of the last dimension - like SXR radiation data</span>

        <span class="n">reg_interp</span> <span class="o">=</span> <span class="n">CartesianGrid</span><span class="p">((</span><span class="n">y</span><span class="p">,</span> <span class="p">),</span><span class="n">table</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
        <span class="n">interp_vals</span> <span class="o">=</span> <span class="n">reg_interp</span><span class="p">(</span><span class="n">y_prof</span><span class="p">)</span> 

        <span class="c1"># multipling of logarithms is just adding</span>
        <span class="k">if</span> <span class="n">x_multiply</span> <span class="ow">and</span> <span class="n">x_prof</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">interp_vals</span> <span class="o">+=</span> <span class="n">x_prof</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span> <span class="c1"># 2D interpolation</span>
        <span class="k">if</span> <span class="n">x_multiply</span><span class="p">:</span> <span class="c1">#multipling of logarithms is just adding</span>
            <span class="n">table</span> <span class="o">+=</span> <span class="n">x</span>
        <span class="c1"># broadcast both variables in the sae shape</span>
        <span class="n">x_prof</span><span class="p">,</span> <span class="n">y_prof</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_arrays</span><span class="p">(</span><span class="n">x_prof</span><span class="p">,</span> <span class="n">y_prof</span><span class="p">)</span>
        <span class="c1">#perform fast linear interpolation</span>
        <span class="n">reg_interp</span> <span class="o">=</span> <span class="n">CartesianGrid</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span><span class="n">table</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
        <span class="n">interp_vals</span> <span class="o">=</span> <span class="n">reg_interp</span><span class="p">(</span><span class="n">x_prof</span><span class="p">,</span><span class="n">y_prof</span><span class="p">)</span> 

    <span class="c1"># reshape to shape(nt,nion,nr)</span>
    <span class="n">interp_vals</span> <span class="o">=</span> <span class="n">interp_vals</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">log_val</span><span class="p">:</span>
        <span class="c1"># return actual value, not logarithm</span>
        <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">interp_vals</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">interp_vals</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">interp_vals</span></div>





<div class="viewcode-block" id="gff_mean"><a class="viewcode-back" href="../../aurora.html#aurora.atomic.gff_mean">[docs]</a><span class="k">def</span> <span class="nf">gff_mean</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span><span class="n">Te</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Total free-free gaunt factor yielding the total radiated bremsstrahlung power</span>
<span class="sd">    when multiplying with the result for gff=1.</span>
<span class="sd">    Data originally from Karzas &amp; Latter, extracted from STRAHL&#39;s atomic_data.f.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="kn">from</span> <span class="nn">scipy.constants</span> <span class="kn">import</span> <span class="n">e</span><span class="p">,</span><span class="n">h</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">Rydberg</span>
    <span class="n">thirteenpointsix</span> <span class="o">=</span> <span class="n">h</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="n">Rydberg</span><span class="o">/</span><span class="n">e</span>

    <span class="n">log_gamma2_grid</span> <span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">3.000</span><span class="p">,</span><span class="o">-</span><span class="mf">2.833</span><span class="p">,</span><span class="o">-</span><span class="mf">2.667</span><span class="p">,</span><span class="o">-</span><span class="mf">2.500</span><span class="p">,</span><span class="o">-</span><span class="mf">2.333</span><span class="p">,</span><span class="o">-</span><span class="mf">2.167</span><span class="p">,</span><span class="o">-</span><span class="mf">2.000</span><span class="p">,</span><span class="o">-</span><span class="mf">1.833</span><span class="p">,</span><span class="o">-</span><span class="mf">1.667</span><span class="p">,</span><span class="o">-</span><span class="mf">1.500</span><span class="p">,</span>
                        <span class="o">-</span><span class="mf">1.333</span><span class="p">,</span><span class="o">-</span><span class="mf">1.167</span><span class="p">,</span><span class="o">-</span><span class="mf">1.000</span><span class="p">,</span><span class="o">-</span><span class="mf">0.833</span><span class="p">,</span><span class="o">-</span><span class="mf">0.667</span><span class="p">,</span><span class="o">-</span><span class="mf">0.500</span><span class="p">,</span><span class="o">-</span><span class="mf">0.333</span><span class="p">,</span><span class="o">-</span><span class="mf">0.167</span><span class="p">,</span> <span class="mf">0.000</span><span class="p">,</span> <span class="mf">0.167</span><span class="p">,</span>
                        <span class="mf">0.333</span><span class="p">,</span> <span class="mf">0.500</span><span class="p">,</span> <span class="mf">0.667</span><span class="p">,</span> <span class="mf">0.833</span><span class="p">,</span> <span class="mf">1.000</span><span class="p">]</span>

    <span class="n">gff_mean_grid</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.140</span><span class="p">,</span> <span class="mf">1.149</span><span class="p">,</span> <span class="mf">1.159</span><span class="p">,</span> <span class="mf">1.170</span><span class="p">,</span> <span class="mf">1.181</span><span class="p">,</span> <span class="mf">1.193</span><span class="p">,</span> <span class="mf">1.210</span><span class="p">,</span> <span class="mf">1.233</span><span class="p">,</span> <span class="mf">1.261</span><span class="p">,</span> <span class="mf">1.290</span><span class="p">,</span>
                     <span class="mf">1.318</span><span class="p">,</span> <span class="mf">1.344</span><span class="p">,</span> <span class="mf">1.370</span><span class="p">,</span> <span class="mf">1.394</span><span class="p">,</span> <span class="mf">1.416</span><span class="p">,</span> <span class="mf">1.434</span><span class="p">,</span> <span class="mf">1.445</span><span class="p">,</span> <span class="mf">1.448</span><span class="p">,</span> <span class="mf">1.440</span><span class="p">,</span> <span class="mf">1.418</span><span class="p">,</span>
                     <span class="mf">1.389</span><span class="p">,</span> <span class="mf">1.360</span><span class="p">,</span> <span class="mf">1.336</span><span class="p">,</span> <span class="mf">1.317</span><span class="p">,</span> <span class="mf">1.300</span><span class="p">]</span>

    <span class="c1"># set min Te here to 10 eV, because the grid above does not extend to lower temperatures</span>
    <span class="n">Te</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">Te</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">)</span>

    <span class="n">log_gamma2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Z</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">thirteenpointsix</span><span class="o">/</span><span class="n">Te</span><span class="p">)</span>

    <span class="c1"># dangerous/inaccurate extrapolation...</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">log_gamma2</span><span class="p">,</span> <span class="n">log_gamma2_grid</span><span class="p">,</span><span class="n">gff_mean_grid</span><span class="p">)</span></div>



<div class="viewcode-block" id="impurity_brems"><a class="viewcode-back" href="../../aurora.html#aurora.atomic.impurity_brems">[docs]</a><span class="k">def</span> <span class="nf">impurity_brems</span><span class="p">(</span><span class="n">nz</span><span class="p">,</span> <span class="n">ne</span><span class="p">,</span> <span class="n">Te</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Approximate impurity bremsstrahlung in units of mW/nm/sr/m^3.cm^3.</span>

<span class="sd">    This may not be very useful, since this contribution is already included in the </span>
<span class="sd">    continuum radiation component in ADAS files. </span>

<span class="sd">    This estimate does not have the correct ne-dependence of the Gaunt factor... use with care!</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># neutral stage doesn&#39;t produce brems</span>
    <span class="n">Z_imp</span> <span class="o">=</span> <span class="n">nz</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">Z_imp</span><span class="p">)[</span><span class="kc">None</span><span class="p">,:,</span><span class="kc">None</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span>

    <span class="n">gff</span> <span class="o">=</span> <span class="n">gff_mean</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span><span class="n">Te</span><span class="p">[:,</span><span class="kc">None</span><span class="p">])</span>
    <span class="n">imp_brems</span> <span class="o">=</span> <span class="n">Z</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">nz</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:]</span> <span class="o">*</span> <span class="n">gff</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.69e-32</span> <span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Te</span><span class="p">)</span> <span class="o">*</span> <span class="n">ne</span><span class="p">)</span> <span class="p">[:,</span><span class="kc">None</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">imp_brems</span></div>


<div class="viewcode-block" id="main_ion_brems"><a class="viewcode-back" href="../../aurora.html#aurora.atomic.main_ion_brems">[docs]</a><span class="k">def</span> <span class="nf">main_ion_brems</span><span class="p">(</span><span class="n">Zi</span><span class="p">,</span> <span class="n">ni</span><span class="p">,</span> <span class="n">ne</span><span class="p">,</span> <span class="n">Te</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Approximate main-ion bremsstrahlung in units of  mW/nm/sr/m^3.cm^3.</span>

<span class="sd">    It is likely better to calculate this from H/D/T plt files, which will have more accurate </span>
<span class="sd">    Gaunt factors with the correct density dependence.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="mf">1.69e-32</span> <span class="o">*</span> <span class="n">ni</span> <span class="o">*</span> <span class="n">Zi</span><span class="o">**</span><span class="mf">2.</span> <span class="o">*</span> <span class="n">ne</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Te</span><span class="p">)</span> <span class="o">*</span> <span class="n">gff_mean</span><span class="p">(</span><span class="n">Zi</span><span class="p">,</span><span class="n">Te</span><span class="p">)</span></div>



<div class="viewcode-block" id="get_cooling_factors"><a class="viewcode-back" href="../../aurora.html#aurora.atomic.get_cooling_factors">[docs]</a><span class="k">def</span> <span class="nf">get_cooling_factors</span><span class="p">(</span><span class="n">atom_data</span><span class="p">,</span> <span class="n">logTe_prof</span><span class="p">,</span> <span class="n">fz</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Calculate cooling coefficients for the given fractional abundances and kinetic profiles.</span>

<span class="sd">    Args:</span>
<span class="sd">        atom_data : dict</span>
<span class="sd">            Dictionary containing atomic data as output by :py:meth:`~aurora.atomic.get_atom_data`</span>
<span class="sd">            for the atomic processes of interest. &quot;prs&quot;,&quot;pls&quot;,&quot;plt&quot; and &quot;prb&quot; are required by this function.</span>
<span class="sd">        logTe_prof : array (nt,nr)</span>
<span class="sd">            Log-10 of electron temperature profile (in eV)</span>
<span class="sd">        fz : array (nt,nr)</span>
<span class="sd">            Fractional abundances for all charge states of the ion of &quot;atom_data&quot;</span>
<span class="sd">        plot : bool</span>
<span class="sd">            If True, plot all radiation components, summed over charge states.</span>
<span class="sd">        ax : matplotlib.Axes instance</span>
<span class="sd">            If provided, plot results on these axes. </span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        pls : array (nt,nr)</span>
<span class="sd">            Line radiation in the SXR range for each charge state</span>
<span class="sd">        prs : array (nt,nr)</span>
<span class="sd">            Continuum radiation in the SXR range for each charge state</span>
<span class="sd">        pltt : array (nt,nr)</span>
<span class="sd">            Line radiation (unfiltered) for each charge state.</span>
<span class="sd">            NB: this corresponds to the ADAS &quot;plt&quot; files. An additional &quot;t&quot; is added to the name to avoid</span>
<span class="sd">            conflict with the common matplotlib.pyplot short form &quot;plt&quot;</span>
<span class="sd">        prb : array (nt,nr)</span>
<span class="sd">            Continuum radiation (unfiltered) for each charge state</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">atom_data</span><span class="p">[</span><span class="s1">&#39;prs&#39;</span><span class="p">]</span>
        <span class="n">atom_data</span><span class="p">[</span><span class="s1">&#39;pls&#39;</span><span class="p">]</span>
        <span class="n">atom_data</span><span class="p">[</span><span class="s1">&#39;plt&#39;</span><span class="p">]</span>
        <span class="n">atom_data</span><span class="p">[</span><span class="s1">&#39;prb&#39;</span><span class="p">]</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;prs, plt and/or prb files not available!&#39;</span><span class="p">)</span>

    <span class="n">prs</span> <span class="o">=</span> <span class="n">interp_atom_prof</span><span class="p">(</span><span class="n">atom_data</span><span class="p">[</span><span class="s1">&#39;prs&#39;</span><span class="p">],</span><span class="kc">None</span><span class="p">,</span><span class="n">logTe_prof</span><span class="p">)</span><span class="c1">#continuum radiation in SXR range</span>
    <span class="n">pls</span> <span class="o">=</span> <span class="n">interp_atom_prof</span><span class="p">(</span><span class="n">atom_data</span><span class="p">[</span><span class="s1">&#39;pls&#39;</span><span class="p">],</span><span class="kc">None</span><span class="p">,</span><span class="n">logTe_prof</span><span class="p">)</span><span class="c1">#line radiation in SXR range</span>
    <span class="n">pltt</span><span class="o">=</span> <span class="n">interp_atom_prof</span><span class="p">(</span><span class="n">atom_data</span><span class="p">[</span><span class="s1">&#39;plt&#39;</span><span class="p">],</span><span class="kc">None</span><span class="p">,</span><span class="n">logTe_prof</span><span class="p">)</span> <span class="c1">#line radiation</span>
    <span class="n">prb</span> <span class="o">=</span> <span class="n">interp_atom_prof</span><span class="p">(</span><span class="n">atom_data</span><span class="p">[</span><span class="s1">&#39;prb&#39;</span><span class="p">],</span><span class="kc">None</span><span class="p">,</span><span class="n">logTe_prof</span><span class="p">)</span><span class="c1">#continuum radiation</span>

    <span class="n">pls</span> <span class="o">*=</span> <span class="n">fz</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">prs</span> <span class="o">*=</span> <span class="n">fz</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span>
    <span class="n">pltt</span><span class="o">*=</span> <span class="n">fz</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">prb</span> <span class="o">*=</span> <span class="n">fz</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span>

    <span class="n">line_rad_sxr</span>  <span class="o">=</span> <span class="n">pls</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">brems_rad_sxr</span> <span class="o">=</span> <span class="n">prs</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">line_rad_tot</span>  <span class="o">=</span> <span class="n">pltt</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">brems_rad_tot</span> <span class="o">=</span> <span class="n">prb</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>
        <span class="c1"># plot cooling factors</span>
        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

        <span class="c1"># SXR radiation components</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="n">logTe_prof</span><span class="p">,</span> <span class="n">line_rad_sxr</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;SXR line radiation&#39;</span><span class="p">)</span>   
        <span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="n">logTe_prof</span><span class="p">,</span> <span class="n">brems_rad_sxr</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;SXR bremsstrahlung and recombination&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="n">logTe_prof</span><span class="p">,</span> <span class="n">brems_rad_sxr</span><span class="o">+</span><span class="n">line_rad_sxr</span><span class="p">,</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;total SXR radiation&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="c1"># total radiation (includes hard X-ray, visible, UV, etc.)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="n">logTe_prof</span><span class="p">,</span> <span class="n">line_rad_tot</span><span class="p">,</span><span class="s1">&#39;g--&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Unfiltered line radiation&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="n">logTe_prof</span><span class="p">,</span> <span class="n">brems_rad_tot</span><span class="p">,</span><span class="s1">&#39;y--&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Unfiltered continuum radiation&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="n">logTe_prof</span><span class="p">,</span> <span class="n">brems_rad_tot</span><span class="o">+</span><span class="n">line_rad_tot</span><span class="p">,</span><span class="s1">&#39;y--&#39;</span><span class="p">,</span>
                  <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Unfiltered total continuum radiation&#39;</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
        
        <span class="c1"># Set xlims to visualize scales better</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">10</span><span class="o">**</span><span class="n">logTe_prof</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">line_rad_sxr</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="n">logTe_prof</span> <span class="o">-</span> <span class="mi">50</span><span class="p">))],</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span> <span class="n">line_rad_tot</span><span class="p">)</span><span class="o">*</span><span class="mi">10</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;T$_e$ [eV]&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;L$_z$ [Wm$^3$]&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Cooling factors&#39;</span><span class="p">)</span>

    <span class="c1"># ion-resolved radiation terms:</span>
    <span class="k">return</span> <span class="n">pls</span><span class="p">,</span> <span class="n">prs</span><span class="p">,</span> <span class="n">pltt</span><span class="p">,</span><span class="n">prb</span></div>

        
        

<div class="viewcode-block" id="balance"><a class="viewcode-back" href="../../aurora.html#aurora.atomic.balance">[docs]</a><span class="k">def</span> <span class="nf">balance</span><span class="p">(</span><span class="n">logTe_val</span><span class="p">,</span> <span class="n">cs</span><span class="p">,</span> <span class="n">n0_by_ne</span><span class="p">,</span> <span class="n">logTe_</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">cx</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Evaluate balance of effective ionization, recombination and charge exchange at a given temperature. &#39;&#39;&#39;</span>

    <span class="n">a</span> <span class="o">=</span> <span class="n">R</span> <span class="o">+</span><span class="n">n0_by_ne</span> <span class="o">*</span> <span class="n">cx</span>
    <span class="n">SS_0</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">interp1d</span><span class="p">(</span><span class="n">logTe_</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="n">cs</span><span class="o">-</span><span class="mi">1</span><span class="p">,:]),</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">,</span> <span class="n">bounds_error</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">logTe_val</span><span class="p">))</span>
    <span class="n">aa_0</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">interp1d</span><span class="p">(</span><span class="n">logTe_</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">cs</span><span class="o">-</span><span class="mi">1</span><span class="p">,:]),</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">,</span> <span class="n">bounds_error</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">logTe_val</span><span class="p">))</span>
    <span class="n">SS_1</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">interp1d</span><span class="p">(</span><span class="n">logTe_</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="n">cs</span><span class="p">,:]),</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">,</span> <span class="n">bounds_error</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">logTe_val</span><span class="p">))</span>
    <span class="n">aa_1</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">interp1d</span><span class="p">(</span><span class="n">logTe_</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">cs</span><span class="p">,:]),</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">,</span> <span class="n">bounds_error</span><span class="o">=</span><span class="kc">False</span><span class="p">)(</span><span class="n">logTe_val</span><span class="p">))</span>

    <span class="n">val</span> <span class="o">=</span> <span class="n">SS_0</span> <span class="o">-</span> <span class="n">SS_1</span> <span class="o">-</span> <span class="n">aa_0</span> <span class="o">+</span> <span class="n">aa_1</span>
    <span class="k">return</span> <span class="n">val</span><span class="o">*</span><span class="mf">1e20</span> <span class="c1"># get this to large-ish units to avoid tolerance issues due to small powers of 10</span></div>




<div class="viewcode-block" id="plot_norm_ion_freq"><a class="viewcode-back" href="../../aurora.html#aurora.atomic.plot_norm_ion_freq">[docs]</a><span class="k">def</span> <span class="nf">plot_norm_ion_freq</span><span class="p">(</span><span class="n">S_z</span><span class="p">,</span> <span class="n">q_prof</span><span class="p">,</span> <span class="n">R_prof</span><span class="p">,</span> <span class="n">imp_A</span><span class="p">,</span> <span class="n">Ti_prof</span><span class="p">,</span>
                       <span class="n">nz_profs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rhop</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">eps_prof</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Compare effective ionization rate for each charge state with the </span>
<span class="sd">    characteristic transit time that a non-trapped and trapped impurity ion takes</span>
<span class="sd">    to travel a parallel distance L = q R. </span>

<span class="sd">    If the normalized ionization rate is less than 1, then flux surface averaging of</span>
<span class="sd">    background asymmetries (e.g. from edge or beam neutrals) can be considered in a </span>
<span class="sd">    &quot;flux-surface-averaged&quot; sense; otherwise, local effects (i.e. not flux-surface-averaged)</span>
<span class="sd">    may be too important to ignore. </span>

<span class="sd">    This function is inspired by Dux et al. NF 2020. Note that in this paper the ionization </span>
<span class="sd">    rate averaged over all charge state densities is considered. This function avoids the </span>
<span class="sd">    averaging over charge states, unless these are provided as an input. </span>

<span class="sd">    Args:</span>
<span class="sd">        S_z : array (r,cs) [s^-1]</span>
<span class="sd">             Effective ionization rates for each charge state as a function of radius. </span>
<span class="sd">             Note that, for convenience within aurora, cs includes the neutral stage.</span>
<span class="sd">        q_prof : array (r,)</span>
<span class="sd">             Radial profile of safety factor</span>
<span class="sd">        R_prof : array (r,) or float [m]</span>
<span class="sd">             Radial profile of major radius, either given as an average of HFS and LFS, or also</span>
<span class="sd">             simply as a scalar (major radius on axis)</span>
<span class="sd">        imp_A : float [amu]</span>
<span class="sd">             Atomic mass number, i.e. number of protons + neutrons (e.g. 2 for D)</span>
<span class="sd">        Ti_prof : array (r,)</span>
<span class="sd">             Radial profile of ion temperature [eV]</span>
<span class="sd">        nz_profs : array (r,cs), optional</span>
<span class="sd">             Radial profile for each charge state. If provided, calculate average normalized </span>
<span class="sd">             ionization rate over all charge states.</span>
<span class="sd">        rhop : array (r,), optional</span>
<span class="sd">             Sqrt of poloidal flux radial grid. This is used only for (optional) plotting. </span>
<span class="sd">        plot : bool, optional</span>
<span class="sd">             If True, plot results.</span>
<span class="sd">        eps_prof : array (r,), optional</span>
<span class="sd">             Radial profile of inverse aspect ratio, i.e. r/R, only used if plotting is requested.  </span>

<span class="sd">    Returns:</span>
<span class="sd">        nu_ioniz_star : array (r,cs) or (r,)</span>
<span class="sd">             Normalized ionization rate. If nz_profs is given as an input, this is an average over</span>
<span class="sd">             all charge state; otherwise, it is given for each charge state.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">nu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">S_z</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">cs</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">S_z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span> <span class="c1"># exclude neutral states</span>
        <span class="n">nu</span><span class="p">[:,</span><span class="n">cs</span><span class="p">]</span> <span class="o">=</span> <span class="n">S_z</span><span class="p">[:,</span><span class="n">cs</span><span class="p">]</span> <span class="o">*</span> <span class="n">q_prof</span> <span class="o">*</span> <span class="n">R_prof</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">imp_A</span> <span class="o">*</span> <span class="n">m_p</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">Ti_prof</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">nz_profs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># calculate average nu_ioniz_star </span>
        <span class="n">nu_ioniz_star</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">nz_profs</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:]</span><span class="o">*</span><span class="n">nu</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">nz_profs</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># return normalized ionization rate for each charge state</span>
        <span class="n">nu_ioniz_star</span> <span class="o">=</span> <span class="n">nu</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:]</span>

    <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">rhop</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">rhop</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nu</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            
        <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">nu_ioniz_star</span><span class="o">.</span><span class="n">ndim</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">rhop</span><span class="p">,</span><span class="n">nu_ioniz_star</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\nu_</span><span class="si">{ion}</span><span class="s1">^*$&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">cs</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">S_z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">rhop</span><span class="p">,</span> <span class="n">nu_ioniz_star</span><span class="p">[:,</span><span class="n">cs</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;q=</span><span class="si">{</span><span class="n">cs</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\nu_</span><span class="si">{ion}</span><span class="s1">^*$&#39;</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\rho_p$&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">eps_prof</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">rhop</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">eps_prof</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\sqrt{\epsilon}$&#39;</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span><span class="o">.</span><span class="n">set_draggable</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span></div>



<div class="viewcode-block" id="adas_files_dict"><a class="viewcode-back" href="../../aurora.html#aurora.atomic.adas_files_dict">[docs]</a><span class="k">def</span> <span class="nf">adas_files_dict</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;Selections for ADAS files for Aurora runs and radiation calculations.</span>
<span class="sd">    This function can be called to fetch a set of default files, which can then be modified (e.g. to </span>
<span class="sd">    use a new file for a specific SXR filter) before running a calculation. </span>
<span class="sd">    &#39;&#39;&#39;</span>
            
    <span class="n">files</span><span class="o">=</span><span class="p">{}</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>   <span class="c1">#1</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">][</span><span class="s1">&#39;acd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;acd96_h.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">][</span><span class="s1">&#39;scd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;scd96_h.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">][</span><span class="s1">&#39;prb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prb96_h.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">][</span><span class="s1">&#39;plt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plt96_h.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">][</span><span class="s1">&#39;ccd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ccd96_h.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">][</span><span class="s1">&#39;prc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prc96_h.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">][</span><span class="s1">&#39;pls&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pls_H_14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">][</span><span class="s1">&#39;prs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prs_H_14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">][</span><span class="s1">&#39;fis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sxrfil14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">][</span><span class="s1">&#39;brs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;brs05360.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">][</span><span class="s2">&quot;pbs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pbsx7_h.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;He&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>   <span class="c1">#2</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;He&quot;</span><span class="p">][</span><span class="s1">&#39;acd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;acd96_he.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;He&quot;</span><span class="p">][</span><span class="s1">&#39;scd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;scd96_he.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;He&quot;</span><span class="p">][</span><span class="s1">&#39;prb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prb96_he.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;He&quot;</span><span class="p">][</span><span class="s1">&#39;plt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plt96_he.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;He&quot;</span><span class="p">][</span><span class="s1">&#39;ccd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ccd07_he.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;He&quot;</span><span class="p">][</span><span class="s1">&#39;prc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prc96_he.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;He&quot;</span><span class="p">][</span><span class="s1">&#39;pls&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pls_He_14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;He&quot;</span><span class="p">][</span><span class="s1">&#39;prs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prs_He_14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;He&quot;</span><span class="p">][</span><span class="s1">&#39;fis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sxrfil14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;He&quot;</span><span class="p">][</span><span class="s1">&#39;brs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;brs05360.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;He&quot;</span><span class="p">][</span><span class="s2">&quot;pbs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pbsx5_he.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Li&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>   <span class="c1">#3</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Li&quot;</span><span class="p">][</span><span class="s1">&#39;acd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;acd96_li.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Li&quot;</span><span class="p">][</span><span class="s1">&#39;scd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;scd96_li.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Li&quot;</span><span class="p">][</span><span class="s1">&#39;ccd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ccd89_li.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Li&quot;</span><span class="p">][</span><span class="s1">&#39;prb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prb96_li.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Li&quot;</span><span class="p">][</span><span class="s1">&#39;plt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plt96_li.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Li&quot;</span><span class="p">][</span><span class="s1">&#39;prc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prc89_li.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Li&quot;</span><span class="p">][</span><span class="s1">&#39;pls&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pls89_li.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Li&quot;</span><span class="p">][</span><span class="s2">&quot;pbs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Be&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>   <span class="c1">#4</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Be&quot;</span><span class="p">][</span><span class="s1">&#39;acd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;acd96_be.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Be&quot;</span><span class="p">][</span><span class="s1">&#39;scd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;scd96_be.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Be&quot;</span><span class="p">][</span><span class="s1">&#39;prb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prb96_be.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Be&quot;</span><span class="p">][</span><span class="s1">&#39;plt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plt96_be.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Be&quot;</span><span class="p">][</span><span class="s1">&#39;ccd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ccd89_be.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Be&quot;</span><span class="p">][</span><span class="s1">&#39;prc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prc89_be.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Be&quot;</span><span class="p">][</span><span class="s1">&#39;pls&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plsx5_be.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Be&quot;</span><span class="p">][</span><span class="s1">&#39;prs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prsx5_be.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Be&quot;</span><span class="p">][</span><span class="s2">&quot;pbs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pbsx5_be.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>   <span class="c1">#5</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">][</span><span class="s1">&#39;acd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;acd89_b.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">][</span><span class="s1">&#39;scd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;scd89_b.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">][</span><span class="s1">&#39;ccd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ccd89_b.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">][</span><span class="s1">&#39;prb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prb89_b.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">][</span><span class="s1">&#39;plt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plt89_b.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">][</span><span class="s1">&#39;prc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prc89_b.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">][</span><span class="s1">&#39;pls&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plsx5_b.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">][</span><span class="s1">&#39;prs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prsx5_b.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">][</span><span class="s2">&quot;pbs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pbsx5_b.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>    <span class="c1">#6</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">][</span><span class="s1">&#39;acd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;acd96_c.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">][</span><span class="s1">&#39;scd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;scd96_c.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">][</span><span class="s1">&#39;prb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prb96_c.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">][</span><span class="s1">&#39;plt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plt96_c.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">][</span><span class="s1">&#39;ccd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ccd96_c.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">][</span><span class="s1">&#39;prc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prc96_c.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">][</span><span class="s1">&#39;pls&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pls_C_14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">][</span><span class="s1">&#39;prs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prs_C_14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">][</span><span class="s1">&#39;fis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sxrfil14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">][</span><span class="s1">&#39;brs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;brs05360.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">][</span><span class="s2">&quot;pbs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pbsx5_c.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>    <span class="c1">#7</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">][</span><span class="s1">&#39;acd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;acd96_n.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">][</span><span class="s1">&#39;scd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;scd96_n.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">][</span><span class="s1">&#39;ccd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ccd89_n.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">][</span><span class="s1">&#39;prb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prb96_n.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">][</span><span class="s1">&#39;plt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plt96_n.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">][</span><span class="s1">&#39;pls&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plsx8_n.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">][</span><span class="s1">&#39;prs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prsx8_n.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">][</span><span class="s1">&#39;fis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sxrfilD1.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">][</span><span class="s1">&#39;brs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;brs05360.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">][</span><span class="s1">&#39;ccd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ccd96_n.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">][</span><span class="s2">&quot;pbs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pbsx5_n.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;O&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>    <span class="c1">#8</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;O&quot;</span><span class="p">][</span><span class="s1">&#39;acd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;acd96_o.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;O&quot;</span><span class="p">][</span><span class="s1">&#39;scd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;scd96_o.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;O&quot;</span><span class="p">][</span><span class="s1">&#39;ccd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ccd89_o.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;O&quot;</span><span class="p">][</span><span class="s1">&#39;prb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prb96_o.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;O&quot;</span><span class="p">][</span><span class="s1">&#39;plt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plt96_o.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;O&quot;</span><span class="p">][</span><span class="s1">&#39;pls&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plsx5_o.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;O&quot;</span><span class="p">][</span><span class="s1">&#39;prs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prsx5_o.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;O&quot;</span><span class="p">][</span><span class="s2">&quot;pbs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pbsx5_o.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;F&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>    <span class="c1">#9</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;F&quot;</span><span class="p">][</span><span class="s1">&#39;acd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;acd89_f.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;F&quot;</span><span class="p">][</span><span class="s1">&#39;scd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;scd89_f.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;F&quot;</span><span class="p">][</span><span class="s1">&#39;ccd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ccd89_f.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;F&quot;</span><span class="p">][</span><span class="s1">&#39;prb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prb89_f.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;F&quot;</span><span class="p">][</span><span class="s1">&#39;plt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plt89_f.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;F&quot;</span><span class="p">][</span><span class="s1">&#39;fis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sxrfil14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;F&quot;</span><span class="p">][</span><span class="s1">&#39;brs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;brs05360.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;F&quot;</span><span class="p">][</span><span class="s1">&#39;pls&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pls_F_14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;F&quot;</span><span class="p">][</span><span class="s1">&#39;prs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prs_F_14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;F&quot;</span><span class="p">][</span><span class="s1">&#39;prc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prc89_f.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;F&quot;</span><span class="p">][</span><span class="s2">&quot;pbs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pbsx5_f.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ne&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>   <span class="c1">#10</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ne&quot;</span><span class="p">][</span><span class="s1">&#39;acd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;acd96_ne.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ne&quot;</span><span class="p">][</span><span class="s1">&#39;scd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;scd96_ne.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ne&quot;</span><span class="p">][</span><span class="s1">&#39;prb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prb96_ne.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ne&quot;</span><span class="p">][</span><span class="s1">&#39;plt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plt96_ne.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ne&quot;</span><span class="p">][</span><span class="s1">&#39;ccd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ccd89_ne.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ne&quot;</span><span class="p">][</span><span class="s1">&#39;prc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prc89_ne.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ne&quot;</span><span class="p">][</span><span class="s1">&#39;pls&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plsx8_ne.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ne&quot;</span><span class="p">][</span><span class="s1">&#39;prs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prsx8_ne.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ne&quot;</span><span class="p">][</span><span class="s1">&#39;fis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sxrfilD1.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ne&quot;</span><span class="p">][</span><span class="s1">&#39;brs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;brs05360.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ne&quot;</span><span class="p">][</span><span class="s2">&quot;pbs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pbsx5_ne.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Al&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>    <span class="c1">#13</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Al&quot;</span><span class="p">][</span><span class="s1">&#39;acd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;acd00_al.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Al&quot;</span><span class="p">][</span><span class="s1">&#39;scd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;scd00_al.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Al&quot;</span><span class="p">][</span><span class="s1">&#39;prb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prb00_al.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Al&quot;</span><span class="p">][</span><span class="s1">&#39;plt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plt00_al.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Al&quot;</span><span class="p">][</span><span class="s1">&#39;ccd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ccd89_al.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Al&quot;</span><span class="p">][</span><span class="s1">&#39;prc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prc89_al.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Al&quot;</span><span class="p">][</span><span class="s1">&#39;pls&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pls_Al_14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Al&quot;</span><span class="p">][</span><span class="s1">&#39;prs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prs_Al_14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Al&quot;</span><span class="p">][</span><span class="s1">&#39;fis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sxrfil14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Al&quot;</span><span class="p">][</span><span class="s1">&#39;brs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;brs05360.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Al&quot;</span><span class="p">][</span><span class="s1">&#39;pbs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pbsx5_al.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Si&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>     <span class="c1">#14</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Si&quot;</span><span class="p">][</span><span class="s1">&#39;acd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;acd00_si.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Si&quot;</span><span class="p">][</span><span class="s1">&#39;scd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;scd00_si.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Si&quot;</span><span class="p">][</span><span class="s1">&#39;prb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prb00_si.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Si&quot;</span><span class="p">][</span><span class="s1">&#39;plt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plt97_si.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Si&quot;</span><span class="p">][</span><span class="s1">&#39;pls&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pls_Si_14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Si&quot;</span><span class="p">][</span><span class="s1">&#39;prs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prs_Si_14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Si&quot;</span><span class="p">][</span><span class="s1">&#39;fis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sxrfil14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Si&quot;</span><span class="p">][</span><span class="s1">&#39;brs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;brs05360.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Si&quot;</span><span class="p">][</span><span class="s1">&#39;ccd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ccd89_si.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Si&quot;</span><span class="p">][</span><span class="s2">&quot;pbs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pbsx5_si.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ar&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>     <span class="c1">#18</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ar&quot;</span><span class="p">][</span><span class="s1">&#39;acd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;acd00_ar.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ar&quot;</span><span class="p">][</span><span class="s1">&#39;scd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;scd00_ar.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ar&quot;</span><span class="p">][</span><span class="s1">&#39;prb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prb00_ar.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ar&quot;</span><span class="p">][</span><span class="s1">&#39;plt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plt00_ar.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ar&quot;</span><span class="p">][</span><span class="s1">&#39;ccd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ccd89_ar.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ar&quot;</span><span class="p">][</span><span class="s1">&#39;prc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prc89_ar.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ar&quot;</span><span class="p">][</span><span class="s1">&#39;pls&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pls_Ar_14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ar&quot;</span><span class="p">][</span><span class="s1">&#39;prs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prs_Ar_14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ar&quot;</span><span class="p">][</span><span class="s1">&#39;fis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sxrfil14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ar&quot;</span><span class="p">][</span><span class="s1">&#39;brs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;brs05360.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ar&quot;</span><span class="p">][</span><span class="s2">&quot;pbs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pbsx5_ar.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ca&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>     <span class="c1">#20</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ca&quot;</span><span class="p">][</span><span class="s1">&#39;acd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;acd85_ca.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ca&quot;</span><span class="p">][</span><span class="s1">&#39;scd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;scd85_ca.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ca&quot;</span><span class="p">][</span><span class="s1">&#39;ccd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ccd89_w.dat&quot;</span>  <span class="c1"># file not available, use first 20 ion stages using Foster scaling</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ca&quot;</span><span class="p">][</span><span class="s1">&#39;prb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prb85_ca.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ca&quot;</span><span class="p">][</span><span class="s1">&#39;plt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plt85_ca.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ca&quot;</span><span class="p">][</span><span class="s1">&#39;pls&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pls_Ca_14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ca&quot;</span><span class="p">][</span><span class="s1">&#39;prs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prs_Ca_14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ca&quot;</span><span class="p">][</span><span class="s1">&#39;fis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sxrfil14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ca&quot;</span><span class="p">][</span><span class="s1">&#39;brs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;brs05360.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ca&quot;</span><span class="p">][</span><span class="s2">&quot;pbs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Fe&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>     <span class="c1">#26</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Fe&quot;</span><span class="p">][</span><span class="s1">&#39;acd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;acd89_fe.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Fe&quot;</span><span class="p">][</span><span class="s1">&#39;scd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;scd89_fe.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Fe&quot;</span><span class="p">][</span><span class="s1">&#39;prb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prb89_fe.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Fe&quot;</span><span class="p">][</span><span class="s1">&#39;plt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plt89_fe.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Fe&quot;</span><span class="p">][</span><span class="s1">&#39;pls&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pls_Fe_14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Fe&quot;</span><span class="p">][</span><span class="s1">&#39;prs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prs_Fe_14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Fe&quot;</span><span class="p">][</span><span class="s1">&#39;fis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sxrfil14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Fe&quot;</span><span class="p">][</span><span class="s1">&#39;brs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;brs05360.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Fe&quot;</span><span class="p">][</span><span class="s1">&#39;ccd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ccd89_fe.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Fe&quot;</span><span class="p">][</span><span class="s2">&quot;pbs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pbsx5_fe.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ni&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>     <span class="c1">#28</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ni&quot;</span><span class="p">][</span><span class="s1">&#39;acd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;acd00_ni.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ni&quot;</span><span class="p">][</span><span class="s1">&#39;scd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;scd00_ni.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ni&quot;</span><span class="p">][</span><span class="s1">&#39;prb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prb00_ni.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ni&quot;</span><span class="p">][</span><span class="s1">&#39;plt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plt00_ni.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ni&quot;</span><span class="p">][</span><span class="s1">&#39;pls&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pls_Ni_14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ni&quot;</span><span class="p">][</span><span class="s1">&#39;prs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prs_Ni_14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ni&quot;</span><span class="p">][</span><span class="s1">&#39;fis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sxrfil14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ni&quot;</span><span class="p">][</span><span class="s1">&#39;brs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;brs05360.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ni&quot;</span><span class="p">][</span><span class="s1">&#39;ccd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ccd89_ni.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Ni&quot;</span><span class="p">][</span><span class="s2">&quot;pbs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pbsx5_ni.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Kr&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>     <span class="c1">#36</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Kr&quot;</span><span class="p">][</span><span class="s1">&#39;acd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;acd89_kr.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Kr&quot;</span><span class="p">][</span><span class="s1">&#39;scd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;scd89_kr.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Kr&quot;</span><span class="p">][</span><span class="s1">&#39;ccd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ccd89_kr.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Kr&quot;</span><span class="p">][</span><span class="s1">&#39;prb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prb89_kr.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Kr&quot;</span><span class="p">][</span><span class="s1">&#39;plt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plt89_kr.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Kr&quot;</span><span class="p">][</span><span class="s1">&#39;pls&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plsx5_kr.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Kr&quot;</span><span class="p">][</span><span class="s1">&#39;prs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prsx5_kr.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Kr&quot;</span><span class="p">][</span><span class="s2">&quot;pbs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Mo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>     <span class="c1">#42</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Mo&quot;</span><span class="p">][</span><span class="s1">&#39;acd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;acd89_mo.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Mo&quot;</span><span class="p">][</span><span class="s1">&#39;scd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;scd89_mo.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Mo&quot;</span><span class="p">][</span><span class="s1">&#39;ccd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ccd89_mo.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Mo&quot;</span><span class="p">][</span><span class="s1">&#39;plt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plt89_mo.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Mo&quot;</span><span class="p">][</span><span class="s1">&#39;prb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prb89_mo.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Mo&quot;</span><span class="p">][</span><span class="s1">&#39;prc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prc89_mo.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Mo&quot;</span><span class="p">][</span><span class="s2">&quot;pbs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Xe&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>     <span class="c1">#56</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Xe&quot;</span><span class="p">][</span><span class="s1">&#39;acd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;acd89_xe.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Xe&quot;</span><span class="p">][</span><span class="s1">&#39;scd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;scd89_xe.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Xe&quot;</span><span class="p">][</span><span class="s1">&#39;ccd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ccd89_xe.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Xe&quot;</span><span class="p">][</span><span class="s1">&#39;plt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plt89_xe.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Xe&quot;</span><span class="p">][</span><span class="s1">&#39;prb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prb89_xe.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Xe&quot;</span><span class="p">][</span><span class="s1">&#39;prs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prsx1_xe.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Xe&quot;</span><span class="p">][</span><span class="s1">&#39;pls&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prsx1_xe.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Xe&quot;</span><span class="p">][</span><span class="s1">&#39;prc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prc89_xe.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;Xe&quot;</span><span class="p">][</span><span class="s2">&quot;pbs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;W&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>     <span class="c1">#74</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;W&quot;</span><span class="p">][</span><span class="s1">&#39;acd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;acd89_w.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;W&quot;</span><span class="p">][</span><span class="s1">&#39;scd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;scd89_w.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;W&quot;</span><span class="p">][</span><span class="s1">&#39;prb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prb89_w.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;W&quot;</span><span class="p">][</span><span class="s1">&#39;plt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;plt89_w.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;W&quot;</span><span class="p">][</span><span class="s1">&#39;fis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sxrfil14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;W&quot;</span><span class="p">][</span><span class="s1">&#39;brs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;brs05360.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;W&quot;</span><span class="p">][</span><span class="s1">&#39;pls&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pls_W_14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;W&quot;</span><span class="p">][</span><span class="s1">&#39;prs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prs_W_14.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;W&quot;</span><span class="p">][</span><span class="s1">&#39;ccd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ccd89_w.dat&quot;</span>
    <span class="n">files</span><span class="p">[</span><span class="s2">&quot;W&quot;</span><span class="p">][</span><span class="s2">&quot;pbs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pbsx5_w.dat&quot;</span>

    <span class="k">return</span> <span class="n">files</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, F.Sciortino

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>